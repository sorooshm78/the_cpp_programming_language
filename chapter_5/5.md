## Introduction
ุงุฒ ุฏุฏฺฏุงู ฺฉ ฺฉุงุฑุจุฑ ููุงุ ฺฉุชุงุจุฎุงูู ุงุณุชุงูุฏุงุฑุฏ ุงุฏูโุขู ุจุงุฏ ุงุฌุฒุง ุฑุง ุงุฑุงุฆู ุฏูุฏ ฺฉู ุจูโุทูุฑ ูุณุชูู ุชูุฑุจุงู ูุฑ ูุงุฒ ุฑุง ูพุดุชุจุงู ฺฉููุฏ. ุจุฑุง ฺฉ ุญูุฒู ฺฉุงุฑุจุฑุฏ ุฎุงุตุ ฺฉ ฺฉุชุงุจุฎุงูู ุชุฌุงุฑ ุจุฒุฑฺฏ ูโุชูุงูุฏ ุจู ุงู ุงุฏูโุขู ูุฒุฏฺฉ ุดูุฏ. ุจุง ุงู ุญุงูุ ุงู ฺุฒ ูุณุช ฺฉู ฺฉุชุงุจุฎุงูู ุงุณุชุงูุฏุงุฑุฏ C++ ุฏุฑ ุชูุงุด ุจุฑุง ุงูุฌุงู ุขู ุงุณุช. ฺฉ ฺฉุชุงุจุฎุงูู ูุงุจู ูุฏุฑุช ู ุฏุฑ ุฏุณุชุฑุณ ุจุฑุง ููฺฏุงู ููโุชูุงูุฏ ููู ฺุฒ ุจุฑุง ููู ุงูุฑุงุฏ ุจุงุดุฏ. ุฏุฑ ุนูุถุ ฺฉุชุงุจุฎุงูู ุงุณุชุงูุฏุงุฑุฏ C++ ุชูุงุด ูโฺฉูุฏ ุงุฌุฒุง ุฑุง ุงุฑุงุฆู ุฏูุฏ ฺฉู ุจุฑุง ุงฺฉุซุฑ ุงูุฑุงุฏ ุฏุฑ ุงฺฉุซุฑ ุญูุฒูโูุง ฺฉุงุฑุจุฑุฏ ููุฏ ุจุงุดูุฏ. ุจู ุนุจุงุฑุช ุฏฺฏุฑุ ูุฏู ุงู ฺฉุชุงุจุฎุงูู ุฎุฏูุช ุจู ุชูุงุทุน ููู ูุงุฒูุง ุงุณุชุ ูู ุงุชุญุงุฏ ุขูโูุง. ุนูุงูู ุจุฑ ุงูุ ูพุดุชุจุงู ุงุฒ ฺูุฏ ุญูุฒู ฺฉุงุฑุจุฑุฏ ุจุณุงุฑ ูููุ ูุงููุฏ ูุญุงุณุจุงุช ุฑุงุถ ู ูพุฑุฏุงุฒุด ูุชูุ ุจู ูุฑูุฑ ูุงุฑุฏ ุงู ฺฉุชุงุจุฎุงูู ุดุฏู ุงุณุช.

## Resource Management
ฺฉ ุงุฒ ูุธุงู ฺฉูุฏ ูุฑ ุจุฑูุงูู ุบุฑุณุงุฏู ูุฏุฑุช ููุงุจุน ุงุณุช. ููุจุน ฺุฒ ุงุณุช ฺฉู ุจุงุฏ ุฏุฑุงูุช ุดุฏู ู ุจุนุฏุงู (ุจู ุตูุฑุช ุตุฑุญ ุง ุถูู) ุขุฒุงุฏ ุดูุฏ. ูุซุงูโูุง ุงุฒ ููุงุจุน ุดุงูู ุญุงูุธูุ ูููโูุงุ ุณูฺฉุชโูุงุ ุฏุณุชฺฏุฑูโูุง ูุฎ (thread handles) ู ุฏุณุชฺฏุฑูโูุง ูุงู ูุณุชูุฏ. ุฏุฑ ฺฉ ุจุฑูุงูู ุจููุฏูุฏุชุ ุขุฒุงุฏ ูฺฉุฑุฏู ฺฉ ููุจุน ุจูโูููุน (ยซูุดุชยป) ูโุชูุงูุฏ ุจุงุนุซ ฺฉุงูุด ุดุฏุฏ ฺฉุงุฑุง ู ุญุช ููุฌุฑ ุจู ฺฉ ุฎุฑุงุจ ูุงฺฏูุงุฑ ุดูุฏ. ุญุช ุฏุฑ ุจุฑูุงููโูุง ฺฉูุชุงูโูุฏุชุ ูุดุช ููุงุจุน ูโุชูุงูุฏ ูุดฺฉูโุณุงุฒ ุดูุฏุ ูุซูุงู ุจุง ุงุฌุงุฏ ฺฉูุจูุฏ ููุงุจุนุ ุฒูุงู ุงุฌุฑุง ุจุฑูุงูู ุจู ุทุฑุฒ ฺุดูฺฏุฑ ุงูุฒุงุด ุงุจุฏ.

ุงุฌุฒุง ฺฉุชุงุจุฎุงูู ุงุณุชุงูุฏุงุฑุฏ ุจู ฺฏูููโุง ุทุฑุงุญ ุดุฏูโุงูุฏ ฺฉู ููุงุจุน ุฑุง ูุดุช ูุฏููุฏ. ุจุฑุง ุฏุณุชุงุจ ุจู ุงู ูุฏูุ ุขูโูุง ุจู ูพุดุชุจุงู ูพุงูโุง ุฒุจุงู ุจุฑุง ูุฏุฑุช ููุงุจุน ุจุง ุงุณุชูุงุฏู ุงุฒ ุฌูุชโูุง ุณุงุฒูุฏู/ูุฑุงูฺฏุฑ (constructor/destructor) ุชฺฉู ูโฺฉููุฏ ุชุง ุงุทููุงู ุญุงุตู ุดูุฏ ฺฉู ฺฉ ููุจุน ุทูู ุนูุฑ ุจุดุชุฑ ูุณุจุช ุจู ุดุก ูุณุฆูู ุขู ูุฏุงุดุชู ุจุงุดุฏ. ุงุณุชูุงุฏู ุงุฒ ุฌูุช ุณุงุฒูุฏู/ูุฑุงูฺฏุฑ ุฏุฑ ฺฉูุงุณ **Vector** ุจุฑุง ูุฏุฑุช ุทูู ุนูุฑ ุนูุงุตุฑุด ฺฉ ููููู ุงุณุช (ุจุฎุด ยง3.2.1.2) ู ุชูุงู ฺฉุงูุชูุฑูุง ฺฉุชุงุจุฎุงูู ุงุณุชุงูุฏุงุฑุฏ ุจู ุฑูุดโูุง ูุดุงุจู ูพุงุฏูโุณุงุฒ ุดุฏูโุงูุฏ. ูููโุชุฑ ุงุฒ ูููุ ุงู ุฑูุด ุจู ุฏุฑุณุช ุจุง ูุฏุฑุช ุฎุทุง ุงุฒ ุทุฑู ุงุณุชุซูุงูุง ุชุนุงูู ุฏุงุฑุฏ. ุจูโุนููุงู ูุซุงูุ ุงู ุชฺฉูฺฉ ุฏุฑ ฺฉูุงุณโูุง ููู ฺฉุชุงุจุฎุงูู ุงุณุชุงูุฏุงุฑุฏ ุงุณุชูุงุฏู ูโุดูุฏ:

```cpp
mutex m; // ุจุฑุง ูุญุงูุธุช ุงุฒ ุฏุณุชุฑุณ ุจู ุฏุงุฏูโูุง ูุดุชุฑฺฉ
// ...
void f()
{
    unique_lock<mutex> lck {m}; // ููู mutex m ุฑุง ุฏุฑุงูุช ฺฉู
    // ... ุฏุณุชฺฉุงุฑ ุฏุงุฏูโูุง ูุดุชุฑฺฉ ...
}
```

ฺฉ ูุฎ (thread) ุชุง ุฒูุงู ฺฉู ุณุงุฒูุฏู **lck** ููู **m** ุฑุง ุฏุฑุงูุช ูฺฉูุฏุ ูพุด ูุฎูุงูุฏ ุฑูุช (ุจุฎุด ยง5.3.4). ูุฑุงูฺฏุฑ ูุชูุงุธุฑ ุงู ููุจุน ุฑุง ุขุฒุงุฏ ูโฺฉูุฏ. ุจูุงุจุฑุงูุ ุฏุฑ ุงู ูุซุงูุ ูุฑุงูฺฏุฑ **unique_lock** ููู **mutex** ุฑุง ุฒูุงู ฺฉู ฺฉูุชุฑู ุงุฒ ุชุงุจุน **f()** ุฎุงุฑุฌ ูโุดูุฏ (ฺู ุงุฒ ุทุฑู ุจุงุฒฺฏุดุชุ ฺู ุจูโุตูุฑุช ุทุจุน ุจุง ุฑุณุฏู ุจู ุงูุชูุง ุชุงุจุนุ ุง ุงุฒ ุทุฑู ูพุฑุชุงุจ ุงุณุชุซูุง) ุขุฒุงุฏ ูโฺฉูุฏ.

ุงู ฺฉ ฺฉุงุฑุจุฑุฏ ุงุฒ ุชฺฉูฺฉ ยซุฏุฑุงูุช ููุจุน ุจู ูุนูุง ููุฏุงุฑุฏู ุงููู ุงุณุชยป (RAIIุ ุจุฎุดโูุง ยง3.2.1.2 ู ยง13.3) ุงุณุช. ุงู ุชฺฉูฺฉ ูพุงูโุง ุจุฑุง ูุฏุฑุช ุงุฏุฆุงู ููุงุจุน ุฏุฑ ุฒุจุงู C++ ูุญุณูุจ ูโุดูุฏ. ฺฉุงูุชูุฑูุง (ูุงููุฏ **vector** ู **map**)ุ ุฑุดุชู (**string**)ุ ู ุฌุฑุงูโูุง ูุฑูุฏ/ุฎุฑูุฌ (**iostream**) ููุงุจุน ุฎูุฏ (ูุงููุฏ ุฏุณุชฺฏุฑูโูุง ูุงู ู ุจุงูุฑูุง) ุฑุง ุจู ููู ุดูู ูุฏุฑุช ูโฺฉููุฏ.

## unique_ptr and shared_ptr
ูุซุงูโูุง ฺฉู ุชุง ฺฉููู ุจุฑุฑุณ ุดุฏูุฏุ ูุฏุฑุช ุงุดุงุก ุชุนุฑูโุดุฏู ุฏุฑ ฺฉ ุฏุงููู (scope) ู ุขุฒุงุฏุณุงุฒ ููุงุจุน ุขูโูุง ููฺฏุงู ุฎุฑูุฌ ุงุฒ ุฏุงููู ุฑุง ูพูุดุด ูโุฏููุฏุ ุงูุง ุฏุฑ ููุฑุฏ ุงุดุง ฺฉู ุฏุฑ ุญุงูุธู ุขุฒุงุฏ (free store) ุชุฎุตุต ุฏุงุฏู ูโุดููุฏ ฺู ุจุงุฏ ฺฉุฑุฏุ ุฏุฑ ฺฉุชุงุจุฎุงูู ุงุณุชุงูุฏุงุฑุฏ ู ุฏุฑ ูุฏุฑ **<memory>**ุ ุฏู ยซุงุดุงุฑูโฺฏุฑ ููุดููุฏยป ุจุฑุง ฺฉูฺฉ ุจู ูุฏุฑุช ุงุดุงุก ุฏุฑ ุญุงูุธู ุขุฒุงุฏ ุงุฑุงุฆู ุดุฏู ุงุณุช:  
1. **unique_ptr** ุจุฑุง ููุงุด ูุงูฺฉุช ฺฉุชุง (ยง34.3.1)  
2. **shared_ptr** ุจุฑุง ููุงุด ูุงูฺฉุช ุงุดุชุฑุงฺฉ (ยง34.3.2)  

ุงุณุชูุงุฏู ุงุณุงุณ ุงุฒ ุงู ยซุงุดุงุฑูโฺฏุฑูุง ููุดููุฏยป ุฌููฺฏุฑ ุงุฒ ูุดุช ุญุงูุธู ูุงุด ุงุฒ ุจุฑูุงููโููุณ ุจโุฏูุช ุงุณุช. ุจู ุนููุงู ูุซุงู:

```cpp
void f(int i, int j) // X* ุฏุฑ ููุงุจู unique_ptr<X>
{
    X* p = new X; // ุชุฎุตุต ฺฉ X ุฌุฏุฏ
    unique_ptr<X> sp {new X}; // ุชุฎุตุต ฺฉ X ุฌุฏุฏ ู ูุงฺฏุฐุงุฑ ุงุดุงุฑูโฺฏุฑ ุขู ุจู unique_ptr
    // ...
    if (i<99) throw Z{}; // ููฺฉู ุงุณุช ฺฉ ุงุณุชุซูุง ูพุฑุชุงุจ ุดูุฏ
    if (j<77) return; // ููฺฉู ุงุณุช ุฒูุฏุชุฑ ุงุฒ ุชุงุจุน ุจุงุฒฺฏุฑุฏู
    p->do_something(); // ููฺฉู ุงุณุช ฺฉ ุงุณุชุซูุง ูพุฑุชุงุจ ุดูุฏ
    sp->do_something(); // ููฺฉู ุงุณุช ฺฉ ุงุณุชุซูุง ูพุฑุชุงุจ ุดูุฏ
    // ...
    delete p; // ูุงุจูุฏ ฺฉุฑุฏู *p
}
```

ุฏุฑ ุงูุฌุงุ ุงฺฏุฑ **i < 99** ุง **j < 77** ุจุงุดุฏุ ูุฑุงููุด ฺฉุฑุฏู ฺฉู **p** ุฑุง ุขุฒุงุฏ ฺฉูู. ุงุฒ ุณู ุฏฺฏุฑุ **unique_ptr** ุชุถูู ูโฺฉูุฏ ฺฉู ุดุก ูุฑุชุจุท ุจู ุฏุฑุณุช ูุงุจูุฏ ูโุดูุฏุ ุตุฑูโูุธุฑ ุงุฒ ุงู ฺฉู ฺฺฏููู ุงุฒ ุชุงุจุน **f()** ุฎุงุฑุฌ ูโุดูู (ฺู ุงุฒ ุทุฑู ูพุฑุชุงุจ ุงุณุชุซูุงุ ุจุงุฒฺฏุดุช ุง ุฑุณุฏู ุจู ุงูุชูุง ุชุงุจุน). ุฌุงูุจ ุงูุฌุงุณุช ฺฉู ูโุชูุงูุณุชู ุงู ูุดฺฉู ุฑุง ุจู ุณุงุฏฺฏ ุจุง ุนุฏู ุงุณุชูุงุฏู ุงุฒ ุงุดุงุฑูโฺฏุฑ ู **new** ุญู ฺฉูู:

```cpp
void f(int i, int j) // ุงุณุชูุงุฏู ุงุฒ ฺฉ ูุชุบุฑ ูุญู
{
    X x;
    // ...
}
```

ูุชุฃุณูุงููุ ุงุณุชูุงุฏู ุจุด ุงุฒ ุญุฏ ุงุฒ **new** (ู ููฺูู ุงุดุงุฑูโฺฏุฑูุง ู ูุฑุงุฌุน) ุจู ูุธุฑ ูโุฑุณุฏ ฺฉู ฺฉ ูุดฺฉู ุฑู ุจู ุฑุดุฏ ุงุณุช. ุจุง ุงู ุญุงูุ ุฒูุงู ฺฉู ูุงูุนุงู ุจู ูุนูุง ุงุดุงุฑูโฺฏุฑูุง ูุงุฒ ุฏุงุฑุฏุ **unique_ptr** ูฺฉุงูุฒู ุจุณุงุฑ ุณุจฺฉ ุจุง ูฺ ูุฒูู ุงุถุงู (ุงุฒ ูุธุฑ ูุถุง ุง ุฒูุงู) ุฏุฑ ููุงุณู ุจุง ุงุณุชูุงุฏู ุตุญุญ ุงุฒ ฺฉ ุงุดุงุฑูโฺฏุฑ ุฏุงุฎู ุงุณุช. ุงุณุชูุงุฏูโูุง ุจุดุชุฑ ุขู ุดุงูู ุงูุชูุงู ุงุดุงุก ุชุฎุตุตโุฏุงุฏูโุดุฏู ุฏุฑ ุญุงูุธู ุขุฒุงุฏ ุจู ุฏุงุฎู ู ุฎุงุฑุฌ ุงุฒ ุชูุงุจุน ุงุณุช:

```cpp
unique_ptr<X> make_X(int i) // ุณุงุฎุช ฺฉ X ู ุงูุชูุงู ููุฑ ุขู ุจู unique_ptr
{
    // ... ุจุฑุฑุณ i ู ุบุฑู ...
    return unique_ptr<X>{new X{i}};
}
```

ฺฉ **unique_ptr** ูุงููุฏ ฺฉ ุฏุณุชู ุจุฑุง ฺฉ ุดุก (ุง ุขุฑุงู) ุนูู ูโฺฉูุฏุ ููุงูโุทูุฑ ฺฉู **vector** ฺฉ ุฏุณุชู ุจุฑุง ุฏูุจุงููโุง ุงุฒ ุงุดุงุก ุงุณุช. ูุฑ ุฏู ุทูู ุนูุฑ ุงุดุงุก ุฏฺฏุฑ ุฑุง ฺฉูุชุฑู ูโฺฉููุฏ (ุจุง ุงุณุชูุงุฏู ุงุฒ RAII) ู ูุฑ ุฏู ุจุฑุง ุณุงุฏู ู ฺฉุงุฑุขูุฏ ฺฉุฑุฏู ุจุงุฒฺฏุดุชุ ุจู ููุงูู ุญุฑฺฉุช (move semantics) ูุชฺฉ ูุณุชูุฏ.

**shared_ptr** ูุดุงุจู **unique_ptr** ุงุณุชุ ุจุง ุงู ุชูุงูุช ฺฉู **shared_ptr** ุจู ุฌุง ุงูุชูุงูุ ฺฉูพ ูโุดูุฏ. **shared_ptr**โูุง ูุงูฺฉุช ฺฉ ุดุก ุฑุง ุจู ุงุดุชุฑุงฺฉ ูโฺฏุฐุงุฑูุฏ ู ุขู ุดุก ุฒูุงู ูุงุจูุฏ ูโุดูุฏ ฺฉู ุขุฎุฑู **shared_ptr** ูุฑุชุจุท ูุงุจูุฏ ุดูุฏ. ุจุฑุง ูุซุงู:

```cpp
void f(shared_ptr<fstream>);
void g(shared_ptr<fstream>);
void user(const string& name, ios_base::openmode mode)
{
    shared_ptr<fstream> fp {new fstream(name, mode)};
    if (!*fp) throw No_file{}; // ุงุทููุงู ุงุฒ ุจุงุฒ ุดุฏู ุตุญุญ ูุงู
    f(fp);
    g(fp);
    // ...
}
```

ุฏุฑ ุงูุฌุงุ ูุงู ฺฉู ุชูุณุท ุณุงุฒูุฏู **fp** ุจุงุฒ ุดุฏู ุงุณุชุ ุชูุณุท ุขุฎุฑู ุชุงุจุน ฺฉู ูุณุฎูโุง ุงุฒ **fp** ุฑุง (ุจู ุตูุฑุช ุตุฑุญ ุง ุถูู) ูุงุจูุฏ ูโฺฉูุฏุ ุจุณุชู ุฎูุงูุฏ ุดุฏ. ุชูุฌู ฺฉูุฏ ฺฉู **f()** ุง **g()** ููฺฉู ุงุณุช ฺฉ ุชุณฺฉ ุงุฌุงุฏ ฺฉููุฏ ฺฉู ูุณุฎูโุง ุงุฒ **fp** ุฑุง ูฺฏู ุฏุงุฑุฏ ุง ุจู ูุญู ุฏฺฏุฑ ฺฉูพโุง ุฑุง ุฐุฎุฑู ฺฉูุฏ ฺฉู ุทูู ุนูุฑ ุจุดุชุฑ ูุณุจุช ุจู **user()** ุฏุงุดุชู ุจุงุดุฏ. ุจูุงุจุฑุงูุ **shared_ptr** ููุน ุงุฒ ุฌูุนโุขูุฑ ุฒุจุงูู (garbage collection) ุงุฑุงุฆู ูโุฏูุฏ ฺฉู ุจู ูุฏุฑุช ููุงุจุน ูุจุชู ุจุฑ ูุฑุงูฺฏุฑ ุงุญุชุฑุงู ูโฺฏุฐุงุฑุฏ. ุงู ุฑูุด ูู ุฑุงฺฏุงู ุงุณุช ู ูู ุจุด ุงุฒ ุญุฏ ฺฏุฑุงูุ ุงูุง ุทูู ุนูุฑ ุดุก ูุดุชุฑฺฉ ุฑุง ูพุดโุจูโูุงูพุฐุฑ ูโฺฉูุฏ. ุงุฒ **shared_ptr** ููุท ุฒูุงู ุงุณุชูุงุฏู ฺฉูุฏ ฺฉู ูุงูุนุงู ุจู ูุงูฺฉุช ูุดุชุฑฺฉ ูุงุฒ ุฏุงุฑุฏ.

ุจุง ุฏุงุดุชู **unique_ptr** ู **shared_ptr**ุ ูโุชูุงูู ฺฉ ุณุงุณุช ฺฉุงูู ยซุนุฏู ุงุณุชูุงุฏู ุงุฒ **new** ูุณุชููยป (ยง3.2.1.2) ุฑุง ุจุฑุง ุจุณุงุฑ ุงุฒ ุจุฑูุงููโูุง ุงุนูุงู ฺฉูู. ุจุง ุงู ุญุงูุ ุงู ยซุงุดุงุฑูโฺฏุฑูุง ููุดููุฏยป ูููุฒ ูู ุจู ุตูุฑุช ููููู ุงุดุงุฑูโฺฏุฑ ูุณุชูุฏ ู ุจูุงุจุฑุงู ุชููุง ฺฏุฒูู ุฏูู ูู ุจุฑุง ูุฏุฑุช ููุงุจุน ุจู ุดูุงุฑ ูโุฑููุฏ โ ูพุณ ุงุฒ ฺฉุงูุชูุฑูุง ู ุงููุงุน ุฏฺฏุฑ ฺฉู ููุงุจุน ุฑุง ุฏุฑ ฺฉ ุณุทุญ ููููู ุจุงูุงุชุฑ ูุฏุฑุช ูโฺฉููุฏ. ุจู ุทูุฑ ุฎุงุตุ **shared_ptr** ุจู ุชููุง ูฺ ูุงููู ุจุฑุง ุชุนู ุงูฺฉู ฺฉุฏุงู ูุงูฺฉู ูโุชูุงููุฏ ุดุก ูุดุชุฑฺฉ ุฑุง ุจุฎูุงููุฏ ู/ุง ุจููุณูุฏ ุงุฑุงุฆู ููโุฏูุฏ. ุฑูุงุจุช ุฏุงุฏูโูุง (ยง41.2.4) ู ุฏฺฏุฑ ุงุดฺฉุงู ุณุฑุฏุฑฺฏู ููุท ุจุง ุญุฐู ูุดฺฉูุงุช ูุฏุฑุช ููุงุจุน ุญู ููโุดููุฏ.

ฺฉุฌุง ุจุงุฏ ุงุฒ ยซุงุดุงุฑูโฺฏุฑูุง ููุดููุฏยป (ูุงููุฏ **unique_ptr**) ุจู ุฌุง ุฏุณุชูโูุง ููุงุจุน ุจุง ุนููุงุช ุทุฑุงุญโุดุฏู ูุฎุตูุต ุจุฑุง ููุจุน (ูุงููุฏ **vector** ุง **thread**) ุงุณุชูุงุฏู ฺฉููุ ุฌุง ุชุนุฌุจ ูุณุช ฺฉู ูพุงุณุฎ ุงู ุงุณุช: ยซููุช ุจู ูุนูุง ุงุดุงุฑูโฺฏุฑ ูุงุฒ ุฏุงุฑู.ยป  
- ููุช ุดุก ุฑุง ุจู ุงุดุชุฑุงฺฉ ูโฺฏุฐุงุฑูุ ุจุฑุง ุงุดุงุฑู ุจู ุขู ุจู ุงุดุงุฑูโฺฏุฑ (ุง ูุฑุฌุน) ูุงุฒ ุฏุงุฑูุ ุจูุงุจุฑุงู **shared_ptr** ุงูุชุฎุงุจ ูุงุถุญ ุงุณุช (ูฺฏุฑ ุงูฺฉู ฺฉ ูุงูฺฉ ูุงุถุญ ูุฌูุฏ ุฏุงุดุชู ุจุงุดุฏ).  
- ููุช ุจู ฺฉ ุดุก ฺูุฏุดฺฉู (polymorphic) ุงุดุงุฑู ูโฺฉููุ ูุงุฒ ุจู ฺฉ ุงุดุงุฑูโฺฏุฑ (ุง ูุฑุฌุน) ุฏุงุฑูุ ุฒุฑุง ููุน ุฏูู ุดุก ููุฑุฏ ุงุดุงุฑู ุง ุญุช ุงูุฏุงุฒู ุขู ุฑุง ููโุฏุงูู. ุจูุงุจุฑุงู **unique_ptr** ุงูุชุฎุงุจ ูุงุถุญ ุงุณุช.  
- ฺฉ ุดุก ฺูุฏุดฺฉู ูุดุชุฑฺฉ ูุนูููุงู ุจู **shared_ptr** ูุงุฒ ุฏุงุฑุฏ.  

ูุง ูุงุฒ ุจู ุงุณุชูุงุฏู ุงุฒ ุงุดุงุฑูโฺฏุฑ ุจุฑุง ุจุงุฒฺฏุฑุฏุงูุฏู ฺฉ ูุฌููุนู ุงุฒ ุงุดุงุก ุงุฒ ฺฉ ุชุงุจุน ูุฏุงุฑูุ ฺฉ ฺฉุงูุชูุฑ ฺฉู ุฏุณุชูโุง ุจุฑุง ููุงุจุน ุงุณุช ุงู ฺฉุงุฑ ุฑุง ุจู ุณุงุฏฺฏ ู ุจู ุทูุฑ ฺฉุงุฑุขูุฏ ุงูุฌุงู ูโุฏูุฏ (ยง3.3.2).

## Concurrency
ููโุฑููุฏ (Concurrency) โ ุงุฌุฑุง ููุฒูุงู ฺูุฏู ูุธูู โ ุจู ุทูุฑ ฺฏุณุชุฑุฏู ุจุฑุง **ุงูุฒุงุด ุชูุงู ุนููุงุช** (ุจุง ุงุณุชูุงุฏู ุงุฒ ฺูุฏู ูพุฑุฏุงุฒูุฏู ุจุฑุง ฺฉ ูุญุงุณุจู) ุง **ุจูุจูุฏ ูพุงุณุฎโุฏู** (ุจุง ุงุฌุงุฒู ุฏุงุฏู ุจู ฺฉ ุจุฎุด ุงุฒ ุจุฑูุงูู ุจุฑุง ูพุดุฑูุช ุฏุฑ ุญุงู ฺฉู ุจุฎุด ุฏฺฏุฑ ููุชุธุฑ ูพุงุณุฎ ุงุณุช) ุงุณุชูุงุฏู ูโุดูุฏ. ุชูุงู ุฒุจุงูโูุง ุจุฑูุงููโููุณ ูุฏุฑู ุงุฒ ุงู ูุงุจูุช ูพุดุชุจุงู ูโฺฉููุฏ. ูพุดุชุจุงู ุงุฑุงุฆู ุดุฏู ุชูุณุท ฺฉุชุงุจุฎุงูู ุงุณุชุงูุฏุงุฑุฏ ++Cุ ฺฉ ูุณุฎู ูุงุจู ุญูู (portable) ู ููุน-ุงูู (type-safe) ุงุฒ ฺุฒ ุงุณุช ฺฉู ุจุฑุง ุจุด ุงุฒ 20 ุณุงู ุฏุฑ ++C ุงุณุชูุงุฏู ุดุฏู ู ุชูุฑุจุงู ุชูุณุท ุชูุงู ุณุฎุชโุงูุฒุงุฑูุง ูุฏุฑู ูพุดุชุจุงู ูโุดูุฏ. 

ูพุดุชุจุงู ฺฉุชุงุจุฎุงูู ุงุณุชุงูุฏุงุฑุฏุ ุนูุฏุชุงู ุจุง ูุฏู ูพุดุชุจุงู ุงุฒ ููโุฑููุฏ ุฏุฑ ุณุทุญ ุณุณุชู ุงุฑุงุฆู ุดุฏู ุงุณุชุ ูู ุจุฑุง ุงุฑุงุฆู ูุณุชูู ูุฏูโูุง ูพุดุฑูุชูโุชุฑ ููโุฑููุฏุ ฺูู ูุฏูโูุง ูพุดุฑูุชูโุง ูโุชูุงููุฏ ุจู ุตูุฑุช ฺฉุชุงุจุฎุงููโูุง ุณุงุฎุชู ุดููุฏ ฺฉู ุงุฒ ุงูฺฉุงูุงุช ฺฉุชุงุจุฎุงูู ุงุณุชุงูุฏุงุฑุฏ ุงุณุชูุงุฏู ูโฺฉููุฏ.

ฺฉุชุงุจุฎุงูู ุงุณุชุงูุฏุงุฑุฏ ุจู ุทูุฑ ูุณุชูู ุงุฒ ุงุฌุฑุง ููโุฒูุงู ฺูุฏู ูุฎ (threads) ุฏุฑ ฺฉ ูุถุง ุขุฏุฑุณ ูพุดุชุจุงู ูโฺฉูุฏ. ุจุฑุง ุงู ููุธูุฑุ ++C ฺฉ **ูุฏู ุญุงูุธู ููุงุณุจ** (ยง41.2) ู ูุฌููุนูโุง ุงุฒ **ุนููุงุช ุงุชู** (ยง41.3) ูุฑุงูู ูโฺฉูุฏ. ุจุง ุงู ุญุงูุ ุงฺฉุซุฑ ฺฉุงุฑุจุฑุงู ููโุฑููุฏ ุฑุง ุชููุง ุงุฒ ุทุฑู ฺฉุชุงุจุฎุงูู ุงุณุชุงูุฏุงุฑุฏ ู ฺฉุชุงุจุฎุงููโูุง ฺฉู ุจุฑ ูพุงู ุขู ุณุงุฎุชู ุดุฏูโุงูุฏ ูุดุงูุฏู ูโฺฉููุฏ. 

ุงู ุจุฎุด ุจู ุทูุฑ ุฎูุงุตู ูุซุงูโูุง ุงุฒ ุงูฺฉุงูุงุช ุงุตู ูพุดุชุจุงู ููโุฑููุฏ ุฏุฑ ฺฉุชุงุจุฎุงูู ุงุณุชุงูุฏุงุฑุฏ ุงุฑุงุฆู ูโุฏูุฏ: **ูุฎโูุง (threads)**ุ **ูููโูุง (mutexes)**ุ **ุนููุงุช lock()**ุ **ูุธุงู ุจุณุชูโุจูุฏโุดุฏู (packaged_tasks)** ู **ุขูุฏูโูุง (futures)**. ุงู ูฺฺฏโูุง ุจู ุทูุฑ ูุณุชูู ุจุฑ ุงุณุงุณ ุงูฺฉุงูุงุช ุงุฑุงุฆูโุดุฏู ุชูุณุท ุณุณุชูโุนุงููโูุง ุณุงุฎุชู ุดุฏูโุงูุฏ ู **ูฺฺฏููู ฺฉุงูุด ฺฉุงุฑุง** ูุณุจุช ุจู ุงูฺฉุงูุงุช ุณุณุชูโุนุงูู ูุฏุงุฑูุฏ.

## Tasks and threads
ูุง ุจู ูุญุงุณุจุงุช ฺฉู ูโุชูุงููุฏ ุจู ุทูุฑ ููุฒูุงู ุจุง ุณุงุฑ ูุญุงุณุจุงุช ุงุฌุฑุง ุดููุฏุ **ูุธูู (task)** ูโฺฏูู. ฺฉ **ูุฎ (thread)** ููุงุด ุฏุฑ ุณุทุญ ุณุณุชู ุงุฒ ฺฉ ูุธูู ุฏุฑ ฺฉ ุจุฑูุงูู ุงุณุช. ุจุฑุง ุงุฌุฑุง ฺฉ ูุธูู ุจู ุตูุฑุช ููุฒูุงู ุจุง ุณุงุฑ ูุธุงูุ ุจุงุฏ ุจุง ุณุงุฎุชู ฺฉ `std::thread` (ุงุฒ ฺฉุชุงุจุฎุงูู `<thread>`) ูุธูู ููุฑุฏูุธุฑ ุฑุง ุจู ุนููุงู ุขุฑฺฏููุงู ุจู ุขู ููุชูู ฺฉูู. ฺฉ ูุธูู ูโุชูุงูุฏ ฺฉ ุชุงุจุน ุง ฺฉ ุดุก ุชุงุจุน (function object) ุจุงุดุฏ:

```cpp
void f(); // ุชุงุจุน
struct F { // ุดุก ุชุงุจุน
    void operator()(); // ุนููฺฏุฑ () ุจุฑุง F
};
```

### ูุซุงู:
ุฏุฑ ุงู ูุซุงูุ ุฏู ูุฎ ุงุฌุงุฏ ูโุดููุฏ ฺฉู ูุฑ ฺฉ ูุธููโุง ุฑุง ุจู ุตูุฑุช ููุฒูุงู ุงุฌุฑุง ูโฺฉููุฏ:

```cpp
void user() {
    thread t1 {f}; // ุงุฌุฑุง f() ุฏุฑ ฺฉ ูุฎ ุฌุฏุงฺฏุงูู
    thread t2 {F()}; // ุงุฌุฑุง F()() ุฏุฑ ฺฉ ูุฎ ุฌุฏุงฺฏุงูู
    t1.join(); // ููุชุธุฑ ูพุงุงู t1
    t2.join(); // ููุชุธุฑ ูพุงุงู t2
}
```

ูุชุฏ `join()` ุชุถูู ูโฺฉูุฏ ฺฉู ุงุฒ ุชุงุจุน `user()` ุฎุงุฑุฌ ูุดูู ุชุง ุฒูุงู ฺฉู ูุฎโูุง ฺฉุงุฑุดุงู ุฑุง ุจู ูพุงุงู ุจุฑุณุงููุฏ. ููููู "join" ุนู "ููุชุธุฑ ูุงูุฏู ุจุฑุง ูพุงุงู ูุฎ".

---

### ุชูุงูุช ูุฎโูุง ุจุง ูุฑุขูุฏูุง:
- ูุฎโูุง ฺฉ ุจุฑูุงูู **ฺฉ ูุถุง ุขุฏุฑุณ ูุดุชุฑฺฉ** ุฏุงุฑูุฏ. 
- ุจุฑุฎูุงู ูุฎโูุงุ ูุฑุขูุฏูุง ูุนูููุงู ุฏุงุฏูโูุง ุฑุง ุจู ุทูุฑ ูุณุชูู ุจุง ฺฉุฏฺฏุฑ ุจู ุงุดุชุฑุงฺฉ ููโฺฏุฐุงุฑูุฏ.
- ุจู ุฏูู ุงุดุชุฑุงฺฉ ูุถุง ุขุฏุฑุณุ ูุฎโูุง ูโุชูุงููุฏ ุงุฒ ุทุฑู **ุงุดุง ูุดุชุฑฺฉ** ุจุง ฺฉุฏฺฏุฑ ุงุฑุชุจุงุท ุจุฑูุฑุงุฑ ฺฉููุฏ. ุงู ุงุฑุชุจุงุท ูุนูููุงู ุชูุณุท **ูููโูุง (locks)** ุง ุณุงุฑ ูฺฉุงูุฒูโูุง ฺฉูุชุฑู ูโุดูุฏ ุชุง ุงุฒ **data race** (ุฏุณุชุฑุณ ููุฒูุงู ู ฺฉูุชุฑูโูุดุฏู ุจู ฺฉ ูุชุบุฑ) ุฌููฺฏุฑ ุดูุฏ.

---

### ูุดฺฉู ุฏุฑ ููโุฒูุงู ู ูุซุงู ุฎุทุง:
ููุดุชู ุจุฑูุงููโูุง ููโุฒูุงู ููฺฉู ุงุณุช ุจุณุงุฑ ุฏุดูุงุฑ ุจุงุดุฏ. ุจู ุนููุงู ูุซุงูุ ูุธุงู ุฒุฑ ุชุนุฑู ุดุฏูโุงูุฏ:

```cpp
void f() { cout << "Hello "; }
struct F {
    void operator()() { cout << "Parallel World!\n"; }
};
```

ุงฺฏุฑ ุฏู ูุฎ ุจู ุทูุฑ ููุฒูุงู ุงู ูุธุงู ุฑุง ุงุฌุฑุง ฺฉููุฏ:

```cpp
thread t1 {f};
thread t2 {F()};
t1.join();
t2.join();
```

ุงู ฺฉุฏ ฺฉ **ุฎุทุง ุจุฏ** ุงุณุช. ูุฑ ุฏู ูุธูู ุงุฒ ุดุก `cout` ุจู ุทูุฑ ููุฒูุงู ุงุณุชูุงุฏู ูโฺฉููุฏุ ุงูุง **ุจุฏูู ูฺโฺฏููู ููโุฒูุงูโุณุงุฒ (synchronization)**. 

ุฎุฑูุฌ ุญุงุตู ูโุชูุงูุฏ ุบุฑูุงุจู ูพุดโุจู ุจุงุดุฏ ู ุฏุฑ ุงุฌุฑุงโูุง ูุฎุชูู ุจุฑูุงูู ูุชูุงูุช ุจุงุดุฏ. ุจุฑุง ูุซุงูุ ููฺฉู ุงุณุช ุฎุฑูุฌ ุฒุฑ ุชููุฏ ุดูุฏ:

```
PaHerallllel o World!
```

---

### ุฑุงูโุญู ู ูฺฉุชู ููู:
ุจุฑุง ุชุนุฑู ูุธุงู ุฏุฑ ฺฉ ุจุฑูุงูู ููโุฒูุงูุ ูุฏู ุงู ุงุณุช ฺฉู:
1. **ูุธุงู ุฑุง ฺฉุงููุงู ุฌุฏุง ุงุฒ ูู ูฺฏู ุฏุงุฑู**ุ ูฺฏุฑ ุฏุฑ ุฌุงูุง ฺฉู ุงุฑุชุจุงุทุงุช ุณุงุฏู ู ูุงุถุญ ุจู ุขูโูุง ูุฌูุฏ ุฏุงุฑุฏ.
2. **ูุธุงู ุฑุง ุจู ุตูุฑุช ุงุฒููู ุชุนุฑู ฺฉูู**: ุนู ุฏุงุฏูโูุง ูุดุชุฑฺฉ ูุจุงุฏ ุจุฏูู ฺฉูุชุฑู ุงุณุชูุงุฏู ุดููุฏ.

ุณุงุฏูโุชุฑู ุฑุงู ุจุฑุง ูฺฉุฑ ฺฉุฑุฏู ุจู ฺฉ ูุธูู ููโุฒูุงูุ ุงู ุงุณุช ฺฉู ุจู ุขู ุจู ฺุดู ฺฉ ุชุงุจุน ูฺฏุงู ฺฉูู ฺฉู ุจู ุทูุฑ ููุฒูุงู ุจุง ูุฑุงุฎูุงููุฏู ุฎูุฏ ุงุฌุฑุง ูโุดูุฏ. ุจุฑุง ุงู ฺฉุงุฑ ุจุงุฏ:
- ุขุฑฺฏููุงูโูุง ุฑุง ููุชูู ฺฉููุ
- ูุชุฌู ุฑุง ุฏุฑุงูุช ฺฉููุ
- ู ุงุทููุงู ุญุงุตู ฺฉูู ฺฉู ุฏุงุฏูโูุง ูุดุชุฑฺฉ ุจู ุตูุฑุช ูุงุงูู ุงุณุชูุงุฏู ููโุดููุฏ (ุนู **data race** ูุฌูุฏ ูุฏุงุดุชู ุจุงุดุฏ).

## Passing Arguments
ูุนูููุงูุ ฺฉ ูุธูู (task) ุจุฑุง ุงุฌุฑุง ูุงุฒ ุจู ุฏุงุฏูโุง ุฏุงุฑุฏ ฺฉู ุฑู ุขู ฺฉุงุฑ ฺฉูุฏ. ูุง ูโุชูุงูู ุฏุงุฏูโูุง (ุง ุงุดุงุฑูโฺฏุฑูุง ู ูุฑุงุฌุน ุจู ุฏุงุฏูโูุง) ุฑุง ุจูโุฑุงุญุช ุจูโุนููุงู ุขุฑฺฏููุงู ุงุฑุณุงู ฺฉูู. ุจูโุนููุงูโูุซุงู:

```cpp
void f(vector<double>& v); // ุชุงุจุน ฺฉู ฺฉุงุฑ ุฑุง ุจุฑ ุฑู v ุงูุฌุงู ูโุฏูุฏ

struct F { // ุดุก ุชุงุจุน ฺฉู ฺฉุงุฑ ุฑุง ุจุฑ ุฑู v ุงูุฌุงู ูโุฏูุฏ
    vector<double>& v;
    F(vector<double>& vv) : v{vv} { }
    void operator()(); // ุนููฺฏุฑ ฺฉุงุฑุจุฑุฏ (application operator)
};

int main()
{
    vector<double> some_vec {1,2,3,4,5,6,7,8,9};
    vector<double> vec2 {10,11,12,13,14};

    thread t1 {f, some_vec}; // ุงุฌุฑุง f(some_vec) ุฏุฑ ฺฉ ุฑุดุชู (thread) ุฌุฏุงฺฏุงูู
    thread t2 {F{vec2}}; // ุงุฌุฑุง F(vec2)() ุฏุฑ ฺฉ ุฑุดุชู ุฌุฏุงฺฏุงูู

    t1.join();
    t2.join();
}
```

ูุงุถุญ ุงุณุช ฺฉู `F{vec2}` ฺฉ **ูุฑุฌุน** ุจู ุจุฑุฏุงุฑ `vec2` ุฑุง ุฏุฑ ฺฉูุงุณ `F` ุฐุฎุฑู ูโฺฉูุฏ. ุงฺฉููู `F` ูโุชูุงูุฏ ุงุฒ ุงู ุจุฑุฏุงุฑ ุงุณุชูุงุฏู ฺฉูุฏุ ุจู ุงู ุงูุฏ ฺฉู ูฺ ูุธููโ ุฏฺฏุฑ ุฏุฑ ุญู ุงุฌุฑุง `F` ุจู `vec2` ุฏุณุชุฑุณ ูุฏุงุดุชู ุจุงุดุฏ. ุงฺฏุฑ `vec2` ุฑุง **ุจุง ููุฏุงุฑ** (by value) ุงุฑุณุงู ฺฉููุ ุงู ุฑุณฺฉ ุงุฒ ุจู ูโุฑูุฏ.

**ููุฏุงุฑุฏู ุงููู ุจุง `{f, some_vec}` ุงุฒ ฺฉ ุณุงุฒูุฏูโ ุชุงุจุน ูุชุบุฑ (variadic template constructor) ุฏุฑ ฺฉูุงุณ `thread` ุงุณุชูุงุฏู ูโฺฉูุฏ ฺฉู ูโุชูุงูุฏ ฺฉ ุชูุงู ุฏูุฎูุงู ุงุฒ ุขุฑฺฏููุงูโูุง ุฑุง ุจูพุฐุฑุฏ.** ฺฉุงููพุงูุฑ ุจุฑุฑุณ ูโฺฉูุฏ ฺฉู ุขุง ุขุฑฺฏููุงู ุงูู ูโุชูุงูุฏ ุจุง ุขุฑฺฏููุงูโูุง ุจุนุฏ ูุฑุงุฎูุงู ุดูุฏ ุง ุฎุฑ ู ุฏุฑ ุตูุฑุช ุงูฺฉุงูุ ุดุก ุชุงุจุน ููุฑุฏูุงุฒ ุฑุง ุจุฑุง ุงุฑุณุงู ุจู `thread` ูโุณุงุฒุฏ.

ุจูุงุจุฑุงูุ ุงฺฏุฑ `F::operator()()` ู `f()` **ุงูฺฏูุฑุชู ฺฉุณุงู ุฑุง ุงุฌุฑุง ฺฉููุฏ**ุ ูุญููโ ูพุฑุฏุงุฒุด ุงู ุฏู ูุธูู ุชูุฑุจุงู ูุนุงุฏู ุฎูุงูุฏ ุจูุฏ: ุฏุฑ ูุฑ ุฏู ููุฑุฏุ ฺฉ ุดุก ุชุงุจุน (function object) ุจุฑุง ุงุฌุฑุง ุฏุฑูู **ุฑุดุชู (thread)** ุณุงุฎุชู ูโุดูุฏ.

---

### **ุชูุถุญ ุจุฑูุงูู ู ููููู ุขู**

ุงู ฺฉุฏ **ููุงุฒโุณุงุฒ (multithreading)** ุฏุฑ C++ ุฑุง ูุดุงู ูโุฏูุฏ. ุฏุฑ ุงูุฌุงุ ุฏู ุฑูุด ุจุฑุง ุงุฌุฑุง ฺฉ ุชุงุจุน ุฏุฑ ฺฉ **ุฑุดุชู (thread) ุฌุฏุงฺฏุงูู** ุงุฑุงุฆู ุดุฏู ุงุณุช:

1. **ุงุฑุณุงู ฺฉ ุชุงุจุน ูุนููู (`f`) ุจู ฺฉ ุฑุดุชู (thread)**
2. **ุงุฑุณุงู ฺฉ ุดุก ุชุงุจุน (`F`) ุจู ฺฉ ุฑุดุชู (thread)**

---

### **ฑ. ุงุฑุณุงู ฺฉ ุชุงุจุน ูุนููู ุจู ฺฉ ุฑุดุชู (`thread t1 {f, some_vec};`)**
ุฏุฑ ุงู ุฎุท:
```cpp
thread t1 {f, some_vec}; 
```
- `t1` ฺฉ **ุฑุดุชู ุฌุฏุฏ** ุงุฌุงุฏ ูโฺฉูุฏ ฺฉู ุฏุฑ ุขู ุชุงุจุน `f` ุงุฌุฑุง ุฎูุงูุฏ ุดุฏ.
- `some_vec` ุจูโุนููุงู ุขุฑฺฏููุงู ุจู ุชุงุจุน `f` ุงุฑุณุงู ูโุดูุฏ.
- `f` ุจุงุฏ ฺฉ ุชุงุจุน ุชุนุฑูโุดุฏู ุจุงุดุฏ ฺฉู ูุฑูุฏ ุขู ฺฉ ูุฑุฌุน ุจู `vector<double>` ุงุณุช:

    ```cpp
    void f(vector<double>& v);
    ```

- ููุฏุงุฑุฏู `{f, some_vec}` ุงุฒ **ฺฉ ุณุงุฒูุฏู ุชุงุจุน ูุชุบุฑ (variadic template constructor)** ุฏุฑ ฺฉูุงุณ `thread` ุงุณุชูุงุฏู ูโฺฉูุฏ. 
- ฺฉุงููพุงูุฑ ุจุฑุฑุณ ูโฺฉูุฏ ฺฉู ุขุง `f` ุฑุง ูโุชูุงู ุจุง `some_vec` ูุฑุงุฎูุงู ฺฉุฑุฏุ ุณูพุณ ุดุก ุชุงุจุน ููุฑุฏูุงุฒ ุฑุง ุจุฑุง ุงุฌุฑุง ุฏุฑูู `thread` ูโุณุงุฒุฏ.

---

### **ฒ. ุงุฑุณุงู ฺฉ ุดุก ุชุงุจุน (`F`) ุจู ฺฉ ุฑุดุชู (`thread t2 {F{vec2}};`)**
ุฏุฑ ุงู ูุณูุช:
```cpp
thread t2 {F{vec2}}; 
```
- `F` ฺฉ **ุณุงุฎุชุงุฑ (struct)** ุงุณุช ฺฉู ุดุงูู ฺฉ **ูุฑุฌุน (`vector<double>& v`)** ุจู `vec2` ูโุจุงุดุฏ.
- `F` ฺฉ **ุนููฺฏุฑ ุชุงุจุน (`operator()`)** ุฏุงุฑุฏ ฺฉู ุงูฺฉุงู ุงุฌุฑุง ุขู ุจูโุนููุงู ฺฉ ุชุงุจุน ุฑุง ูโุฏูุฏ.
- ุฏุฑ ุงูุฌุงุ `F{vec2}` ฺฉ ุดุก ุงุฒ `F` ุงุฌุงุฏ ูโฺฉูุฏ ฺฉู ูุฑุฌุน ุจู `vec2` ูฺฏู ูโุฏุงุฑุฏ.
- ุงู ุดุกุ ุณูพุณ ุจู `thread` ุงุฑุณุงู ูโุดูุฏ ฺฉู ุจุงุนุซ ุงุฌุฑุง `F::operator()()` ุฏุฑ ฺฉ ุฑุดุชู ุฌุฏุฏ ูโุดูุฏ.

---

### **ฺุฑุง `vec2` ุฑุง ุจุง ูุฑุฌุน (`&`) ุงุฑุณุงู ูโฺฉููุ**
- ุฏุฑ ุณุงุฎุชุงุฑ `F`ุ `vec2` **ุจุง ูุฑุฌุน (`vector<double>& v`) ุฐุฎุฑู ูโุดูุฏ**.
- ุนู ูุฑ ุชุบุฑ ฺฉู ุฏุฑ `F` ุฑู `v` ุงูุฌุงู ุดูุฏุ ุฑู `vec2` ุงุตู ุงุนูุงู ุฎูุงูุฏ ุดุฏ.
- **ูุดฺฉู ุงู ุฑูุด:** ุงฺฏุฑ ููโุฒูุงู ูุธูู ุฏฺฏุฑ ุฑู `vec2` ุงุฌุฑุง ุดูุฏุ ุงุญุชูุงู ุจุฑูุฒ **ุดุฑุงุท ุฑูุงุจุช (race condition)** ูุฌูุฏ ุฏุงุฑุฏ.
- **ุฑุงูโุญู:** ุงฺฏุฑ `vec2` ุฑุง **ุจุง ููุฏุงุฑ (`by value`)** ุงุฑุณุงู ฺฉููุ ฺฉูพ ุฌุฏุฏ ุงุฒ `vec2` ุงุฌุงุฏ ุดุฏู ู ูุดฺฉู ุฏุฑ ููโุฒูุงู ูพุด ููโุขุฏ.

---

### **ุงุฌุฑุง ููโุฒูุงู ู ููุงููฺฏ (`join`)**
```cpp
t1.join();
t2.join();
```
- `join()` ุจุงุนุซ ูโุดูุฏ ฺฉู `main()` ุชุง ุฒูุงู ูพุงุงู `t1` ู `t2` ููุชุธุฑ ุจูุงูุฏ.
- ุจุฏูู `join()`ุ `main()` ููฺฉู ุงุณุช ูุจู ุงุฒ ุงุชูุงู `t1` ู `t2` ุงุฌุฑุง ุฑุง ุชูุงู ฺฉูุฏ ู ุจุฑูุงูู ุงุฒ ุจู ุจุฑูุฏ.

---

### **ููุงุณู ุฏู ุฑูุด (`f` ู `F::operator()`)**
- ูุฑ ุฏู ุฑูุด ุจู `thread` ฺฉ **ุชุงุจุน ุจุฑุง ุงุฌุฑุง** ูโุฏููุฏ.
- ุฏุฑ ุฑูุด `F`, ฺฉ ุดุก ุชุงุจุน (`function object`) ุณุงุฎุชู ุดุฏู ู ุงุฌุฑุง ูโุดูุฏ.
- ุฏุฑ ุฑูุด `f`, ุงุฒ ฺฉ **ุชุงุจุน ุนุงุฏ** ุงุณุชูุงุฏู ุดุฏู ุงุณุช.
- ุนููฺฉุฑุฏ ููุง ูุฑ ุฏู ุชูุฑุจุงู ฺฉุณุงู ุงุณุช.

---

### **ุฌูุนโุจูุฏ**
โ **ูุญูู ุงุฑุณุงู ุฏุงุฏู ุจู thread:**
- **ุจุง ููุฏุงุฑ (by value):** ุงููโุชุฑุ ุงูุง ฺฉูุฏุชุฑ (ฺูู ูุงุฒ ุจู ฺฉูพ ุฏุงุฑุฏ).
- **ุจุง ูุฑุฌุน (by reference):** ุณุฑุนโุชุฑุ ุงูุง ูุงุฒููุฏ ููุงููฺฏ ุจุฑุง ุฌููฺฏุฑ ุงุฒ ุดุฑุงุท ุฑูุงุจุช.

โ **ูุญูู ุงุฑุณุงู ุชุงุจุน ุจู thread:**
- **ุชุงุจุน ุนุงุฏ (`f`)** ูุณุชููุงู ุงุฑุณุงู ูโุดูุฏ.
- **ุดุก ุชุงุจุน (`F`)** ุงุฒ `operator()` ุจุฑุง ุงุฌุฑุง ุงุณุชูุงุฏู ูโฺฉูุฏ.

โ **ูุฏู ฺฉู:** ุงุฌุฑุง ููุงุฒ ฺฉุฏ ู ูพุฑุฏุงุฒุด ููโุฒูุงู ุฏุงุฏูโูุง ุจุฑุง ุจูุจูุฏ ฺฉุงุฑุง.

---
**ูุชุฌู:**  
ุงู ูุซุงู ูุดุงู ูโุฏูุฏ ฺฉู ฺุทูุฑ ูโุชูุงู ุงุฒ **ุฑุดุชูโูุง (`threads`)** ุจุฑุง ุงุฌุฑุง ููโุฒูุงู ุชูุงุจุน ุง ุงุดุงุก ุชุงุจุน ุฏุฑ C++ ุงุณุชูุงุฏู ฺฉุฑุฏ ู ุชูุงูุช ุจู ุงุฑุณุงู ุฏุงุฏู ุจุง ููุฏุงุฑ ู ุจุง ูุฑุฌุน ุฑุง ุจุฑุฑุณ ฺฉุฑุฏ. ๐

---

## Returning Results
ุฏุฑ ูุซุงู ุงุฑุงุฆูโุดุฏู ุฏุฑ **ยง5.3.2**ุ ุขุฑฺฏููุงูโูุง ุฑุง ุจุง **ูุฑุฌุน ุบุฑ `const`** ุงุฑุณุงู ูโฺฉูู. ูู ููุท ุฒูุงู ุงู ฺฉุงุฑ ุฑุง ุงูุฌุงู ูโุฏูู ฺฉู ุงูุชุธุงุฑ ุฏุงุดุชู ุจุงุดู **ูุธูู (task) ููุฏุงุฑ ุฏุงุฏูโุง ฺฉู ุจู ุขู ุงุฑุฌุงุน ุฏุงุฏู ุดุฏู ุฑุง ุชุบุฑ ุฏูุฏ** (ยง7.7). ุงู ฺฉ ุฑูุด **ฺฉู ุฒุฑฺฉุงููุ ุงูุง ุฑุงุฌ** ุจุฑุง ุจุงุฒฺฏุฑุฏุงูุฏู ูุชุฌู ุงุณุช.

ฺฉ ุชฺฉูฺฉ **ฺฉูุชุฑ ูุจูู** ุงู ุงุณุช ฺฉู **ุฏุงุฏูโูุง ูุฑูุฏ ุฑุง ุจุง ูุฑุฌุน `const` ุงุฑุณุงู ฺฉูู** ู **ูุญู ุฐุฎุฑู ูุชุฌู ุฑุง ุจูโุนููุงู ฺฉ ุขุฑฺฏููุงู ุฌุฏุงฺฏุงูู ุงุฑุณุงู ฺฉูู**:

```cpp
void f(const vector<double>& v, double* res); // ุฏุฑุงูุช ูุฑูุฏ ุงุฒ v ู ุฐุฎุฑู ูุชุฌู ุฏุฑ *res

class F {
public:
    F(const vector<double>& vv, double* p) : v{vv}, res{p} { }
    void operator()(); // ุฐุฎุฑู ูุชุฌู ุฏุฑ *res

private:
    const vector<double>& v; // ููุจุน ูุฑูุฏ
    double* res; // ููุตุฏ ุฎุฑูุฌ
};

int main()
{
    vector<double> some_vec;
    vector<double> vec2;
    // ...
    double res1;
    double res2;

    thread t1 {f, some_vec, &res1}; // ุงุฌุฑุง f(some_vec, &res1) ุฏุฑ ฺฉ ุฑุดุชู (thread) ุฌุฏุงฺฏุงูู
    thread t2 {F{vec2, &res2}}; // ุงุฌุฑุง F{vec2, &res2}() ุฏุฑ ฺฉ ุฑุดุชู ุฌุฏุงฺฏุงูู

    t1.join();
    t2.join();

    cout << res1 << ' ' << res2 << '\n';
}
```

ูู ุงุฑุณุงู ูุชุฌู **ุงุฒ ุทุฑู ุขุฑฺฏููุงูโูุง** ุฑุง **ุฑูุด ฺูุฏุงู ุธุฑู ููโุฏุงูู**ุ ุจูุงุจุฑุงู ุฏุฑ **ยง5.3.5.1** ุฏูุจุงุฑู ุจู ุงู ููุถูุน ุจุงุฒุฎูุงูู ฺฏุดุช.
