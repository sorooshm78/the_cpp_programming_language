## Introduction
ุงุฒ ุฏุฏฺฏุงู ฺฉ ฺฉุงุฑุจุฑ ููุงุ ฺฉุชุงุจุฎุงูู ุงุณุชุงูุฏุงุฑุฏ ุงุฏูโุขู ุจุงุฏ ุงุฌุฒุง ุฑุง ุงุฑุงุฆู ุฏูุฏ ฺฉู ุจูโุทูุฑ ูุณุชูู ุชูุฑุจุงู ูุฑ ูุงุฒ ุฑุง ูพุดุชุจุงู ฺฉููุฏ. ุจุฑุง ฺฉ ุญูุฒู ฺฉุงุฑุจุฑุฏ ุฎุงุตุ ฺฉ ฺฉุชุงุจุฎุงูู ุชุฌุงุฑ ุจุฒุฑฺฏ ูโุชูุงูุฏ ุจู ุงู ุงุฏูโุขู ูุฒุฏฺฉ ุดูุฏ. ุจุง ุงู ุญุงูุ ุงู ฺุฒ ูุณุช ฺฉู ฺฉุชุงุจุฎุงูู ุงุณุชุงูุฏุงุฑุฏ C++ ุฏุฑ ุชูุงุด ุจุฑุง ุงูุฌุงู ุขู ุงุณุช. ฺฉ ฺฉุชุงุจุฎุงูู ูุงุจู ูุฏุฑุช ู ุฏุฑ ุฏุณุชุฑุณ ุจุฑุง ููฺฏุงู ููโุชูุงูุฏ ููู ฺุฒ ุจุฑุง ููู ุงูุฑุงุฏ ุจุงุดุฏ. ุฏุฑ ุนูุถุ ฺฉุชุงุจุฎุงูู ุงุณุชุงูุฏุงุฑุฏ C++ ุชูุงุด ูโฺฉูุฏ ุงุฌุฒุง ุฑุง ุงุฑุงุฆู ุฏูุฏ ฺฉู ุจุฑุง ุงฺฉุซุฑ ุงูุฑุงุฏ ุฏุฑ ุงฺฉุซุฑ ุญูุฒูโูุง ฺฉุงุฑุจุฑุฏ ููุฏ ุจุงุดูุฏ. ุจู ุนุจุงุฑุช ุฏฺฏุฑุ ูุฏู ุงู ฺฉุชุงุจุฎุงูู ุฎุฏูุช ุจู ุชูุงุทุน ููู ูุงุฒูุง ุงุณุชุ ูู ุงุชุญุงุฏ ุขูโูุง. ุนูุงูู ุจุฑ ุงูุ ูพุดุชุจุงู ุงุฒ ฺูุฏ ุญูุฒู ฺฉุงุฑุจุฑุฏ ุจุณุงุฑ ูููุ ูุงููุฏ ูุญุงุณุจุงุช ุฑุงุถ ู ูพุฑุฏุงุฒุด ูุชูุ ุจู ูุฑูุฑ ูุงุฑุฏ ุงู ฺฉุชุงุจุฎุงูู ุดุฏู ุงุณุช.

## Resource Management
ฺฉ ุงุฒ ูุธุงู ฺฉูุฏ ูุฑ ุจุฑูุงูู ุบุฑุณุงุฏู ูุฏุฑุช ููุงุจุน ุงุณุช. ููุจุน ฺุฒ ุงุณุช ฺฉู ุจุงุฏ ุฏุฑุงูุช ุดุฏู ู ุจุนุฏุงู (ุจู ุตูุฑุช ุตุฑุญ ุง ุถูู) ุขุฒุงุฏ ุดูุฏ. ูุซุงูโูุง ุงุฒ ููุงุจุน ุดุงูู ุญุงูุธูุ ูููโูุงุ ุณูฺฉุชโูุงุ ุฏุณุชฺฏุฑูโูุง ูุฎ (thread handles) ู ุฏุณุชฺฏุฑูโูุง ูุงู ูุณุชูุฏ. ุฏุฑ ฺฉ ุจุฑูุงูู ุจููุฏูุฏุชุ ุขุฒุงุฏ ูฺฉุฑุฏู ฺฉ ููุจุน ุจูโูููุน (ยซูุดุชยป) ูโุชูุงูุฏ ุจุงุนุซ ฺฉุงูุด ุดุฏุฏ ฺฉุงุฑุง ู ุญุช ููุฌุฑ ุจู ฺฉ ุฎุฑุงุจ ูุงฺฏูุงุฑ ุดูุฏ. ุญุช ุฏุฑ ุจุฑูุงููโูุง ฺฉูุชุงูโูุฏุชุ ูุดุช ููุงุจุน ูโุชูุงูุฏ ูุดฺฉูโุณุงุฒ ุดูุฏุ ูุซูุงู ุจุง ุงุฌุงุฏ ฺฉูุจูุฏ ููุงุจุนุ ุฒูุงู ุงุฌุฑุง ุจุฑูุงูู ุจู ุทุฑุฒ ฺุดูฺฏุฑ ุงูุฒุงุด ุงุจุฏ.

ุงุฌุฒุง ฺฉุชุงุจุฎุงูู ุงุณุชุงูุฏุงุฑุฏ ุจู ฺฏูููโุง ุทุฑุงุญ ุดุฏูโุงูุฏ ฺฉู ููุงุจุน ุฑุง ูุดุช ูุฏููุฏ. ุจุฑุง ุฏุณุชุงุจ ุจู ุงู ูุฏูุ ุขูโูุง ุจู ูพุดุชุจุงู ูพุงูโุง ุฒุจุงู ุจุฑุง ูุฏุฑุช ููุงุจุน ุจุง ุงุณุชูุงุฏู ุงุฒ ุฌูุชโูุง ุณุงุฒูุฏู/ูุฑุงูฺฏุฑ (constructor/destructor) ุชฺฉู ูโฺฉููุฏ ุชุง ุงุทููุงู ุญุงุตู ุดูุฏ ฺฉู ฺฉ ููุจุน ุทูู ุนูุฑ ุจุดุชุฑ ูุณุจุช ุจู ุดุก ูุณุฆูู ุขู ูุฏุงุดุชู ุจุงุดุฏ. ุงุณุชูุงุฏู ุงุฒ ุฌูุช ุณุงุฒูุฏู/ูุฑุงูฺฏุฑ ุฏุฑ ฺฉูุงุณ **Vector** ุจุฑุง ูุฏุฑุช ุทูู ุนูุฑ ุนูุงุตุฑุด ฺฉ ููููู ุงุณุช (ุจุฎุด ยง3.2.1.2) ู ุชูุงู ฺฉุงูุชูุฑูุง ฺฉุชุงุจุฎุงูู ุงุณุชุงูุฏุงุฑุฏ ุจู ุฑูุดโูุง ูุดุงุจู ูพุงุฏูโุณุงุฒ ุดุฏูโุงูุฏ. ูููโุชุฑ ุงุฒ ูููุ ุงู ุฑูุด ุจู ุฏุฑุณุช ุจุง ูุฏุฑุช ุฎุทุง ุงุฒ ุทุฑู ุงุณุชุซูุงูุง ุชุนุงูู ุฏุงุฑุฏ. ุจูโุนููุงู ูุซุงูุ ุงู ุชฺฉูฺฉ ุฏุฑ ฺฉูุงุณโูุง ููู ฺฉุชุงุจุฎุงูู ุงุณุชุงูุฏุงุฑุฏ ุงุณุชูุงุฏู ูโุดูุฏ:

```cpp
mutex m; // ุจุฑุง ูุญุงูุธุช ุงุฒ ุฏุณุชุฑุณ ุจู ุฏุงุฏูโูุง ูุดุชุฑฺฉ
// ...
void f()
{
    unique_lock<mutex> lck {m}; // ููู mutex m ุฑุง ุฏุฑุงูุช ฺฉู
    // ... ุฏุณุชฺฉุงุฑ ุฏุงุฏูโูุง ูุดุชุฑฺฉ ...
}
```

ฺฉ ูุฎ (thread) ุชุง ุฒูุงู ฺฉู ุณุงุฒูุฏู **lck** ููู **m** ุฑุง ุฏุฑุงูุช ูฺฉูุฏุ ูพุด ูุฎูุงูุฏ ุฑูุช (ุจุฎุด ยง5.3.4). ูุฑุงูฺฏุฑ ูุชูุงุธุฑ ุงู ููุจุน ุฑุง ุขุฒุงุฏ ูโฺฉูุฏ. ุจูุงุจุฑุงูุ ุฏุฑ ุงู ูุซุงูุ ูุฑุงูฺฏุฑ **unique_lock** ููู **mutex** ุฑุง ุฒูุงู ฺฉู ฺฉูุชุฑู ุงุฒ ุชุงุจุน **f()** ุฎุงุฑุฌ ูโุดูุฏ (ฺู ุงุฒ ุทุฑู ุจุงุฒฺฏุดุชุ ฺู ุจูโุตูุฑุช ุทุจุน ุจุง ุฑุณุฏู ุจู ุงูุชูุง ุชุงุจุนุ ุง ุงุฒ ุทุฑู ูพุฑุชุงุจ ุงุณุชุซูุง) ุขุฒุงุฏ ูโฺฉูุฏ.

ุงู ฺฉ ฺฉุงุฑุจุฑุฏ ุงุฒ ุชฺฉูฺฉ ยซุฏุฑุงูุช ููุจุน ุจู ูุนูุง ููุฏุงุฑุฏู ุงููู ุงุณุชยป (RAIIุ ุจุฎุดโูุง ยง3.2.1.2 ู ยง13.3) ุงุณุช. ุงู ุชฺฉูฺฉ ูพุงูโุง ุจุฑุง ูุฏุฑุช ุงุฏุฆุงู ููุงุจุน ุฏุฑ ุฒุจุงู C++ ูุญุณูุจ ูโุดูุฏ. ฺฉุงูุชูุฑูุง (ูุงููุฏ **vector** ู **map**)ุ ุฑุดุชู (**string**)ุ ู ุฌุฑุงูโูุง ูุฑูุฏ/ุฎุฑูุฌ (**iostream**) ููุงุจุน ุฎูุฏ (ูุงููุฏ ุฏุณุชฺฏุฑูโูุง ูุงู ู ุจุงูุฑูุง) ุฑุง ุจู ููู ุดูู ูุฏุฑุช ูโฺฉููุฏ.

## unique_ptr and shared_ptr
ูุซุงูโูุง ฺฉู ุชุง ฺฉููู ุจุฑุฑุณ ุดุฏูุฏุ ูุฏุฑุช ุงุดุงุก ุชุนุฑูโุดุฏู ุฏุฑ ฺฉ ุฏุงููู (scope) ู ุขุฒุงุฏุณุงุฒ ููุงุจุน ุขูโูุง ููฺฏุงู ุฎุฑูุฌ ุงุฒ ุฏุงููู ุฑุง ูพูุดุด ูโุฏููุฏุ ุงูุง ุฏุฑ ููุฑุฏ ุงุดุง ฺฉู ุฏุฑ ุญุงูุธู ุขุฒุงุฏ (free store) ุชุฎุตุต ุฏุงุฏู ูโุดููุฏ ฺู ุจุงุฏ ฺฉุฑุฏุ ุฏุฑ ฺฉุชุงุจุฎุงูู ุงุณุชุงูุฏุงุฑุฏ ู ุฏุฑ ูุฏุฑ **<memory>**ุ ุฏู ยซุงุดุงุฑูโฺฏุฑ ููุดููุฏยป ุจุฑุง ฺฉูฺฉ ุจู ูุฏุฑุช ุงุดุงุก ุฏุฑ ุญุงูุธู ุขุฒุงุฏ ุงุฑุงุฆู ุดุฏู ุงุณุช:  
1. **unique_ptr** ุจุฑุง ููุงุด ูุงูฺฉุช ฺฉุชุง (ยง34.3.1)  
2. **shared_ptr** ุจุฑุง ููุงุด ูุงูฺฉุช ุงุดุชุฑุงฺฉ (ยง34.3.2)  

ุงุณุชูุงุฏู ุงุณุงุณ ุงุฒ ุงู ยซุงุดุงุฑูโฺฏุฑูุง ููุดููุฏยป ุฌููฺฏุฑ ุงุฒ ูุดุช ุญุงูุธู ูุงุด ุงุฒ ุจุฑูุงููโููุณ ุจโุฏูุช ุงุณุช. ุจู ุนููุงู ูุซุงู:

```cpp
void f(int i, int j) // X* ุฏุฑ ููุงุจู unique_ptr<X>
{
    X* p = new X; // ุชุฎุตุต ฺฉ X ุฌุฏุฏ
    unique_ptr<X> sp {new X}; // ุชุฎุตุต ฺฉ X ุฌุฏุฏ ู ูุงฺฏุฐุงุฑ ุงุดุงุฑูโฺฏุฑ ุขู ุจู unique_ptr
    // ...
    if (i<99) throw Z{}; // ููฺฉู ุงุณุช ฺฉ ุงุณุชุซูุง ูพุฑุชุงุจ ุดูุฏ
    if (j<77) return; // ููฺฉู ุงุณุช ุฒูุฏุชุฑ ุงุฒ ุชุงุจุน ุจุงุฒฺฏุฑุฏู
    p->do_something(); // ููฺฉู ุงุณุช ฺฉ ุงุณุชุซูุง ูพุฑุชุงุจ ุดูุฏ
    sp->do_something(); // ููฺฉู ุงุณุช ฺฉ ุงุณุชุซูุง ูพุฑุชุงุจ ุดูุฏ
    // ...
    delete p; // ูุงุจูุฏ ฺฉุฑุฏู *p
}
```

ุฏุฑ ุงูุฌุงุ ุงฺฏุฑ **i < 99** ุง **j < 77** ุจุงุดุฏุ ูุฑุงููุด ฺฉุฑุฏู ฺฉู **p** ุฑุง ุขุฒุงุฏ ฺฉูู. ุงุฒ ุณู ุฏฺฏุฑุ **unique_ptr** ุชุถูู ูโฺฉูุฏ ฺฉู ุดุก ูุฑุชุจุท ุจู ุฏุฑุณุช ูุงุจูุฏ ูโุดูุฏุ ุตุฑูโูุธุฑ ุงุฒ ุงู ฺฉู ฺฺฏููู ุงุฒ ุชุงุจุน **f()** ุฎุงุฑุฌ ูโุดูู (ฺู ุงุฒ ุทุฑู ูพุฑุชุงุจ ุงุณุชุซูุงุ ุจุงุฒฺฏุดุช ุง ุฑุณุฏู ุจู ุงูุชูุง ุชุงุจุน). ุฌุงูุจ ุงูุฌุงุณุช ฺฉู ูโุชูุงูุณุชู ุงู ูุดฺฉู ุฑุง ุจู ุณุงุฏฺฏ ุจุง ุนุฏู ุงุณุชูุงุฏู ุงุฒ ุงุดุงุฑูโฺฏุฑ ู **new** ุญู ฺฉูู:

```cpp
void f(int i, int j) // ุงุณุชูุงุฏู ุงุฒ ฺฉ ูุชุบุฑ ูุญู
{
    X x;
    // ...
}
```

ูุชุฃุณูุงููุ ุงุณุชูุงุฏู ุจุด ุงุฒ ุญุฏ ุงุฒ **new** (ู ููฺูู ุงุดุงุฑูโฺฏุฑูุง ู ูุฑุงุฌุน) ุจู ูุธุฑ ูโุฑุณุฏ ฺฉู ฺฉ ูุดฺฉู ุฑู ุจู ุฑุดุฏ ุงุณุช. ุจุง ุงู ุญุงูุ ุฒูุงู ฺฉู ูุงูุนุงู ุจู ูุนูุง ุงุดุงุฑูโฺฏุฑูุง ูุงุฒ ุฏุงุฑุฏุ **unique_ptr** ูฺฉุงูุฒู ุจุณุงุฑ ุณุจฺฉ ุจุง ูฺ ูุฒูู ุงุถุงู (ุงุฒ ูุธุฑ ูุถุง ุง ุฒูุงู) ุฏุฑ ููุงุณู ุจุง ุงุณุชูุงุฏู ุตุญุญ ุงุฒ ฺฉ ุงุดุงุฑูโฺฏุฑ ุฏุงุฎู ุงุณุช. ุงุณุชูุงุฏูโูุง ุจุดุชุฑ ุขู ุดุงูู ุงูุชูุงู ุงุดุงุก ุชุฎุตุตโุฏุงุฏูโุดุฏู ุฏุฑ ุญุงูุธู ุขุฒุงุฏ ุจู ุฏุงุฎู ู ุฎุงุฑุฌ ุงุฒ ุชูุงุจุน ุงุณุช:

```cpp
unique_ptr<X> make_X(int i) // ุณุงุฎุช ฺฉ X ู ุงูุชูุงู ููุฑ ุขู ุจู unique_ptr
{
    // ... ุจุฑุฑุณ i ู ุบุฑู ...
    return unique_ptr<X>{new X{i}};
}
```

ฺฉ **unique_ptr** ูุงููุฏ ฺฉ ุฏุณุชู ุจุฑุง ฺฉ ุดุก (ุง ุขุฑุงู) ุนูู ูโฺฉูุฏุ ููุงูโุทูุฑ ฺฉู **vector** ฺฉ ุฏุณุชู ุจุฑุง ุฏูุจุงููโุง ุงุฒ ุงุดุงุก ุงุณุช. ูุฑ ุฏู ุทูู ุนูุฑ ุงุดุงุก ุฏฺฏุฑ ุฑุง ฺฉูุชุฑู ูโฺฉููุฏ (ุจุง ุงุณุชูุงุฏู ุงุฒ RAII) ู ูุฑ ุฏู ุจุฑุง ุณุงุฏู ู ฺฉุงุฑุขูุฏ ฺฉุฑุฏู ุจุงุฒฺฏุดุชุ ุจู ููุงูู ุญุฑฺฉุช (move semantics) ูุชฺฉ ูุณุชูุฏ.

**shared_ptr** ูุดุงุจู **unique_ptr** ุงุณุชุ ุจุง ุงู ุชูุงูุช ฺฉู **shared_ptr** ุจู ุฌุง ุงูุชูุงูุ ฺฉูพ ูโุดูุฏ. **shared_ptr**โูุง ูุงูฺฉุช ฺฉ ุดุก ุฑุง ุจู ุงุดุชุฑุงฺฉ ูโฺฏุฐุงุฑูุฏ ู ุขู ุดุก ุฒูุงู ูุงุจูุฏ ูโุดูุฏ ฺฉู ุขุฎุฑู **shared_ptr** ูุฑุชุจุท ูุงุจูุฏ ุดูุฏ. ุจุฑุง ูุซุงู:

```cpp
void f(shared_ptr<fstream>);
void g(shared_ptr<fstream>);
void user(const string& name, ios_base::openmode mode)
{
    shared_ptr<fstream> fp {new fstream(name, mode)};
    if (!*fp) throw No_file{}; // ุงุทููุงู ุงุฒ ุจุงุฒ ุดุฏู ุตุญุญ ูุงู
    f(fp);
    g(fp);
    // ...
}
```

ุฏุฑ ุงูุฌุงุ ูุงู ฺฉู ุชูุณุท ุณุงุฒูุฏู **fp** ุจุงุฒ ุดุฏู ุงุณุชุ ุชูุณุท ุขุฎุฑู ุชุงุจุน ฺฉู ูุณุฎูโุง ุงุฒ **fp** ุฑุง (ุจู ุตูุฑุช ุตุฑุญ ุง ุถูู) ูุงุจูุฏ ูโฺฉูุฏุ ุจุณุชู ุฎูุงูุฏ ุดุฏ. ุชูุฌู ฺฉูุฏ ฺฉู **f()** ุง **g()** ููฺฉู ุงุณุช ฺฉ ุชุณฺฉ ุงุฌุงุฏ ฺฉููุฏ ฺฉู ูุณุฎูโุง ุงุฒ **fp** ุฑุง ูฺฏู ุฏุงุฑุฏ ุง ุจู ูุญู ุฏฺฏุฑ ฺฉูพโุง ุฑุง ุฐุฎุฑู ฺฉูุฏ ฺฉู ุทูู ุนูุฑ ุจุดุชุฑ ูุณุจุช ุจู **user()** ุฏุงุดุชู ุจุงุดุฏ. ุจูุงุจุฑุงูุ **shared_ptr** ููุน ุงุฒ ุฌูุนโุขูุฑ ุฒุจุงูู (garbage collection) ุงุฑุงุฆู ูโุฏูุฏ ฺฉู ุจู ูุฏุฑุช ููุงุจุน ูุจุชู ุจุฑ ูุฑุงูฺฏุฑ ุงุญุชุฑุงู ูโฺฏุฐุงุฑุฏ. ุงู ุฑูุด ูู ุฑุงฺฏุงู ุงุณุช ู ูู ุจุด ุงุฒ ุญุฏ ฺฏุฑุงูุ ุงูุง ุทูู ุนูุฑ ุดุก ูุดุชุฑฺฉ ุฑุง ูพุดโุจูโูุงูพุฐุฑ ูโฺฉูุฏ. ุงุฒ **shared_ptr** ููุท ุฒูุงู ุงุณุชูุงุฏู ฺฉูุฏ ฺฉู ูุงูุนุงู ุจู ูุงูฺฉุช ูุดุชุฑฺฉ ูุงุฒ ุฏุงุฑุฏ.

ุจุง ุฏุงุดุชู **unique_ptr** ู **shared_ptr**ุ ูโุชูุงูู ฺฉ ุณุงุณุช ฺฉุงูู ยซุนุฏู ุงุณุชูุงุฏู ุงุฒ **new** ูุณุชููยป (ยง3.2.1.2) ุฑุง ุจุฑุง ุจุณุงุฑ ุงุฒ ุจุฑูุงููโูุง ุงุนูุงู ฺฉูู. ุจุง ุงู ุญุงูุ ุงู ยซุงุดุงุฑูโฺฏุฑูุง ููุดููุฏยป ูููุฒ ูู ุจู ุตูุฑุช ููููู ุงุดุงุฑูโฺฏุฑ ูุณุชูุฏ ู ุจูุงุจุฑุงู ุชููุง ฺฏุฒูู ุฏูู ูู ุจุฑุง ูุฏุฑุช ููุงุจุน ุจู ุดูุงุฑ ูโุฑููุฏ โ ูพุณ ุงุฒ ฺฉุงูุชูุฑูุง ู ุงููุงุน ุฏฺฏุฑ ฺฉู ููุงุจุน ุฑุง ุฏุฑ ฺฉ ุณุทุญ ููููู ุจุงูุงุชุฑ ูุฏุฑุช ูโฺฉููุฏ. ุจู ุทูุฑ ุฎุงุตุ **shared_ptr** ุจู ุชููุง ูฺ ูุงููู ุจุฑุง ุชุนู ุงูฺฉู ฺฉุฏุงู ูุงูฺฉู ูโุชูุงููุฏ ุดุก ูุดุชุฑฺฉ ุฑุง ุจุฎูุงููุฏ ู/ุง ุจููุณูุฏ ุงุฑุงุฆู ููโุฏูุฏ. ุฑูุงุจุช ุฏุงุฏูโูุง (ยง41.2.4) ู ุฏฺฏุฑ ุงุดฺฉุงู ุณุฑุฏุฑฺฏู ููุท ุจุง ุญุฐู ูุดฺฉูุงุช ูุฏุฑุช ููุงุจุน ุญู ููโุดููุฏ.

ฺฉุฌุง ุจุงุฏ ุงุฒ ยซุงุดุงุฑูโฺฏุฑูุง ููุดููุฏยป (ูุงููุฏ **unique_ptr**) ุจู ุฌุง ุฏุณุชูโูุง ููุงุจุน ุจุง ุนููุงุช ุทุฑุงุญโุดุฏู ูุฎุตูุต ุจุฑุง ููุจุน (ูุงููุฏ **vector** ุง **thread**) ุงุณุชูุงุฏู ฺฉููุ ุฌุง ุชุนุฌุจ ูุณุช ฺฉู ูพุงุณุฎ ุงู ุงุณุช: ยซููุช ุจู ูุนูุง ุงุดุงุฑูโฺฏุฑ ูุงุฒ ุฏุงุฑู.ยป  
- ููุช ุดุก ุฑุง ุจู ุงุดุชุฑุงฺฉ ูโฺฏุฐุงุฑูุ ุจุฑุง ุงุดุงุฑู ุจู ุขู ุจู ุงุดุงุฑูโฺฏุฑ (ุง ูุฑุฌุน) ูุงุฒ ุฏุงุฑูุ ุจูุงุจุฑุงู **shared_ptr** ุงูุชุฎุงุจ ูุงุถุญ ุงุณุช (ูฺฏุฑ ุงูฺฉู ฺฉ ูุงูฺฉ ูุงุถุญ ูุฌูุฏ ุฏุงุดุชู ุจุงุดุฏ).  
- ููุช ุจู ฺฉ ุดุก ฺูุฏุดฺฉู (polymorphic) ุงุดุงุฑู ูโฺฉููุ ูุงุฒ ุจู ฺฉ ุงุดุงุฑูโฺฏุฑ (ุง ูุฑุฌุน) ุฏุงุฑูุ ุฒุฑุง ููุน ุฏูู ุดุก ููุฑุฏ ุงุดุงุฑู ุง ุญุช ุงูุฏุงุฒู ุขู ุฑุง ููโุฏุงูู. ุจูุงุจุฑุงู **unique_ptr** ุงูุชุฎุงุจ ูุงุถุญ ุงุณุช.  
- ฺฉ ุดุก ฺูุฏุดฺฉู ูุดุชุฑฺฉ ูุนูููุงู ุจู **shared_ptr** ูุงุฒ ุฏุงุฑุฏ.  

ูุง ูุงุฒ ุจู ุงุณุชูุงุฏู ุงุฒ ุงุดุงุฑูโฺฏุฑ ุจุฑุง ุจุงุฒฺฏุฑุฏุงูุฏู ฺฉ ูุฌููุนู ุงุฒ ุงุดุงุก ุงุฒ ฺฉ ุชุงุจุน ูุฏุงุฑูุ ฺฉ ฺฉุงูุชูุฑ ฺฉู ุฏุณุชูโุง ุจุฑุง ููุงุจุน ุงุณุช ุงู ฺฉุงุฑ ุฑุง ุจู ุณุงุฏฺฏ ู ุจู ุทูุฑ ฺฉุงุฑุขูุฏ ุงูุฌุงู ูโุฏูุฏ (ยง3.3.2).

## Concurrency
ููโุฑููุฏ (Concurrency) โ ุงุฌุฑุง ููุฒูุงู ฺูุฏู ูุธูู โ ุจู ุทูุฑ ฺฏุณุชุฑุฏู ุจุฑุง **ุงูุฒุงุด ุชูุงู ุนููุงุช** (ุจุง ุงุณุชูุงุฏู ุงุฒ ฺูุฏู ูพุฑุฏุงุฒูุฏู ุจุฑุง ฺฉ ูุญุงุณุจู) ุง **ุจูุจูุฏ ูพุงุณุฎโุฏู** (ุจุง ุงุฌุงุฒู ุฏุงุฏู ุจู ฺฉ ุจุฎุด ุงุฒ ุจุฑูุงูู ุจุฑุง ูพุดุฑูุช ุฏุฑ ุญุงู ฺฉู ุจุฎุด ุฏฺฏุฑ ููุชุธุฑ ูพุงุณุฎ ุงุณุช) ุงุณุชูุงุฏู ูโุดูุฏ. ุชูุงู ุฒุจุงูโูุง ุจุฑูุงููโููุณ ูุฏุฑู ุงุฒ ุงู ูุงุจูุช ูพุดุชุจุงู ูโฺฉููุฏ. ูพุดุชุจุงู ุงุฑุงุฆู ุดุฏู ุชูุณุท ฺฉุชุงุจุฎุงูู ุงุณุชุงูุฏุงุฑุฏ ++Cุ ฺฉ ูุณุฎู ูุงุจู ุญูู (portable) ู ููุน-ุงูู (type-safe) ุงุฒ ฺุฒ ุงุณุช ฺฉู ุจุฑุง ุจุด ุงุฒ 20 ุณุงู ุฏุฑ ++C ุงุณุชูุงุฏู ุดุฏู ู ุชูุฑุจุงู ุชูุณุท ุชูุงู ุณุฎุชโุงูุฒุงุฑูุง ูุฏุฑู ูพุดุชุจุงู ูโุดูุฏ. 

ูพุดุชุจุงู ฺฉุชุงุจุฎุงูู ุงุณุชุงูุฏุงุฑุฏุ ุนูุฏุชุงู ุจุง ูุฏู ูพุดุชุจุงู ุงุฒ ููโุฑููุฏ ุฏุฑ ุณุทุญ ุณุณุชู ุงุฑุงุฆู ุดุฏู ุงุณุชุ ูู ุจุฑุง ุงุฑุงุฆู ูุณุชูู ูุฏูโูุง ูพุดุฑูุชูโุชุฑ ููโุฑููุฏุ ฺูู ูุฏูโูุง ูพุดุฑูุชูโุง ูโุชูุงููุฏ ุจู ุตูุฑุช ฺฉุชุงุจุฎุงููโูุง ุณุงุฎุชู ุดููุฏ ฺฉู ุงุฒ ุงูฺฉุงูุงุช ฺฉุชุงุจุฎุงูู ุงุณุชุงูุฏุงุฑุฏ ุงุณุชูุงุฏู ูโฺฉููุฏ.

ฺฉุชุงุจุฎุงูู ุงุณุชุงูุฏุงุฑุฏ ุจู ุทูุฑ ูุณุชูู ุงุฒ ุงุฌุฑุง ููโุฒูุงู ฺูุฏู ูุฎ (threads) ุฏุฑ ฺฉ ูุถุง ุขุฏุฑุณ ูพุดุชุจุงู ูโฺฉูุฏ. ุจุฑุง ุงู ููุธูุฑุ ++C ฺฉ **ูุฏู ุญุงูุธู ููุงุณุจ** (ยง41.2) ู ูุฌููุนูโุง ุงุฒ **ุนููุงุช ุงุชู** (ยง41.3) ูุฑุงูู ูโฺฉูุฏ. ุจุง ุงู ุญุงูุ ุงฺฉุซุฑ ฺฉุงุฑุจุฑุงู ููโุฑููุฏ ุฑุง ุชููุง ุงุฒ ุทุฑู ฺฉุชุงุจุฎุงูู ุงุณุชุงูุฏุงุฑุฏ ู ฺฉุชุงุจุฎุงููโูุง ฺฉู ุจุฑ ูพุงู ุขู ุณุงุฎุชู ุดุฏูโุงูุฏ ูุดุงูุฏู ูโฺฉููุฏ. 

ุงู ุจุฎุด ุจู ุทูุฑ ุฎูุงุตู ูุซุงูโูุง ุงุฒ ุงูฺฉุงูุงุช ุงุตู ูพุดุชุจุงู ููโุฑููุฏ ุฏุฑ ฺฉุชุงุจุฎุงูู ุงุณุชุงูุฏุงุฑุฏ ุงุฑุงุฆู ูโุฏูุฏ: **ูุฎโูุง (threads)**ุ **ูููโูุง (mutexes)**ุ **ุนููุงุช lock()**ุ **ูุธุงู ุจุณุชูโุจูุฏโุดุฏู (packaged_tasks)** ู **ุขูุฏูโูุง (futures)**. ุงู ูฺฺฏโูุง ุจู ุทูุฑ ูุณุชูู ุจุฑ ุงุณุงุณ ุงูฺฉุงูุงุช ุงุฑุงุฆูโุดุฏู ุชูุณุท ุณุณุชูโุนุงููโูุง ุณุงุฎุชู ุดุฏูโุงูุฏ ู **ูฺฺฏููู ฺฉุงูุด ฺฉุงุฑุง** ูุณุจุช ุจู ุงูฺฉุงูุงุช ุณุณุชูโุนุงูู ูุฏุงุฑูุฏ.

## Tasks and threads
ูุง ุจู ูุญุงุณุจุงุช ฺฉู ูโุชูุงููุฏ ุจู ุทูุฑ ููุฒูุงู ุจุง ุณุงุฑ ูุญุงุณุจุงุช ุงุฌุฑุง ุดููุฏุ **ูุธูู (task)** ูโฺฏูู. ฺฉ **ูุฎ (thread)** ููุงุด ุฏุฑ ุณุทุญ ุณุณุชู ุงุฒ ฺฉ ูุธูู ุฏุฑ ฺฉ ุจุฑูุงูู ุงุณุช. ุจุฑุง ุงุฌุฑุง ฺฉ ูุธูู ุจู ุตูุฑุช ููุฒูุงู ุจุง ุณุงุฑ ูุธุงูุ ุจุงุฏ ุจุง ุณุงุฎุชู ฺฉ `std::thread` (ุงุฒ ฺฉุชุงุจุฎุงูู `<thread>`) ูุธูู ููุฑุฏูุธุฑ ุฑุง ุจู ุนููุงู ุขุฑฺฏููุงู ุจู ุขู ููุชูู ฺฉูู. ฺฉ ูุธูู ูโุชูุงูุฏ ฺฉ ุชุงุจุน ุง ฺฉ ุดุก ุชุงุจุน (function object) ุจุงุดุฏ:

```cpp
void f(); // ุชุงุจุน
struct F { // ุดุก ุชุงุจุน
    void operator()(); // ุนููฺฏุฑ () ุจุฑุง F
};
```

### ูุซุงู:
ุฏุฑ ุงู ูุซุงูุ ุฏู ูุฎ ุงุฌุงุฏ ูโุดููุฏ ฺฉู ูุฑ ฺฉ ูุธููโุง ุฑุง ุจู ุตูุฑุช ููุฒูุงู ุงุฌุฑุง ูโฺฉููุฏ:

```cpp
void user() {
    thread t1 {f}; // ุงุฌุฑุง f() ุฏุฑ ฺฉ ูุฎ ุฌุฏุงฺฏุงูู
    thread t2 {F()}; // ุงุฌุฑุง F()() ุฏุฑ ฺฉ ูุฎ ุฌุฏุงฺฏุงูู
    t1.join(); // ููุชุธุฑ ูพุงุงู t1
    t2.join(); // ููุชุธุฑ ูพุงุงู t2
}
```

ูุชุฏ `join()` ุชุถูู ูโฺฉูุฏ ฺฉู ุงุฒ ุชุงุจุน `user()` ุฎุงุฑุฌ ูุดูู ุชุง ุฒูุงู ฺฉู ูุฎโูุง ฺฉุงุฑุดุงู ุฑุง ุจู ูพุงุงู ุจุฑุณุงููุฏ. ููููู "join" ุนู "ููุชุธุฑ ูุงูุฏู ุจุฑุง ูพุงุงู ูุฎ".

---

### ุชูุงูุช ูุฎโูุง ุจุง ูุฑุขูุฏูุง:
- ูุฎโูุง ฺฉ ุจุฑูุงูู **ฺฉ ูุถุง ุขุฏุฑุณ ูุดุชุฑฺฉ** ุฏุงุฑูุฏ. 
- ุจุฑุฎูุงู ูุฎโูุงุ ูุฑุขูุฏูุง ูุนูููุงู ุฏุงุฏูโูุง ุฑุง ุจู ุทูุฑ ูุณุชูู ุจุง ฺฉุฏฺฏุฑ ุจู ุงุดุชุฑุงฺฉ ููโฺฏุฐุงุฑูุฏ.
- ุจู ุฏูู ุงุดุชุฑุงฺฉ ูุถุง ุขุฏุฑุณุ ูุฎโูุง ูโุชูุงููุฏ ุงุฒ ุทุฑู **ุงุดุง ูุดุชุฑฺฉ** ุจุง ฺฉุฏฺฏุฑ ุงุฑุชุจุงุท ุจุฑูุฑุงุฑ ฺฉููุฏ. ุงู ุงุฑุชุจุงุท ูุนูููุงู ุชูุณุท **ูููโูุง (locks)** ุง ุณุงุฑ ูฺฉุงูุฒูโูุง ฺฉูุชุฑู ูโุดูุฏ ุชุง ุงุฒ **data race** (ุฏุณุชุฑุณ ููุฒูุงู ู ฺฉูุชุฑูโูุดุฏู ุจู ฺฉ ูุชุบุฑ) ุฌููฺฏุฑ ุดูุฏ.

---

### ูุดฺฉู ุฏุฑ ููโุฒูุงู ู ูุซุงู ุฎุทุง:
ููุดุชู ุจุฑูุงููโูุง ููโุฒูุงู ููฺฉู ุงุณุช ุจุณุงุฑ ุฏุดูุงุฑ ุจุงุดุฏ. ุจู ุนููุงู ูุซุงูุ ูุธุงู ุฒุฑ ุชุนุฑู ุดุฏูโุงูุฏ:

```cpp
void f() { cout << "Hello "; }
struct F {
    void operator()() { cout << "Parallel World!\n"; }
};
```

ุงฺฏุฑ ุฏู ูุฎ ุจู ุทูุฑ ููุฒูุงู ุงู ูุธุงู ุฑุง ุงุฌุฑุง ฺฉููุฏ:

```cpp
thread t1 {f};
thread t2 {F()};
t1.join();
t2.join();
```

ุงู ฺฉุฏ ฺฉ **ุฎุทุง ุจุฏ** ุงุณุช. ูุฑ ุฏู ูุธูู ุงุฒ ุดุก `cout` ุจู ุทูุฑ ููุฒูุงู ุงุณุชูุงุฏู ูโฺฉููุฏุ ุงูุง **ุจุฏูู ูฺโฺฏููู ููโุฒูุงูโุณุงุฒ (synchronization)**. 

ุฎุฑูุฌ ุญุงุตู ูโุชูุงูุฏ ุบุฑูุงุจู ูพุดโุจู ุจุงุดุฏ ู ุฏุฑ ุงุฌุฑุงโูุง ูุฎุชูู ุจุฑูุงูู ูุชูุงูุช ุจุงุดุฏ. ุจุฑุง ูุซุงูุ ููฺฉู ุงุณุช ุฎุฑูุฌ ุฒุฑ ุชููุฏ ุดูุฏ:

```
PaHerallllel o World!
```

---

### ุฑุงูโุญู ู ูฺฉุชู ููู:
ุจุฑุง ุชุนุฑู ูุธุงู ุฏุฑ ฺฉ ุจุฑูุงูู ููโุฒูุงูุ ูุฏู ุงู ุงุณุช ฺฉู:
1. **ูุธุงู ุฑุง ฺฉุงููุงู ุฌุฏุง ุงุฒ ูู ูฺฏู ุฏุงุฑู**ุ ูฺฏุฑ ุฏุฑ ุฌุงูุง ฺฉู ุงุฑุชุจุงุทุงุช ุณุงุฏู ู ูุงุถุญ ุจู ุขูโูุง ูุฌูุฏ ุฏุงุฑุฏ.
2. **ูุธุงู ุฑุง ุจู ุตูุฑุช ุงุฒููู ุชุนุฑู ฺฉูู**: ุนู ุฏุงุฏูโูุง ูุดุชุฑฺฉ ูุจุงุฏ ุจุฏูู ฺฉูุชุฑู ุงุณุชูุงุฏู ุดููุฏ.

ุณุงุฏูโุชุฑู ุฑุงู ุจุฑุง ูฺฉุฑ ฺฉุฑุฏู ุจู ฺฉ ูุธูู ููโุฒูุงูุ ุงู ุงุณุช ฺฉู ุจู ุขู ุจู ฺุดู ฺฉ ุชุงุจุน ูฺฏุงู ฺฉูู ฺฉู ุจู ุทูุฑ ููุฒูุงู ุจุง ูุฑุงุฎูุงููุฏู ุฎูุฏ ุงุฌุฑุง ูโุดูุฏ. ุจุฑุง ุงู ฺฉุงุฑ ุจุงุฏ:
- ุขุฑฺฏููุงูโูุง ุฑุง ููุชูู ฺฉููุ
- ูุชุฌู ุฑุง ุฏุฑุงูุช ฺฉููุ
- ู ุงุทููุงู ุญุงุตู ฺฉูู ฺฉู ุฏุงุฏูโูุง ูุดุชุฑฺฉ ุจู ุตูุฑุช ูุงุงูู ุงุณุชูุงุฏู ููโุดููุฏ (ุนู **data race** ูุฌูุฏ ูุฏุงุดุชู ุจุงุดุฏ).

## Passing Arguments
ูุนูููุงูุ ฺฉ ูุธูู (task) ุจุฑุง ุงุฌุฑุง ูุงุฒ ุจู ุฏุงุฏูโุง ุฏุงุฑุฏ ฺฉู ุฑู ุขู ฺฉุงุฑ ฺฉูุฏ. ูุง ูโุชูุงูู ุฏุงุฏูโูุง (ุง ุงุดุงุฑูโฺฏุฑูุง ู ูุฑุงุฌุน ุจู ุฏุงุฏูโูุง) ุฑุง ุจูโุฑุงุญุช ุจูโุนููุงู ุขุฑฺฏููุงู ุงุฑุณุงู ฺฉูู. ุจูโุนููุงูโูุซุงู:

```cpp
void f(vector<double>& v); // ุชุงุจุน ฺฉู ฺฉุงุฑ ุฑุง ุจุฑ ุฑู v ุงูุฌุงู ูโุฏูุฏ

struct F { // ุดุก ุชุงุจุน ฺฉู ฺฉุงุฑ ุฑุง ุจุฑ ุฑู v ุงูุฌุงู ูโุฏูุฏ
    vector<double>& v;
    F(vector<double>& vv) : v{vv} { }
    void operator()(); // ุนููฺฏุฑ ฺฉุงุฑุจุฑุฏ (application operator)
};

int main()
{
    vector<double> some_vec {1,2,3,4,5,6,7,8,9};
    vector<double> vec2 {10,11,12,13,14};

    thread t1 {f, some_vec}; // ุงุฌุฑุง f(some_vec) ุฏุฑ ฺฉ ุฑุดุชู (thread) ุฌุฏุงฺฏุงูู
    thread t2 {F{vec2}}; // ุงุฌุฑุง F(vec2)() ุฏุฑ ฺฉ ุฑุดุชู ุฌุฏุงฺฏุงูู

    t1.join();
    t2.join();
}
```

ูุงุถุญ ุงุณุช ฺฉู `F{vec2}` ฺฉ **ูุฑุฌุน** ุจู ุจุฑุฏุงุฑ `vec2` ุฑุง ุฏุฑ ฺฉูุงุณ `F` ุฐุฎุฑู ูโฺฉูุฏ. ุงฺฉููู `F` ูโุชูุงูุฏ ุงุฒ ุงู ุจุฑุฏุงุฑ ุงุณุชูุงุฏู ฺฉูุฏุ ุจู ุงู ุงูุฏ ฺฉู ูฺ ูุธููโ ุฏฺฏุฑ ุฏุฑ ุญู ุงุฌุฑุง `F` ุจู `vec2` ุฏุณุชุฑุณ ูุฏุงุดุชู ุจุงุดุฏ. ุงฺฏุฑ `vec2` ุฑุง **ุจุง ููุฏุงุฑ** (by value) ุงุฑุณุงู ฺฉููุ ุงู ุฑุณฺฉ ุงุฒ ุจู ูโุฑูุฏ.

**ููุฏุงุฑุฏู ุงููู ุจุง `{f, some_vec}` ุงุฒ ฺฉ ุณุงุฒูุฏูโ ุชุงุจุน ูุชุบุฑ (variadic template constructor) ุฏุฑ ฺฉูุงุณ `thread` ุงุณุชูุงุฏู ูโฺฉูุฏ ฺฉู ูโุชูุงูุฏ ฺฉ ุชูุงู ุฏูุฎูุงู ุงุฒ ุขุฑฺฏููุงูโูุง ุฑุง ุจูพุฐุฑุฏ.** ฺฉุงููพุงูุฑ ุจุฑุฑุณ ูโฺฉูุฏ ฺฉู ุขุง ุขุฑฺฏููุงู ุงูู ูโุชูุงูุฏ ุจุง ุขุฑฺฏููุงูโูุง ุจุนุฏ ูุฑุงุฎูุงู ุดูุฏ ุง ุฎุฑ ู ุฏุฑ ุตูุฑุช ุงูฺฉุงูุ ุดุก ุชุงุจุน ููุฑุฏูุงุฒ ุฑุง ุจุฑุง ุงุฑุณุงู ุจู `thread` ูโุณุงุฒุฏ.

ุจูุงุจุฑุงูุ ุงฺฏุฑ `F::operator()()` ู `f()` **ุงูฺฏูุฑุชู ฺฉุณุงู ุฑุง ุงุฌุฑุง ฺฉููุฏ**ุ ูุญููโ ูพุฑุฏุงุฒุด ุงู ุฏู ูุธูู ุชูุฑุจุงู ูุนุงุฏู ุฎูุงูุฏ ุจูุฏ: ุฏุฑ ูุฑ ุฏู ููุฑุฏุ ฺฉ ุดุก ุชุงุจุน (function object) ุจุฑุง ุงุฌุฑุง ุฏุฑูู **ุฑุดุชู (thread)** ุณุงุฎุชู ูโุดูุฏ.

---

### **ุชูุถุญ ุจุฑูุงูู ู ููููู ุขู**

ุงู ฺฉุฏ **ููุงุฒโุณุงุฒ (multithreading)** ุฏุฑ C++ ุฑุง ูุดุงู ูโุฏูุฏ. ุฏุฑ ุงูุฌุงุ ุฏู ุฑูุด ุจุฑุง ุงุฌุฑุง ฺฉ ุชุงุจุน ุฏุฑ ฺฉ **ุฑุดุชู (thread) ุฌุฏุงฺฏุงูู** ุงุฑุงุฆู ุดุฏู ุงุณุช:

1. **ุงุฑุณุงู ฺฉ ุชุงุจุน ูุนููู (`f`) ุจู ฺฉ ุฑุดุชู (thread)**
2. **ุงุฑุณุงู ฺฉ ุดุก ุชุงุจุน (`F`) ุจู ฺฉ ุฑุดุชู (thread)**

---

### **ฑ. ุงุฑุณุงู ฺฉ ุชุงุจุน ูุนููู ุจู ฺฉ ุฑุดุชู (`thread t1 {f, some_vec};`)**
ุฏุฑ ุงู ุฎุท:
```cpp
thread t1 {f, some_vec}; 
```
- `t1` ฺฉ **ุฑุดุชู ุฌุฏุฏ** ุงุฌุงุฏ ูโฺฉูุฏ ฺฉู ุฏุฑ ุขู ุชุงุจุน `f` ุงุฌุฑุง ุฎูุงูุฏ ุดุฏ.
- `some_vec` ุจูโุนููุงู ุขุฑฺฏููุงู ุจู ุชุงุจุน `f` ุงุฑุณุงู ูโุดูุฏ.
- `f` ุจุงุฏ ฺฉ ุชุงุจุน ุชุนุฑูโุดุฏู ุจุงุดุฏ ฺฉู ูุฑูุฏ ุขู ฺฉ ูุฑุฌุน ุจู `vector<double>` ุงุณุช:

    ```cpp
    void f(vector<double>& v);
    ```

- ููุฏุงุฑุฏู `{f, some_vec}` ุงุฒ **ฺฉ ุณุงุฒูุฏู ุชุงุจุน ูุชุบุฑ (variadic template constructor)** ุฏุฑ ฺฉูุงุณ `thread` ุงุณุชูุงุฏู ูโฺฉูุฏ. 
- ฺฉุงููพุงูุฑ ุจุฑุฑุณ ูโฺฉูุฏ ฺฉู ุขุง `f` ุฑุง ูโุชูุงู ุจุง `some_vec` ูุฑุงุฎูุงู ฺฉุฑุฏุ ุณูพุณ ุดุก ุชุงุจุน ููุฑุฏูุงุฒ ุฑุง ุจุฑุง ุงุฌุฑุง ุฏุฑูู `thread` ูโุณุงุฒุฏ.

---

### **ฒ. ุงุฑุณุงู ฺฉ ุดุก ุชุงุจุน (`F`) ุจู ฺฉ ุฑุดุชู (`thread t2 {F{vec2}};`)**
ุฏุฑ ุงู ูุณูุช:
```cpp
thread t2 {F{vec2}}; 
```
- `F` ฺฉ **ุณุงุฎุชุงุฑ (struct)** ุงุณุช ฺฉู ุดุงูู ฺฉ **ูุฑุฌุน (`vector<double>& v`)** ุจู `vec2` ูโุจุงุดุฏ.
- `F` ฺฉ **ุนููฺฏุฑ ุชุงุจุน (`operator()`)** ุฏุงุฑุฏ ฺฉู ุงูฺฉุงู ุงุฌุฑุง ุขู ุจูโุนููุงู ฺฉ ุชุงุจุน ุฑุง ูโุฏูุฏ.
- ุฏุฑ ุงูุฌุงุ `F{vec2}` ฺฉ ุดุก ุงุฒ `F` ุงุฌุงุฏ ูโฺฉูุฏ ฺฉู ูุฑุฌุน ุจู `vec2` ูฺฏู ูโุฏุงุฑุฏ.
- ุงู ุดุกุ ุณูพุณ ุจู `thread` ุงุฑุณุงู ูโุดูุฏ ฺฉู ุจุงุนุซ ุงุฌุฑุง `F::operator()()` ุฏุฑ ฺฉ ุฑุดุชู ุฌุฏุฏ ูโุดูุฏ.

---

### **ฺุฑุง `vec2` ุฑุง ุจุง ูุฑุฌุน (`&`) ุงุฑุณุงู ูโฺฉููุ**
- ุฏุฑ ุณุงุฎุชุงุฑ `F`ุ `vec2` **ุจุง ูุฑุฌุน (`vector<double>& v`) ุฐุฎุฑู ูโุดูุฏ**.
- ุนู ูุฑ ุชุบุฑ ฺฉู ุฏุฑ `F` ุฑู `v` ุงูุฌุงู ุดูุฏุ ุฑู `vec2` ุงุตู ุงุนูุงู ุฎูุงูุฏ ุดุฏ.
- **ูุดฺฉู ุงู ุฑูุด:** ุงฺฏุฑ ููโุฒูุงู ูุธูู ุฏฺฏุฑ ุฑู `vec2` ุงุฌุฑุง ุดูุฏุ ุงุญุชูุงู ุจุฑูุฒ **ุดุฑุงุท ุฑูุงุจุช (race condition)** ูุฌูุฏ ุฏุงุฑุฏ.
- **ุฑุงูโุญู:** ุงฺฏุฑ `vec2` ุฑุง **ุจุง ููุฏุงุฑ (`by value`)** ุงุฑุณุงู ฺฉููุ ฺฉูพ ุฌุฏุฏ ุงุฒ `vec2` ุงุฌุงุฏ ุดุฏู ู ูุดฺฉู ุฏุฑ ููโุฒูุงู ูพุด ููโุขุฏ.

---

### **ุงุฌุฑุง ููโุฒูุงู ู ููุงููฺฏ (`join`)**
```cpp
t1.join();
t2.join();
```
- `join()` ุจุงุนุซ ูโุดูุฏ ฺฉู `main()` ุชุง ุฒูุงู ูพุงุงู `t1` ู `t2` ููุชุธุฑ ุจูุงูุฏ.
- ุจุฏูู `join()`ุ `main()` ููฺฉู ุงุณุช ูุจู ุงุฒ ุงุชูุงู `t1` ู `t2` ุงุฌุฑุง ุฑุง ุชูุงู ฺฉูุฏ ู ุจุฑูุงูู ุงุฒ ุจู ุจุฑูุฏ.

---

### **ููุงุณู ุฏู ุฑูุด (`f` ู `F::operator()`)**
- ูุฑ ุฏู ุฑูุด ุจู `thread` ฺฉ **ุชุงุจุน ุจุฑุง ุงุฌุฑุง** ูโุฏููุฏ.
- ุฏุฑ ุฑูุด `F`, ฺฉ ุดุก ุชุงุจุน (`function object`) ุณุงุฎุชู ุดุฏู ู ุงุฌุฑุง ูโุดูุฏ.
- ุฏุฑ ุฑูุด `f`, ุงุฒ ฺฉ **ุชุงุจุน ุนุงุฏ** ุงุณุชูุงุฏู ุดุฏู ุงุณุช.
- ุนููฺฉุฑุฏ ููุง ูุฑ ุฏู ุชูุฑุจุงู ฺฉุณุงู ุงุณุช.

---

### **ุฌูุนโุจูุฏ**
โ **ูุญูู ุงุฑุณุงู ุฏุงุฏู ุจู thread:**
- **ุจุง ููุฏุงุฑ (by value):** ุงููโุชุฑุ ุงูุง ฺฉูุฏุชุฑ (ฺูู ูุงุฒ ุจู ฺฉูพ ุฏุงุฑุฏ).
- **ุจุง ูุฑุฌุน (by reference):** ุณุฑุนโุชุฑุ ุงูุง ูุงุฒููุฏ ููุงููฺฏ ุจุฑุง ุฌููฺฏุฑ ุงุฒ ุดุฑุงุท ุฑูุงุจุช.

โ **ูุญูู ุงุฑุณุงู ุชุงุจุน ุจู thread:**
- **ุชุงุจุน ุนุงุฏ (`f`)** ูุณุชููุงู ุงุฑุณุงู ูโุดูุฏ.
- **ุดุก ุชุงุจุน (`F`)** ุงุฒ `operator()` ุจุฑุง ุงุฌุฑุง ุงุณุชูุงุฏู ูโฺฉูุฏ.

โ **ูุฏู ฺฉู:** ุงุฌุฑุง ููุงุฒ ฺฉุฏ ู ูพุฑุฏุงุฒุด ููโุฒูุงู ุฏุงุฏูโูุง ุจุฑุง ุจูุจูุฏ ฺฉุงุฑุง.

---
**ูุชุฌู:**  
ุงู ูุซุงู ูุดุงู ูโุฏูุฏ ฺฉู ฺุทูุฑ ูโุชูุงู ุงุฒ **ุฑุดุชูโูุง (`threads`)** ุจุฑุง ุงุฌุฑุง ููโุฒูุงู ุชูุงุจุน ุง ุงุดุงุก ุชุงุจุน ุฏุฑ C++ ุงุณุชูุงุฏู ฺฉุฑุฏ ู ุชูุงูุช ุจู ุงุฑุณุงู ุฏุงุฏู ุจุง ููุฏุงุฑ ู ุจุง ูุฑุฌุน ุฑุง ุจุฑุฑุณ ฺฉุฑุฏ. ๐

---

## Returning Results
ุฏุฑ ูุซุงู ุงุฑุงุฆูโุดุฏู ุฏุฑ **ยง5.3.2**ุ ุขุฑฺฏููุงูโูุง ุฑุง ุจุง **ูุฑุฌุน ุบุฑ `const`** ุงุฑุณุงู ูโฺฉูู. ูู ููุท ุฒูุงู ุงู ฺฉุงุฑ ุฑุง ุงูุฌุงู ูโุฏูู ฺฉู ุงูุชุธุงุฑ ุฏุงุดุชู ุจุงุดู **ูุธูู (task) ููุฏุงุฑ ุฏุงุฏูโุง ฺฉู ุจู ุขู ุงุฑุฌุงุน ุฏุงุฏู ุดุฏู ุฑุง ุชุบุฑ ุฏูุฏ** (ยง7.7). ุงู ฺฉ ุฑูุด **ฺฉู ุฒุฑฺฉุงููุ ุงูุง ุฑุงุฌ** ุจุฑุง ุจุงุฒฺฏุฑุฏุงูุฏู ูุชุฌู ุงุณุช.

ฺฉ ุชฺฉูฺฉ **ฺฉูุชุฑ ูุจูู** ุงู ุงุณุช ฺฉู **ุฏุงุฏูโูุง ูุฑูุฏ ุฑุง ุจุง ูุฑุฌุน `const` ุงุฑุณุงู ฺฉูู** ู **ูุญู ุฐุฎุฑู ูุชุฌู ุฑุง ุจูโุนููุงู ฺฉ ุขุฑฺฏููุงู ุฌุฏุงฺฏุงูู ุงุฑุณุงู ฺฉูู**:

```cpp
void f(const vector<double>& v, double* res); // ุฏุฑุงูุช ูุฑูุฏ ุงุฒ v ู ุฐุฎุฑู ูุชุฌู ุฏุฑ *res

class F {
public:
    F(const vector<double>& vv, double* p) : v{vv}, res{p} { }
    void operator()(); // ุฐุฎุฑู ูุชุฌู ุฏุฑ *res

private:
    const vector<double>& v; // ููุจุน ูุฑูุฏ
    double* res; // ููุตุฏ ุฎุฑูุฌ
};

int main()
{
    vector<double> some_vec;
    vector<double> vec2;
    // ...
    double res1;
    double res2;

    thread t1 {f, some_vec, &res1}; // ุงุฌุฑุง f(some_vec, &res1) ุฏุฑ ฺฉ ุฑุดุชู (thread) ุฌุฏุงฺฏุงูู
    thread t2 {F{vec2, &res2}}; // ุงุฌุฑุง F{vec2, &res2}() ุฏุฑ ฺฉ ุฑุดุชู ุฌุฏุงฺฏุงูู

    t1.join();
    t2.join();

    cout << res1 << ' ' << res2 << '\n';
}
```

ูู ุงุฑุณุงู ูุชุฌู **ุงุฒ ุทุฑู ุขุฑฺฏููุงูโูุง** ุฑุง **ุฑูุด ฺูุฏุงู ุธุฑู ููโุฏุงูู**ุ ุจูุงุจุฑุงู ุฏุฑ **ยง5.3.5.1** ุฏูุจุงุฑู ุจู ุงู ููุถูุน ุจุงุฒุฎูุงูู ฺฏุดุช.

## Sharing Data
ฺฏุงู ุงููุงุชุ ูุธุงู ูุงุฒ ุฏุงุฑูุฏ ุฏุงุฏูโูุง ุฑุง ุจู ุงุดุชุฑุงฺฉ ุจฺฏุฐุงุฑูุฏ. ุฏุฑ ฺูู ุดุฑุงุทุ ุฏุณุชุฑุณ ุจุงุฏ ููฺฏุงูโุณุงุฒ ุดูุฏ ุชุง ุฏุฑ ูุฑ ูุญุธู ุญุฏุงฺฉุซุฑ ฺฉ ูุธูู ุจุชูุงูุฏ ุจู ุฏุงุฏูโูุง ุฏุณุชุฑุณ ุฏุงุดุชู ุจุงุดุฏ. ุจุฑูุงููโููุณุงู ุจุงุชุฌุฑุจู ุงู ุฑุง ุจูโุนููุงู ฺฉ ุณุงุฏูโุณุงุฒ ุชุดุฎุต ุฎูุงููุฏ ุฏุงุฏ (ูุซูุงู ูุดฺฉู ุฏุฑ ุฎูุงูุฏู ููโุฒูุงู ุฏุงุฏูโูุง ุชุบุฑูุงูพุฐุฑ ุชูุณุท ฺูุฏู ูุธูู ูุฌูุฏ ูุฏุงุฑุฏ)ุ ุงูุง ุจุงุฏ ุฏุฑ ูุธุฑ ฺฏุฑูุช ฺฉู ฺฺฏููู ูโุชูุงู ุงุทููุงู ุญุงุตู ฺฉุฑุฏ ฺฉู ุฏุฑ ูุฑ ูุญุธู ุญุฏุงฺฉุซุฑ ฺฉ ูุธูู ุจู ฺฉ ูุฌููุนู ุฏุงุฏู ูุดุฎุต ุฏุณุชุฑุณ ุฏุงุดุชู ุจุงุดุฏ.  

ุนูุตุฑ ุงุณุงุณ ุงู ุฑุงูโุญูุ ฺฉ **ููุชฺฉุณ** (mutex) ุง **ุดุก ุญุฐู ูุชูุงุจู** ุงุณุช. ฺฉ ุฑุดุชู (thread) ุจุง ุงุณุชูุงุฏู ุงุฒ ุนููุงุช `lock()` ฺฉ ููุชฺฉุณ ุฑุง ุจู ุฏุณุช ูโุขูุฑุฏ:  

```cpp
mutex m; // ููุชฺฉุณ ฺฉูุชุฑูโฺฉููุฏู
int sh; // ุฏุงุฏูโ ูุดุชุฑฺฉ

void f()
{
    unique_lock<mutex> lck {m}; // ฺฏุฑูุชู ููุชฺฉุณ
    sh += 7; // ุฏุณุชฺฉุงุฑ ุฏุงุฏูโ ูุดุชุฑฺฉ
} // ุขุฒุงุฏุณุงุฒ ููุชฺฉุณ ุจูโุตูุฑุช ุถูู
```

ุณุงุฒูุฏูโ `unique_lock`ุ ููุชฺฉุณ ุฑุง ุงุฒ ุทุฑู ูุฑุงุฎูุงู `m.lock()` ุจู ุฏุณุช ูโุขูุฑุฏ. ุงฺฏุฑ ฺฉ ุฑุดุชูโ ุฏฺฏุฑ ูุจูุงู ุงู ููุชฺฉุณ ุฑุง ฺฏุฑูุชู ุจุงุดุฏุ ุฑุดุชูโ ุฌุฏุฏ ููุชุธุฑ ูโูุงูุฏ (ูุณุฏูุฏ ูโุดูุฏ) ุชุง ุฑุดุชูโ ุฏฺฏุฑ ุฏุณุชุฑุณ ุฎูุฏ ุฑุง ุชฺฉูู ฺฉูุฏ. ุฒูุงู ฺฉู ฺฉ ุฑุดุชู ุฏุณุชุฑุณ ุฎูุฏ ุจู ุฏุงุฏูโูุง ูุดุชุฑฺฉ ุฑุง ุชฺฉูู ฺฉุฑุฏุ `unique_lock` ููุชฺฉุณ ุฑุง ุขุฒุงุฏ ูโฺฉูุฏ (ุจุง ฺฉ ูุฑุงุฎูุงู `m.unlock()`). ุงูฺฉุงูุงุช ุญุฐู ูุชูุงุจู ู ููู ฺฉุฑุฏู ุฏุฑ ฺฉุชุงุจุฎุงููโ `<mutex>` ุงุณุชุงูุฏุงุฑุฏ C++ ูุฑุงุฑ ุฏุงุฑูุฏ.  

ุงุฑุชุจุงุท ุจู ุฏุงุฏูโูุง ูุดุชุฑฺฉ ู ฺฉ ููุชฺฉุณ ูุจุชู ุจุฑ ูุฑุงุฑุฏุงุฏ ุงุณุช: ุจุฑูุงููโููุณ ุจุงุฏ ุจุฏุงูุฏ ฺฉู ฺฉุฏุงู ููุชฺฉุณ ูุฑุจูุท ุจู ฺฉุฏุงู ุฏุงุฏู ุงุณุช. ูุงุถุญ ุงุณุช ฺฉู ุงู ุฑูุด ูุณุชุนุฏ ุฎุทุงุณุชุ ู ุงุฒ ุทุฑู ูุฒ ูโุชูุงูู ุจุง ุงุณุชูุงุฏู ุงุฒ ุฑูุดโูุง ูุฎุชูู ุฒุจุงูุ ุงู ุงุฑุชุจุงุท ุฑุง ุดูุงูโุชุฑ ฺฉูู. ุจูโุนููุงู ูุซุงู:  

```cpp
class Record {
public:
    mutex rm;
    // ...
};
```

ุจุฏู ุงุณุช ฺฉู ุงฺฏุฑ ูููููโุง ุงุฒ `Record` ุจุง ูุงู `rec` ุฏุงุดุชู ุจุงุดูุ `rec.rm` ฺฉ ููุชฺฉุณ ุงุณุช ฺฉู ุจุงุฏ ูุจู ุงุฒ ุฏุณุชุฑุณ ุจู ุฏุงุฏูโูุง ุฏฺฏุฑ ุงู ฺฉูุงุณุ ุขู ุฑุง ุจู ุฏุณุช ุขูุฑูุ ูุฑฺูุฏ ฺฉ ุชูุถุญ ุง ูุงู ุจูุชุฑ ูโุชูุงูุฏ ุจู ุฎูุงููุฏู ฺฉูฺฉ ุจุดุชุฑ ฺฉูุฏ.  

ฺฏุงู ุงููุงุช ูุงุฒ ุงุณุช ฺฉู ฺูุฏู ููุจุน ุฑุง ุจูโุตูุฑุช ููโุฒูุงู ุจุฑุง ุงูุฌุงู ฺฉ ุนููุงุช ุฏุฑ ุงุฎุชุงุฑ ุจฺฏุฑู. ุงู ูุถุนุช ูโุชูุงูุฏ ููุฌุฑ ุจู **ุจูโุจุณุช (deadlock)** ุดูุฏ. ุจุฑุง ูุซุงูุ ุงฺฏุฑ `thread1` ุงุจุชุฏุง `mutex1` ุฑุง ฺฏุฑูุชู ู ุณูพุณ ุชูุงุด ฺฉูุฏ `mutex2` ุฑุง ุจฺฏุฑุฏุ ุฏุฑุญุงูโฺฉู `thread2` ุงุจุชุฏุง `mutex2` ุฑุง ฺฏุฑูุชู ู ุณูพุณ ุณุน ฺฉูุฏ `mutex1` ุฑุง ุจฺฏุฑุฏุ ูฺโฺฉุฏุงู ุงุฒ ุงู ุฏู ูุธูู ูุฑฺฏุฒ ูพุด ูุฎูุงููุฏ ุฑูุช.  

ฺฉุชุงุจุฎุงููโ ุงุณุชุงูุฏุงุฑุฏ C++ ฺฉ ุฑุงูฺฉุงุฑ ุจุฑุง ุฌููฺฏุฑ ุงุฒ ุงู ูุดฺฉู ุงุฑุงุฆู ูโุฏูุฏ ฺฉู ุงูฺฉุงู ฺฏุฑูุชู ฺูุฏู ููู ุฑุง ุจูโุตูุฑุช ููโุฒูุงู ูุฑุงูู ูโฺฉูุฏ:  

```cpp
void f()
{
    // ...
    unique_lock<mutex> lck1 {m1,defer_lock}; // defer_lock: ูููุฒ ููู ุฑุง ุฏุฑุงูุช ูฺฉู
    unique_lock<mutex> lck2 {m2,defer_lock};
    unique_lock<mutex> lck3 {m3,defer_lock};
    // ...
    lock(lck1,lck2,lck3); // ฺฏุฑูุชู ููโุฒูุงู ูููโ ูููโูุง
    // ... ุฏุณุชฺฉุงุฑ ุฏุงุฏูโูุง ูุดุชุฑฺฉ ...
} // ุขุฒุงุฏุณุงุฒ ุถูู ูููโ ููุชฺฉุณโูุง
```

ุชุงุจุน `lock()` ุชููุง ุฒูุงู ุงุฌุฑุง ูโุดูุฏ ฺฉู ุจุชูุงูุฏ ุชูุงู ููุชฺฉุณโูุง ูุฑูุฏ ุฑุง ุจูโุทูุฑ ููโุฒูุงู ุฏุฑุงูุช ฺฉูุฏ ู ูุฑฺฏุฒ ุฒูุงู ฺฉู ฺฉ ููุชฺฉุณ ุฏุฑ ุญุงู ุญุงุถุฑ ฺฏุฑูุชู ุดุฏู ุจุงุดุฏุ ูุณุฏูุฏ ููโุดูุฏ. ููฺููุ **ุณุงุฒูุฏูโูุง ุชุฎุฑุจโฺฉููุฏู** (destructors) ุจุฑุง `unique_lock`ูุง ุฌุฏุงฺฏุงูู ุชุถูู ูโฺฉููุฏ ฺฉู ููุชฺฉุณโูุง ููฺฏุงู ุฎุฑูุฌ ุงุฒ ุญูุฒูโ ุนููฺฉุฑุฏุ ุขุฒุงุฏ ุดููุฏ.  

**ุงุฑุชุจุงุท ุงุฒ ุทุฑู ุฏุงุฏูโูุง ูุดุชุฑฺฉุ ฺฉ ุณุทุญ ูพุงู ุงุฒ ุงุฑุชุจุงุทุงุช ุงุณุช.** ุจูโูฺูุ ุจุฑูุงููโููุณ ุจุงุฏ ุฑูุดโูุง ุจุฑุง ุชุนู ุงูฺฉู ฺฉุฏุงู ฺฉุงุฑ ุงูุฌุงู ุดุฏู ู ฺฉุฏุงู ฺฉุงุฑ ูููุฒ ุงูุฌุงู ูุดุฏู ุงุณุชุ ุทุฑุงุญ ฺฉูุฏ. ุงุฒ ุงู ูุธุฑุ ุงุณุชูุงุฏู ุงุฒ ุฏุงุฏูโูุง ูุดุชุฑฺฉ ุฏุฑ ููุงุณู ุจุง ููููู **ูุฑุงุฎูุงู ู ุจุงุฒฺฏุดุช ุชุงุจุน** ฺฉูุชุฑ ฺฉุงุฑุขูุฏ ุงุณุช. ุงุฒ ุณู ุฏฺฏุฑุ ุจุฑุฎ ูุนุชูุฏูุฏ ฺฉู ุงุดุชุฑุงฺฉโฺฏุฐุงุฑ ุฏุงุฏูโูุง ุจุงุฏ ฺฉุงุฑุขูุฏุชุฑ ุงุฒ ฺฉูพ ฺฉุฑุฏู ุขุฑฺฏููุงูโูุง ู ููุงุฏุฑ ุจุงุฒฺฏุดุช ุจุงุดุฏ. ุงู ููุถูุน **ุฏุฑ ููุฑุฏ ุฏุงุฏูโูุง ุญุฌู ูโุชูุงูุฏ ุฏุฑุณุช ุจุงุดุฏ**ุ ุงูุง **ุนููุงุช ููู ฺฉุฑุฏู ู ุจุงุฒ ฺฉุฑุฏู ููู ูุณุจุชุงู ูพุฑูุฒูู ูุณุชูุฏ**. ุงุฒ ุณู ุฏฺฏุฑุ ูุงุดูโูุง ูุฏุฑู **ุฏุฑ ฺฉูพ ฺฉุฑุฏู ุฏุงุฏูโูุงุ ุจูโูฺู ุฏุงุฏูโูุง ูุดุฑุฏู ูุงููุฏ ุนูุงุตุฑ ฺฉ ุจุฑุฏุงุฑ (vector)ุ ุจุณุงุฑ ุณุฑุน ูุณุชูุฏ**. ุจูุงุจุฑุงูุ **ุงุฒ ุฏุงุฏูโูุง ูุดุชุฑฺฉ ุจูโุฎุงุทุฑ "ฺฉุงุฑุง" ุจุฏูู ุชูฺฉุฑ ู ุงูุฏุงุฒูโฺฏุฑ ุฏูู ุงุณุชูุงุฏู ูฺฉูุฏ**.

### **ุชูุถุญ ูุชู ุฏุฑุจุงุฑูโ ููฺฏุงูโุณุงุฒ ุฏุณุชุฑุณ ุจู ุฏุงุฏูโูุง ูุดุชุฑฺฉ ุฏุฑ ุจุฑูุงููโูุง ฺูุฏูุฎ (Multi-threading)**

ุฏุฑ ุจุฑูุงููโูุง ฺูุฏูุฎุ ุฒูุงู ฺฉู ฺูุฏู **ูุธูู (task)** ุง **ุฑุดุชู (thread)** ุจูโุทูุฑ ููโุฒูุงู ุงุฌุฑุง ูโุดููุฏุ ููฺฉู ุงุณุช ูุงุฒ ุฏุงุดุชู ุจุงุดูุฏ ฺฉู ุจู ฺฉ ูุฌููุนู ุฏุงุฏู ูุดุชุฑฺฉ ุฏุณุชุฑุณ ูพุฏุง ฺฉููุฏ. ุงู ูุณุฆูู ูโุชูุงูุฏ ูุดฺฉูุงุช ุงุฌุงุฏ ฺฉูุฏุ ุฒุฑุง ุงฺฏุฑ ฺูุฏู ุฑุดุชู ููโุฒูุงู ุจุฎูุงููุฏ ุฏุงุฏูโ ูุดุชุฑฺฉ ุฑุง ุชุบุฑ ุฏููุฏุ ููฺฉู ุงุณุช ุฏุงุฏูโูุง ุฎุฑุงุจ ุดุฏู ุง ูุชุงุฌ ูุงูุนุชุจุฑ ุชููุฏ ุดููุฏ.

#### **๐น ุฑุงูโุญู: ุงุณุชูุงุฏู ุงุฒ Mutex (ุญุฐู ูุชูุงุจู)**
ุจุฑุง ุฌููฺฏุฑ ุงุฒ ุงู ูุดฺฉูุ ุงุฒ **ููุชฺฉุณ (Mutex - Mutual Exclusion Object)** ุงุณุชูุงุฏู ูโุดูุฏ. ููุชฺฉุณ ฺฉ **ููู (lock)** ุงุณุช ฺฉู ุฏุฑ ูุฑ ูุญุธู ููุท ฺฉ ุฑุดุชู ูโุชูุงูุฏ ุขู ุฑุง ุฏุฑุงูุช ฺฉูุฏ ู ุจู ุฏุงุฏูโูุง ูุญุงูุธุชโุดุฏู ุฏุณุชุฑุณ ุฏุงุดุชู ุจุงุดุฏ. ุณุงุฑ ุฑุดุชูโูุง ุจุงุฏ ููุชุธุฑ ุจูุงููุฏ ุชุง ุงู ููู ุขุฒุงุฏ ุดูุฏ.

๐ธ **ูุซุงู ุงูููโ ุงุณุชูุงุฏู ุงุฒ Mutex ุฏุฑ C++:**
```cpp
mutex m;  // ููุชฺฉุณ ฺฉูุชุฑูโฺฉููุฏู
int sh;   // ุฏุงุฏูโ ูุดุชุฑฺฉ

void f() {
    unique_lock<mutex> lck {m}; // ฺฏุฑูุชู ููู
    sh += 7; // ุชุบุฑ ุฏุฑ ุฏุงุฏูโ ูุดุชุฑฺฉ
} // ููู ุจูโุตูุฑุช ุฎูุฏฺฉุงุฑ ุฏุฑ ูพุงุงู ุชุงุจุน ุขุฒุงุฏ ูโุดูุฏ
```
ุฏุฑ ุงู ูุซุงู:
- `unique_lock<mutex>` ูุณุฆูู ูุฏุฑุช ููู ุงุณุช.
- ููุช ฺฉ `unique_lock` ุณุงุฎุชู ูโุดูุฏุ ุจูโุตูุฑุช ุฎูุฏฺฉุงุฑ `m.lock()` ุฑุง ุงุฌุฑุง ูโฺฉูุฏ.
- ุฒูุงู ฺฉู ุชุงุจุน ุชูุงู ูโุดูุฏุ `unique_lock` ุจูโุทูุฑ ุฎูุฏฺฉุงุฑ `m.unlock()` ุฑุง ุงุฌุฑุง ฺฉุฑุฏู ู ููู ุฑุง ุขุฒุงุฏ ูโฺฉูุฏ.

#### **๐น ูุดฺฉู ุงุฑุชุจุงุท ุจู ุฏุงุฏูโูุง ู Mutex**
ููุชฺฉุณโูุง ุจู ฺฉ ูุฌููุนู ุฏุงุฏู ุงุฎุชุตุงุต ุฏุงุฑูุฏุ ุงูุง **ุจุฑูุงููโููุณ ุจุงุฏ ุจุฏุงูุฏ ฺฉู ฺฉุฏุงู ููุชฺฉุณ ุจุฑุง ฺฉุฏุงู ุฏุงุฏู ุงุณุช**. ุงฺฏุฑ ุงู ุงุฑุชุจุงุท ุจูโุฏุฑุณุช ุชุนุฑู ูุดูุฏุ ููฺฉู ุงุณุช ุจุฑูุงูู ุฏฺุงุฑ **ุฎุทุงูุง ููฺฏุงูโุณุงุฒ (Synchronization Errors)** ุดูุฏ.

๐ธ **ุฑูุด ุจูุชุฑ: ุชุนุฑู Mutex ุฏุฑ ุฏุงุฎู ฺฉูุงุณโูุง**
ุจุฑุง ุฑูุดูโุชุฑ ฺฉุฑุฏู ุงู ุงุฑุชุจุงุทุ ูโุชูุงู ููุชฺฉุณ ุฑุง ุฏุฑ ฺฉูุงุฑ ุฏุงุฏูโูุง ุฏุฑ ฺฉูุงุณโูุง ุชุนุฑู ฺฉุฑุฏ:
```cpp
class Record {
public:
    mutex rm;
    // ุณุงุฑ ุฏุงุฏูโูุง ฺฉูุงุณ...
};
```
ุฏุฑ ุงูุฌุงุ ุงฺฏุฑ ูููููโุง ุงุฒ `Record` ุจุง ูุงู `rec` ุฏุงุดุชู ุจุงุดูุ ุจูโุทูุฑ ุทุจุน `rec.rm` ฺฉ ููุชฺฉุณ ุงุณุช ฺฉู ุจุงุฏ ูุจู ุงุฒ ุฏุณุชุฑุณ ุจู ุฏุงุฏูโูุง ุฏฺฏุฑ ุงู ฺฉูุงุณุ ุขู ุฑุง ุฏุฑุงูุช ฺฉูู.

---

### **๐น ูุดฺฉู ุจูโุจุณุช (Deadlock)**
ุฏุฑ ุจุฑุฎ ููุงูุนุ ููฺฉู ุงุณุช ฺฉ ุฑุดุชู **ููู ฺฉ ููุชฺฉุณ ุฑุง ุฏุฑุงูุช ฺฉูุฏ ู ููุชุธุฑ ุจูุงูุฏ ุชุง ููู ุฏฺฏุฑ ุฑุง ุจฺฏุฑุฏุ ุฏุฑ ุญุงู ฺฉู ฺฉ ุฑุดุชูโ ุฏฺฏุฑ ููู ุฏูู ุฑุง ฺฏุฑูุชู ู ููุชุธุฑ ููู ุงูู ุงุณุช**. ุฏุฑ ุงู ุญุงูุชุ ูฺโฺฉุฏุงู ุงุฒ ุฑุดุชูโูุง ููโุชูุงููุฏ ุงุฏุงูู ุฏููุฏ ู ุจุฑูุงูู **ุฏุฑ ุจูโุจุณุช ฺฏุฑ ูโฺฉูุฏ**.

๐ธ **ูุซุงู ุงุฒ ุงุฌุงุฏ ุจูโุจุณุช:**
- `thread1` ุงุจุชุฏุง `mutex1` ุฑุง ูโฺฏุฑุฏ ู ุณูพุณ ุณุน ูโฺฉูุฏ `mutex2` ุฑุง ุจฺฏุฑุฏ.
- `thread2` ุงุจุชุฏุง `mutex2` ุฑุง ูโฺฏุฑุฏ ู ุณูพุณ ุณุน ูโฺฉูุฏ `mutex1` ุฑุง ุจฺฏุฑุฏ.
- ูฺโฺฉุฏุงู ุงุฒ ุงู ุฏู ุฑุดุชู ููโุชูุงููุฏ ุงุฏุงูู ุฏููุฏุ ฺูู ูุฑฺฉุฏุงู ููุชุธุฑ ุฏฺฏุฑ ุงุณุช.

โ **ุฑุงูโุญู: ุงุณุชูุงุฏู ุงุฒ `lock()` ุจุฑุง ุฏุฑุงูุช ฺูุฏู ููู ุจูโุตูุฑุช ููโุฒูุงู**
```cpp
void f() {
    unique_lock<mutex> lck1 {m1, defer_lock}; // ููู ูููุฒ ฺฏุฑูุชู ูุดุฏู
    unique_lock<mutex> lck2 {m2, defer_lock};
    unique_lock<mutex> lck3 {m3, defer_lock};

    lock(lck1, lck2, lck3); // ูููโ ูููโูุง ุฑุง ุจูโุตูุฑุช ููโุฒูุงู ุจฺฏุฑ
    // ุชุบุฑ ุฏุงุฏูโูุง ูุดุชุฑฺฉ...
} // ูููโูุง ุจูโุตูุฑุช ุฎูุฏฺฉุงุฑ ุขุฒุงุฏ ูโุดููุฏ
```
ุฏุฑ ุงู ุฑูุด:
- ุงุฒ `defer_lock` ุงุณุชูุงุฏู ูโุดูุฏ ุชุง ูููโูุง ููุฑุงู ฺฏุฑูุชู ูุดููุฏ.
- ุณูพุณ ุชุงุจุน `lock()` ููโุฒูุงู ูููโ ูููโูุง ุฑุง ุฏุฑุงูุช ูโฺฉูุฏ.
- ุงู ุฑูุด **ูฺโฺฏุงู ุฏุฑ ุญุงูุช ุงูุชุธุงุฑ ฺฉ ููู ุฑุง ูฺฏู ููโุฏุงุฑุฏ ู ููุชุธุฑ ููู ุฏฺฏุฑ ููโูุงูุฏ**ุ ุจูุงุจุฑุงู **ุงุญุชูุงู ุจูโุจุณุช ฺฉุงูุด ูโุงุจุฏ**.

---

### **๐น ุขุง ุงุดุชุฑุงฺฉโฺฏุฐุงุฑ ุฏุงุฏู ุณุฑุนโุชุฑ ุงุฒ ฺฉูพ ฺฉุฑุฏู ุขู ุงุณุชุ**
ุจุฑุฎ ุงุฒ ุจุฑูุงููโููุณุงู ุชุตูุฑ ูโฺฉููุฏ ฺฉู **ุงุณุชูุงุฏู ุงุฒ ุฏุงุฏูโูุง ูุดุชุฑฺฉุ ุณุฑุนโุชุฑ ุงุฒ ฺฉูพ ฺฉุฑุฏู ุฏุงุฏูโูุง ุจู ุฑุดุชูโูุง ุงุณุช**. ุงูุง ุงู ููุดู ุฏุฑุณุช ูุณุช!

- **ุงฺฏุฑ ุฏุงุฏูโูุง ุจุฒุฑฺฏ ูุงููุฏ ุขุฑุงูโูุง ุง ูุงูโูุง ุญุฌู ูุฌูุฏ ุฏุงุดุชู ุจุงุดุฏุ ุงุดุชุฑุงฺฉโฺฏุฐุงุฑ ุขูโูุง ูโุชูุงูุฏ ฺฉุงุฑุขูุฏุชุฑ ุงุฒ ฺฉูพ ฺฉุฑุฏู ุจุงุดุฏ.**
- **ุงูุง ุนููุงุช ููู ฺฉุฑุฏู (`lock()`) ู ุขุฒุงุฏุณุงุฒ ููู (`unlock()`) ุฒูุงูโุจุฑ ูุณุชูุฏ.**
- **ูพุฑุฏุงุฒูุฏูโูุง ูุฏุฑู ุฏุฑ ฺฉูพ ฺฉุฑุฏู ุฏุงุฏูโูุง ฺฉูฺฺฉ ุจุณุงุฑ ุณุฑุน ูุณุชูุฏุ ูุฎุตูุตุงู ููุช ุฏุงุฏูโูุง ูุดุฑุฏู ู ุฏุฑ ุญุงูุธู ูุฒุฏฺฉ ูู ุจุงุดูุฏ (ูุซู ุนูุงุตุฑ ฺฉ `vector`).**

โ **ูพุณ ูุจุงุฏ ุงุฒ ุฏุงุฏูโูุง ูุดุชุฑฺฉ ููุท ุจู ุฏูู "ุจููู ุจูุฏู" ุงุณุชูุงุฏู ฺฉุฑุฏุ ุจูฺฉู ุจุงุฏ ฺฉุงุฑุง ุฑุง ุงูุฏุงุฒูโฺฏุฑ ฺฉุฑุฏ ู ุชุตูู ููุทู ฺฏุฑูุช.**

---

### **๐ ุฎูุงุตูโ ูฺฉุงุช ููู**
1. **ููุช ฺูุฏู ุฑุดุชู ุจู ฺฉ ุฏุงุฏูโ ูุดุชุฑฺฉ ุฏุณุชุฑุณ ุฏุงุฑูุฏุ ุจุงุฏ ุงุฒ `mutex` ุจุฑุง ฺฉูุชุฑู ููฺฏุงูโุณุงุฒ ุงุณุชูุงุฏู ฺฉูู.**
2. **ุงุณุชูุงุฏู ุงุฒ `unique_lock<mutex>` ุจุงุนุซ ูโุดูุฏ ฺฉู ูููโูุง ุจูโุตูุฑุช ุฎูุฏฺฉุงุฑ ูุฏุฑุช ุดููุฏ.**
3. **ุงฺฏุฑ ฺูุฏู ููุชฺฉุณ ูุงุฒ ุงุณุชุ ุงุณุชูุงุฏู ุงุฒ `lock()` ุจุฑุง ฺฏุฑูุชู ููโุฒูุงู ุขูโูุง ูุงูุน ุงุฒ ุจุฑูุฒ ุจูโุจุณุช ูโุดูุฏ.**
4. **ุงูุชุฎุงุจ ุจู ุงุดุชุฑุงฺฉโฺฏุฐุงุฑ ุฏุงุฏูโูุง ู ฺฉูพ ฺฉุฑุฏู ุขูโูุง ุจุณุชฺฏ ุจู ุงูุฏุงุฒูโ ุฏุงุฏู ู ูุฒููโ ุนููุงุช ููู ฺฉุฑุฏู ุฏุงุฑุฏ.**

โ **ุฏุฑ ฺฉูุ ูุฏุฑุช ุตุญุญ ููฺฏุงูโุณุงุฒ ุฏุฑ ุจุฑูุงููโูุง ฺูุฏูุฎ ุจุณุงุฑ ููู ุงุณุชุ ุฒุฑุง ุงุดุชุจุงูุงุช ุฏุฑ ุงู ุจุฎุด ูโุชูุงููุฏ ุจุงุนุซ ุฎุฑุงุจ ุฏุงุฏูโูุงุ ฺฉูุฏ ุดุฏู ุจุฑูุงููุ ุง ุญุช ุชููู ุงุฌุฑุง ุขู ุดููุฏ.**

## Waiting for Events
ฺฏุงู ุงููุงุชุ ฺฉ ุฑุดุชู (Thread) ูุงุฒ ุฏุงุฑุฏ ฺฉู ููุชุธุฑ ฺฉ ุฑูุฏุงุฏ ุฎุงุฑุฌ ุจูุงูุฏุ ูุงููุฏ ุงุชูุงู ฺฉุงุฑ ฺฉ ุฑุดุชู ุฏฺฏุฑ ุง ุณูพุฑ ุดุฏู ููุฏุงุฑ ูุดุฎุต ุงุฒ ุฒูุงู. ุณุงุฏูโุชุฑู ยซุฑูุฏุงุฏยป ุฏุฑ ุงูุฌุงุ ฺฏุฐุฑ ุฒูุงู ุงุณุช.

ุฏุฑ ูุธุฑ ุจฺฏุฑุฏ:

```cpp
using namespace std::chrono; // ูุฑุงุฌุนู ฺฉูุฏ ุจู ยง35.2
auto t0 = high_resolution_clock::now();
this_thread::sleep_for(milliseconds{20});
auto t1 = high_resolution_clock::now();
cout << duration_cast<nanoseconds>(t1โt0).count() << " nanoseconds passed\n";
```

ุชูุฌู ุฏุงุดุชู ุจุงุดุฏ ฺฉู ุญุช ูุงุฒ ุจู ุฑุงูโุงูุฏุงุฒ ฺฉ ุฑุดุชู ุฌุฏุฏ ูู ูุฏุงุดุชูุ ุจูโุทูุฑ ูพุดโูุฑุถุ `this_thread` ุจู ููุงู ฺฉ ู ุชููุง ุฑุดุชู ุงุดุงุฑู ูโฺฉูุฏ (ยง42.2.6).  
ุงุฒ `duration_cast` ุจุฑุง ุชูุธู ูุงุญุฏูุง ุฒูุงู ุณุงุนุช ุจู ูุงููุซุงููโูุง ฺฉู ูโุฎูุงุณุชูุ ุงุณุชูุงุฏู ฺฉุฑุฏู. ูุจู ุงุฒ ุงูุฌุงู ูุฑ ฺฉุงุฑ ูพฺุฏูโุง ุจุง ุฒูุงูุ ุจู ุจุฎุดโูุง ยง5.4.1 ู ยง35.2 ูุฑุงุฌุนู ฺฉูุฏ. ูุงุจูุชโูุง ูุฑุจูุท ุจู ุฒูุงู ุฏุฑ ูุฏุฑ `<chrono>` ุงูุช ูโุดููุฏ.

ูพุดุชุจุงู ูพุงู ุจุฑุง ุงุฑุชุจุงุท ุงุฒ ุทุฑู ุฑูุฏุงุฏูุง ุฎุงุฑุฌ ุชูุณุท `condition_variable` ูุฑุงูู ุดุฏู ุงุณุช ฺฉู ุฏุฑ ูุฏุฑ `<condition_variable>` ุงูุช ูโุดูุฏ (ยง42.3.4).  
ฺฉ `condition_variable` ูฺฉุงูุฒู ุงุณุช ฺฉู ุจู ฺฉ ุฑุดุชู ุงุฌุงุฒู ูโุฏูุฏ ููุชุธุฑ ฺฉ ุฑุดุชู ุฏฺฏุฑ ุจูุงูุฏ. ุจูโุทูุฑ ุฎุงุตุ ุงู ุงูฺฉุงู ุฑุง ูโุฏูุฏ ฺฉู ฺฉ ุฑุดุชู ููุชุธุฑ ุจูุงูุฏ ุชุง ฺฉ ุดุฑุงุท ูุดุฎุต (ฺฉู ุงุบูุจ ุจู ุขู ุฑูุฏุงุฏ ฺฏูุชู ูโุดูุฏ) ุฏุฑ ูุชุฌู ฺฉุงุฑ ฺฉู ุชูุณุท ุฑุดุชูโูุง ุฏฺฏุฑ ุงูุฌุงู ุดุฏูุ ุฑุฎ ุฏูุฏ.

ูุซุงู ฺฉูุงุณฺฉ ุฏุฑ ุงู ุฒููู ุงุฑุชุจุงุท ุจู ุฏู ุฑุดุชู ุงุฒ ุทุฑู ุตู ูพุงูโูุง ุงุณุช. ุจุฑุง ุณุงุฏฺฏุ ุตู ู ูฺฉุงูุฒู ุฌููฺฏุฑ ุงุฒ ุดุฑุงุท ุฑูุงุจุช (Race Condition) ุฑุง ุจูโุตูุฑุช ุณุฑุงุณุฑ ุจุฑุง ุชููุฏฺฉููุฏู ู ูุตุฑูโฺฉููุฏู ุชุนุฑู ูโฺฉูู:

```cpp
class Message { // ุดุก ููุฑุฏ ูุธุฑ ุจุฑุง ุงุฑุณุงู
    // ...
};

queue<Message> mqueue; // ุตู ูพุงูโูุง
condition_variable mcond; // ูุชุบุฑ ุจุฑุง ุงุฑุชุจุงุท ุฑูุฏุงุฏูุง
mutex mmutex; // ูฺฉุงูุฒู ูููโฺฏุฐุงุฑ
```

ููุนโูุง `queue`ุ `condition_variable` ู `mutex` ุชูุณุท ฺฉุชุงุจุฎุงูู ุงุณุชุงูุฏุงุฑุฏ ูุฑุงูู ุดุฏูโุงูุฏ.

**ูุตุฑูโฺฉููุฏู (Consumer)** ูพุงูโูุง ุฑุง ุฎูุงูุฏู ู ูพุฑุฏุงุฒุด ูโฺฉูุฏ:

```cpp
void consumer()
{
    while(true) {
        unique_lock<mutex> lck{mmutex}; // ุฏุฑุงูุช ููู mmutex
        while (mcond.wait(lck)) /* ูฺ ฺฉุงุฑ ุงูุฌุงู ูุฏู */; // ุขุฒุงุฏุณุงุฒ ููู ู ุงูุชุธุงุฑ
        // ูพุณ ุงุฒ ุจุฏุงุฑ ุดุฏูุ ููู ูุฌุฏุฏุงู ุฏุฑุงูุช ูโุดูุฏ

        auto m = mqueue.front(); // ุฏุฑุงูุช ูพุงู
        mqueue.pop();
        lck.unlock(); // ุขุฒุงุฏุณุงุฒ ููู

        // ... ูพุฑุฏุงุฒุด ูพุงู m ...
    }
}
```

ุฏุฑ ุงูุฌุงุ ุจูโุทูุฑ ุตุฑุญ ุนููุงุช ุฑู ุตู ู `condition_variable` ุฑุง ุจุง `unique_lock` ุฑู `mutex` ูุญุงูุธุช ูโฺฉูู.  
ูุชุฏ `wait` ุฏุฑ `condition_variable`ุ ููฺฏุงู ุงูุชุธุงุฑุ ููู ุฏุงุฏูโุดุฏู ุฑุง ุขุฒุงุฏ ูโฺฉูุฏ (ุจูโุทูุฑ ฺฉู ุฏฺฏุฑ ุฑุดุชูโูุง ุจุชูุงููุฏ ุตู ุฑุง ุชุบุฑ ุฏููุฏ) ู ูพุณ ุงุฒ ุงุชูุงู ุงูุชุธุงุฑุ ูุฌุฏุฏุงู ููู ุฑุง ุฏุฑุงูุช ูโฺฉูุฏ.

**ุชููุฏฺฉููุฏู (Producer)** ุจู ุงู ุตูุฑุช ุฎูุงูุฏ ุจูุฏ:

```cpp
void producer()
{
    while(true) {
        Message m;
        // ... ูพุฑ ฺฉุฑุฏู ูพุงู ...

        unique_lock<mutex> lck {mmutex}; // ูุญุงูุธุช ุงุฒ ุนููุงุช
        mqueue.push(m);
        mcond.notify_one(); // ุงุฑุณุงู ุงุนูุงู
    } // ุขุฒุงุฏุณุงุฒ ููู ุฏุฑ ุงูุชูุง ุฏุงููู
}
```

ุงุณุชูุงุฏู ุงุฒ `condition_variable` ุฑูุดโูุง ูุชููุน ู ฺฉุงุฑุขูุฏ ุฑุง ุจุฑุง ุงุดุชุฑุงฺฉโฺฏุฐุงุฑ ุงุทูุงุนุงุช ูุฑุงูู ูโฺฉูุฏุ ุงูุง ูโุชูุงูุฏ ฺฉู ูพฺุฏู ุจุงุดุฏ (ยง42.3.4).

---

### **ุชูุถุญ ฺฉุงูู ู ุฏูู ุฏุฑุจุงุฑูโ ฺฉุฏ ู ููุงูู ูุฑุจูุทู**

---

## **ฑ. ููููู ุงูุชุธุงุฑ ุฏุฑ ุจุฑูุงููโูุง ฺูุฏูุฎ (Multithreading)**
ุฏุฑ ุจุฑูุงููโููุณ ฺูุฏูุฎุ ููฺฉู ุงุณุช ฺฉ **ุฑุดุชู (Thread)** ูุงุฒ ุฏุงุดุชู ุจุงุดุฏ ฺฉู ุจุฑุง ูููุน ฺฉ ุฑูุฏุงุฏ ุฎุงุฑุฌ ููุชุธุฑ ุจูุงูุฏ. ุงู ุฑูุฏุงุฏ ูโุชูุงูุฏ ููุงุฑุฏ ูุงููุฏ:
- ุงุชูุงู ฺฉุงุฑ ฺฉ ุฑุดุชูโ ุฏฺฏุฑ
- ุณูพุฑ ุดุฏู ฺฉ ุจุงุฒูโ ุฒูุงู ูุดุฎุต
- ุฏุฑุงูุช ุฏุงุฏู ุงุฒ ูุฑูุฏ
- ุฏุฑุงูุช ฺฉ ุณฺฏูุงู ุงุฒ ฺฉ ูพุฑุฏุงุฒุด ุฏฺฏุฑ

ุจุงุดุฏ. ุจุฑุง ูุฏุฑุช ุงู ููุน ุณูุงุฑููุงุ **ุงูุชุธุงุฑ ูุนุงู (Busy Waiting)** ฺฏุฒููโ ุฎูุจ ูุณุชุ ุฒุฑุง ุจุงุนุซ ูุตุฑู ุจููุฏูโ ูพุฑุฏุงุฒูุฏู ูโุดูุฏ. ุจูุงุจุฑุงูุ ูฺฉุงูุฒูโูุง ุจุฑุง **ูุฏุฑุช ุจูููโ ุงูุชุธุงุฑ** ุงุฑุงุฆู ุดุฏูโุงูุฏ.

---

## **ฒ. ููุชุธุฑ ูุงูุฏู ุจุฑุง ฺฏุฐุฑ ุฒูุงู ุจุง `sleep_for`**
ุฏุฑ ฺฉุฏ ุงุฑุงุฆูโุดุฏูุ ุงููู ูุซุงู ูุฑุจูุท ุจู **ุงูุชุธุงุฑ ุจุฑุง ฺฏุฐุฑ ุฒูุงู** ุงุณุช. 

```cpp
using namespace std::chrono; // ุงุณุชูุงุฏู ุงุฒ ูุงุจูุชโูุง ุฒูุงู ุฏุฑ C++ 
auto t0 = high_resolution_clock::now(); // ุฐุฎุฑูโ ุฒูุงู ูุนู
this_thread::sleep_for(milliseconds{20}); // ูุชููู ฺฉุฑุฏู ุฑุดุชู ุจุฑุง ฒฐ ููโุซุงูู
auto t1 = high_resolution_clock::now(); // ุฐุฎุฑูโ ุฒูุงู ูพุณ ุงุฒ ุชููู
cout << duration_cast<nanoseconds>(t1โt0).count() << " nanoseconds passed\n";
```

### **ุชุญูู ฺฉุฏ:**
1. `high_resolution_clock::now()` ุฒูุงู ูุนู ุฑุง ุจุง ุจุงูุงุชุฑู ุฏูุช ููฺฉู ุฐุฎุฑู ูโฺฉูุฏ.
2. `this_thread::sleep_for(milliseconds{20})` ุฑุดุชูโ ูุนู ุฑุง ุจุฑุง **ฒฐ ููโุซุงูู** ูุชููู ูโฺฉูุฏ.
3. `high_resolution_clock::now()` ุฏูุจุงุฑู ุฒูุงู ุฑุง ูพุณ ุงุฒ ุชููู ุฐุฎุฑู ูโฺฉูุฏ.
4. `duration_cast<nanoseconds>` ุงุฎุชูุงู ุฒูุงู ูุจู ู ุจุนุฏ ุฑุง ุจู **ูุงููุซุงูู** ุชุจุฏู ฺฉุฑุฏู ู ฺุงูพ ูโฺฉูุฏ.

### **ฺุฑุง ุงุฒ `this_thread::sleep_for` ุงุณุชูุงุฏู ูโฺฉููุ**
- ุงู ุชุงุจุน ุจุงุนุซ ูโุดูุฏ ุฑุดุชู ูุนู ุจุฑุง ูุฏุช ุฒูุงู ูุดุฎุต ุจู ุญุงูุช **ุงูุชุธุงุฑ ุบุฑูุนุงู (Passive Waiting)** ุจุฑูุฏุ ฺฉู ุจุงุนุซ ฺฉุงูุด ูุตุฑู ูพุฑุฏุงุฒูุฏู ูโุดูุฏ.

---

## **ณ. ููฺฏุงูโุณุงุฒ (Synchronization) ู ุงุฑุชุจุงุท ุจู ุฑุดุชูโูุง ุจุง `condition_variable`**
ุฏุฑ ฺฉ ุณูุงุฑู **ุชููุฏ ู ูุตุฑู (Producer-Consumer)**ุ ูุนูููุงู ุฏู ุฑุดุชูโ ุฌุฏุงฺฏุงูู ุฏุงุฑู:
- **ุชููุฏฺฉููุฏู (Producer):** ุฏุงุฏูโุง ุฑุง ุชููุฏ ฺฉุฑุฏู ู ุฏุฑ ฺฉ ุตู ูุฑุงุฑ ูโุฏูุฏ.
- **ูุตุฑูโฺฉููุฏู (Consumer):** ุฏุงุฏูโูุง ุฑุง ุงุฒ ุตู ุฏุฑุงูุช ฺฉุฑุฏู ู ูพุฑุฏุงุฒุด ูโฺฉูุฏ.

### **ณ.ฑ: ุชุนุฑู ุณุงุฎุชุงุฑ ุฏุงุฏูโูุง**
```cpp
class Message { // ุดุก ูพุงู ุจุฑุง ุงุฑุณุงู ุจู ุฑุดุชูโูุง
    // ...
};

queue<Message> mqueue; // ุตู ูพุงูโูุง
condition_variable mcond; // ูุชุบุฑ ุดุฑุท ุจุฑุง ููฺฏุงูโุณุงุฒ
mutex mmutex; // ูุชุบุฑ ููู ุจุฑุง ุฌููฺฏุฑ ุงุฒ ุดุฑุงุท ุฑูุงุจุช
```
- `queue<Message> mqueue`: ุตู ุจุฑุง ุฐุฎุฑูโ ูพุงูโูุง ุงุฑุณุงูโุดุฏู ุชูุณุท ุชููุฏฺฉููุฏู.
- `condition_variable mcond`: ูุชุบุฑ ุจุฑุง ฺฉูุชุฑู ุงูุชุธุงุฑ ู ุจุฏุงุฑ ฺฉุฑุฏู ุฑุดุชูโูุง.
- `mutex mmutex`: ููู ุจุฑุง ุฌููฺฏุฑ ุงุฒ ูุดฺฉูุงุช ููุฒูุงู.

---

## **ด. ูุตุฑูโฺฉููุฏู (Consumer)**
```cpp
void consumer()
{
    while(true) {
        unique_lock<mutex> lck{mmutex}; // ุฏุฑุงูุช ููู mmutex
        while (mcond.wait(lck)) /* ูฺ ฺฉุงุฑ ุงูุฌุงู ูุฏู */; // ุขุฒุงุฏุณุงุฒ ููู ู ุงูุชุธุงุฑ
        // ูพุณ ุงุฒ ุจุฏุงุฑ ุดุฏูุ ููู ูุฌุฏุฏุงู ุฏุฑุงูุช ูโุดูุฏ

        auto m = mqueue.front(); // ุฏุฑุงูุช ูพุงู
        mqueue.pop();
        lck.unlock(); // ุขุฒุงุฏุณุงุฒ ููู

        // ... ูพุฑุฏุงุฒุด ูพุงู m ...
    }
}
```

### **ูุฑุงุญู ุงุฌุฑุง `consumer()`**
1. `unique_lock<mutex> lck{mmutex};` โ **ููู mutex** ุจุฑุง ุฌููฺฏุฑ ุงุฒ ุดุฑุงุท ุฑูุงุจุช ุฏุฑ ุตู ูพุงู.
2. `mcond.wait(lck);` โ **ุงูุชุธุงุฑ ุจุฑุง ูููุน ฺฉ ุฑูุฏุงุฏ:**
   - ููู ุฑุง ุขุฒุงุฏ ูโฺฉูุฏ ุชุง ุชููุฏฺฉููุฏู ุจุชูุงูุฏ ุฏุงุฏูโุง ุฑุง ุงุถุงูู ฺฉูุฏ.
   - ููฺฏุงู ุจุฏุงุฑ ุดุฏูุ ููู ุฑุง ุฏูุจุงุฑู ุฏุฑุงูุช ูโฺฉูุฏ.
3. `auto m = mqueue.front();` โ ูพุงู ุฌูู ุตู ุฑุง ุฏุฑุงูุช ูโฺฉูุฏ.
4. `mqueue.pop();` โ ูพุงู ุฑุง ุงุฒ ุตู ุญุฐู ูโฺฉูุฏ.
5. `lck.unlock();` โ ููู ุฑุง ุขุฒุงุฏ ูโฺฉูุฏ ุชุง ุณุงุฑ ุฑุดุชูโูุง ุจุชูุงููุฏ ุตู ุฑุง ุชุบุฑ ุฏููุฏ.
6. ูพุงู ุฑุง ูพุฑุฏุงุฒุด ูโฺฉูุฏ.

### **ฺุฑุง `mcond.wait(lck)` ููู ุฑุง ุขุฒุงุฏ ูโฺฉูุฏุ**
- ููุช ุฑุดุชู ุฏุฑ ุญุงู ุงูุชุธุงุฑ ุงุณุชุ **ููู ุฑุง ุขุฒุงุฏ ูโฺฉูุฏ ุชุง ุณุงุฑ ุฑุดุชูโูุง ุจุชูุงููุฏ ุชุบุฑุงุช ุฑู ุตู ุงุนูุงู ฺฉููุฏ**.  
- ููุช ุฑูุฏุงุฏ ููุฑุฏูุธุฑ ุฑุฎ ุฏูุฏ (`notify_one()` ุงุฌุฑุง ุดูุฏ)ุ ููู ุฑุง ุฏูุจุงุฑู ุฏุฑุงูุช ูโฺฉูุฏ ู ุงุฏุงููโ ฺฉุงุฑ ุฑุง ุงูุฌุงู ูโุฏูุฏ.

---

## **ต. ุชููุฏฺฉููุฏู (Producer)**
```cpp
void producer()
{
    while(true) {
        Message m;
        // ... ูพุฑ ฺฉุฑุฏู ูพุงู ...

        unique_lock<mutex> lck {mmutex}; // ูุญุงูุธุช ุงุฒ ุนููุงุช
        mqueue.push(m);
        mcond.notify_one(); // ุงุฑุณุงู ุงุนูุงู
    } // ุขุฒุงุฏุณุงุฒ ููู ุฏุฑ ุงูุชูุง ุฏุงููู
}
```

### **ูุฑุงุญู ุงุฌุฑุง `producer()`**
1. `Message m;` โ ฺฉ ูพุงู ุฌุฏุฏ ุงุฌุงุฏ ูโฺฉูุฏ.
2. ูพุงู ุฑุง ููุฏุงุฑุฏู ูโฺฉูุฏ.
3. `unique_lock<mutex> lck {mmutex};` โ **ููู mutex** ุฑุง ุฏุฑุงูุช ูโฺฉูุฏ ุชุง ุชุบุฑุงุช ุฏุฑ ุตู ุฑุง ุงูู ูฺฏู ุฏุงุฑุฏ.
4. `mqueue.push(m);` โ ูพุงู ุฑุง ุจู ุตู ุงุถุงูู ูโฺฉูุฏ.
5. `mcond.notify_one();` โ **ุจู ฺฉ ุฑุดุชูโ ููุชุธุฑ (ูุตุฑูโฺฉููุฏู) ุงุทูุงุน ูโุฏูุฏ ฺฉู ุฏุงุฏูโุง ุฏุฑ ุตู ููุฌูุฏ ุงุณุช.**
6. ููู ุจูโุทูุฑ ุฎูุฏฺฉุงุฑ ุฏุฑ ุงูุชูุง ุจูุงฺฉ ุขุฒุงุฏ ูโุดูุฏ.

---

## **ถ. ฺุฑุง `condition_variable` ุจุฑุง ุงู ฺฉุงุฑ ููุงุณุจ ุงุณุชุ**
ุจุฏูู ุงุณุชูุงุฏู ุงุฒ `condition_variable`ุ ุฑุดุชูโ ูุตุฑูโฺฉููุฏู ุจุงุฏ ูุฑุชุจุงู ุตู ุฑุง ุจุฑุฑุณ ฺฉูุฏ (Polling)ุ ฺฉู ููุฌุจ **ุงุชูุงู ููุงุจุน ูพุฑุฏุงุฒูุฏู** ูโุดูุฏ. ุงูุง ุจุง `condition_variable`:
- **ูุตุฑูโฺฉููุฏู ููุท ููุช ฺฉู ุฏุงุฏูโุง ุฏุฑ ุตู ููุฌูุฏ ุงุณุช ุงุฒ ุฎูุงุจ ุจุฏุงุฑ ูโุดูุฏ.**
- **ูุตุฑู ุจููุฏูโ ูพุฑุฏุงุฒูุฏู ฺฉุงูุด ูโุงุจุฏ.**
- **ููุงููฺฏ ุจู ุฑุดุชูโูุง ุจูููโุชุฑ ุงูุฌุงู ูโุดูุฏ.**

---

## **ท. ูฺฉุงุช ฺฉูุฏ**
1. **`this_thread::sleep_for`** ุจุฑุง ูุชููู ฺฉุฑุฏู ฺฉ ุฑุดุชู ุจุฑุง ูุฏุช ูุดุฎุต ุงุณุชูุงุฏู ูโุดูุฏ.
2. **`condition_variable`** ูฺฉุงูุฒู ุจุฑุง ููฺฏุงูโุณุงุฒ ุจู ุฑุดุชูโูุงุณุช ฺฉู ููุชุธุฑ ูููุน ฺฉ ุฑูุฏุงุฏ ูโูุงูุฏ.
3. **`mutex`** ุงุฒ ุฏุณุชุฑุณ ููุฒูุงู ุจู ููุงุจุน ูุดุชุฑฺฉ ูุญุงูุธุช ูโฺฉูุฏ.
4. **`notify_one()`** ฺฉ ุฑุดุชูโ ููุชุธุฑ ุฑุง ุจุฏุงุฑ ูโฺฉูุฏ.
5. **`wait(lck)`** ููู ุฑุง ุขุฒุงุฏ ฺฉุฑุฏู ู ููุชุธุฑ ูโูุงูุฏ ุชุง ุฑูุฏุงุฏ ููุฑุฏูุธุฑ ุฑุฎ ุฏูุฏ.

---

## **ธ. ุฎูุงุตูโ ุนููฺฉุฑุฏ ฺฉู**
- **ุชููุฏฺฉููุฏู** ูพุงู ุฑุง ุชููุฏ ฺฉุฑุฏู ู ุฏุฑ ุตู ูุฑุงุฑ ูโุฏูุฏุ ุณูพุณ `notify_one()` ุฑุง ูุฑุงุฎูุงู ูโฺฉูุฏ.
- **ูุตุฑูโฺฉููุฏู** ุชุง ุฒูุงู ฺฉู ูพุงู ุฌุฏุฏ ุฏุฑ ุตู ูุจุงุดุฏุ ุฏุฑ **ุญุงูุช ุงูุชุธุงุฑ** ุจุงู ูโูุงูุฏ.
- ููุช **ุชููุฏฺฉููุฏู** ูพุงู ุงุฑุณุงู ฺฉูุฏุ **ูุตุฑูโฺฉููุฏู ุจุฏุงุฑ ุดุฏู** ู ูพุงู ุฑุง ูพุฑุฏุงุฒุด ูโฺฉูุฏ.
- ุงู ูุฑุงูุฏ **ุจุฏูู ูุตุฑู ุจููุฏูโ ูพุฑุฏุงุฒูุฏู** ู ุจููู ุงูุฌุงู ูโุดูุฏ.

---

### **น. ุขุง ุงู ุฑูุด ุจููู ุงุณุชุ**
ุจููุ ุงู ุฑูุด ุจููู ุงุณุชุ ุฒุฑุง:
โ **ุงูุชุธุงุฑ ูุนุงู (Busy Waiting) ูุฏุงุฑุฏ.**  
โ **ุฑุดุชูโ ูุตุฑูโฺฉููุฏู ููุท ุฏุฑ ุตูุฑุช ูุฌูุฏ ุฏุงุฏู ุจุฏุงุฑ ูโุดูุฏ.**  
โ **ุงูฺฉุงู ุงุณุชูุงุฏู ุฏุฑ ุณูุงุฑููุง ูพุดุฑูุชูโ ููฺฏุงูโุณุงุฒ ุฑุง ุฏุงุฑุฏ.**  

๐ก ุงฺฏุฑ ฺูุฏู ูุตุฑูโฺฉููุฏู ุฏุงุดุชู ุจุงุดูุ ูโุชูุงู ุงุฒ `notify_all()` ุงุณุชูุงุฏู ฺฉุฑุฏ ุชุง ูููโ ุขูโูุง ุจุฏุงุฑ ุดููุฏ.

---

### **ูุชุฌูโฺฏุฑ**
ุงู ูุซุงู ูุดุงู ูโุฏูุฏ ฺฉู ฺฺฏููู ูโุชูุงู ุจุง ุงุณุชูุงุฏู ุงุฒ `condition_variable` ู `mutex`ุ ุงุฑุชุจุงุท **ุจูููู ู ููฺฏุงู** ุจู ุฑุดุชูโูุง ุฑุง ุจุฑูุฑุงุฑ ฺฉุฑุฏ ู ุงุฒ ูุดฺฉูุงุช **ุดุฑุงุท ุฑูุงุจุช ู ูุตุฑู ุจููุฏูโ ููุงุจุน** ุฌููฺฏุฑ ฺฉุฑุฏ. ๐


---

### **`condition_variable` ุฏุฑ C++ โ ุชูุถุญ ฺฉุงูู ุจุง ูุซุงูโูุง ูุฑุงูุงู**

---
## **ฑ. `condition_variable` ฺุณุชุ**
ุฏุฑ ุจุฑูุงููโููุณ ฺูุฏูุฎ (Multithreading)ุ `condition_variable` ฺฉ ูฺฉุงูุฒู ุจุฑุง **ููฺฏุงูโุณุงุฒ (Synchronization)** ุจู ุฑุดุชูโูุง ุงุณุช. ุงู ุงูฺฉุงู ุฑุง ูโุฏูุฏ ฺฉู **ฺฉ ุง ฺูุฏ ุฑุดุชู ููุชุธุฑ ฺฉ ุฑูุฏุงุฏ ุจูุงููุฏ** ู ููุช ฺฉู ุดุฑุงุท ููุฑุฏูุธุฑ ูุฑุงูู ุดุฏุ **ุจููู ุจุฏุงุฑ ุดููุฏ**.

๐ก **ูุดฺฉู ุงุตู ุฏุฑ ฺูุฏูุฎ:**  
ููุช ฺูุฏู **ุฑุดุชู (Thread)** ุจุง ฺฉ **ููุจุน ูุดุชุฑฺฉ (Shared Resource)** ฺฉุงุฑ ูโฺฉููุฏุ ุจุงุฏ ุจูโฺฏูููโุง ูุฏุฑุช ุดููุฏ ฺฉู **ุชุฏุงุฎู ู ูุดฺฉูุงุช ููุฒูุงู (Race Condition) ุงุฌุงุฏ ูุดูุฏ**.

โ **ุฑุงูโุญู:**  
- ุงุณุชูุงุฏู ุงุฒ `mutex` ุจุฑุง **ูุญุงูุธุช ุงุฒ ููุงุจุน ูุดุชุฑฺฉ**.
- ุงุณุชูุงุฏู ุงุฒ `condition_variable` ุจุฑุง **ูุฏุฑุช ุงูุชุธุงุฑ ู ุจุฏุงุฑ ุฑุดุชูโูุง**.

---

## **ฒ. ูุญููโ ฺฉุงุฑ `condition_variable`**
### **ุณู ุจุฎุด ุงุตู `condition_variable`:**
1. **ุงูุชุธุงุฑ (`wait()`)**  
   - ุจุงุนุซ ูโุดูุฏ ฺฉู ฺฉ ุฑุดุชู **ููุชุธุฑ ฺฉ ุฑูุฏุงุฏ ุจูุงูุฏ**.
   - ุฏุฑ ุญู ุงูุชุธุงุฑุ **ููู ุฑุง ุขุฒุงุฏ ูโฺฉูุฏ ุชุง ุฑุดุชูโูุง ุฏฺฏุฑ ฺฉุงุฑ ุฎูุฏ ุฑุง ุงูุฌุงู ุฏููุฏ**.
   - ููุช ฺฉู ุจุฏุงุฑ ุดุฏุ **ุฏูุจุงุฑู ููู ุฑุง ุฏุฑุงูุช ูโฺฉูุฏ**.

2. **ุงุนูุงู (`notify_one()` ู `notify_all()`)**  
   - `notify_one()` โ **ฺฉ ุฑุดุชูโ ููุชุธุฑ ุฑุง ุจุฏุงุฑ ูโฺฉูุฏ.**
   - `notify_all()` โ **ูููโ ุฑุดุชูโูุง ููุชุธุฑ ุฑุง ุจุฏุงุฑ ูโฺฉูุฏ.**

3. **ูุญุงูุธุช (`mutex`)**  
   - `condition_variable` **ุจุฏูู `mutex` ฺฉุงุฑ ููโฺฉูุฏ**.
   - ููุดู ุจุงุฏ ุจุง `std::unique_lock<std::mutex>` ุงุณุชูุงุฏู ุดูุฏ.

---

## **ณ. ูุซุงู ุณุงุฏู: ุฏู ุฑุดุชูโ ุชููุฏฺฉููุฏู ู ูุตุฑูโฺฉููุฏู**
### **๐ ูุณุฆูู:**  
- **ฺฉ ุฑุดุชู (producer)** ุนุฏุฏ ุฑุง ุชููุฏ ูโฺฉูุฏ ู ุฏุฑ ฺฉ ูุชุบุฑ ุฐุฎุฑู ูโฺฉูุฏ.
- **ฺฉ ุฑุดุชูโ ุฏฺฏุฑ (consumer)** ุจุงุฏ ููุชุธุฑ ุจูุงูุฏ ุชุง ุฏุงุฏูโ ุฌุฏุฏ ุขูุงุฏู ุดูุฏ.

### **๐ ฺฉุฏ ฺฉุงูู**
```cpp
#include <iostream>
#include <thread>
#include <mutex>
#include <condition_variable>

using namespace std;

mutex mtx;  // ููู ุจุฑุง ุญูุงุธุช ุงุฒ ููุจุน ูุดุชุฑฺฉ
condition_variable cv;  // ูุชุบุฑ ุดุฑุท ุจุฑุง ููฺฏุงูโุณุงุฒ
int data = 0;  // ุฏุงุฏูโ ูุดุชุฑฺฉ
bool ready = false;  // ูุถุนุช ุฏุงุฏู

void consumer() {
    unique_lock<mutex> lock(mtx);  // ุฏุฑุงูุช ููู
    cout << "Consumer waiting...\n";
    
    cv.wait(lock, [] { return ready; });  // ููุชุธุฑ ุจูุงู ุชุง ready ุดูุฏ

    cout << "Consumer received data: " << data << endl;
    ready = false;  // ุฏุงุฏู ูุตุฑู ุดุฏ
}

void producer() {
    this_thread::sleep_for(chrono::seconds(1));  // ุดุจูโุณุงุฒ ุชุงุฎุฑ

    unique_lock<mutex> lock(mtx);  // ุฏุฑุงูุช ููู
    data = 100;  // ููุฏุงุฑุฏู ุฏุงุฏู
    ready = true;
    
    cout << "Producer produced data: " << data << endl;
    cv.notify_one();  // ุจุฏุงุฑ ฺฉุฑุฏู ฺฉ ูุตุฑูโฺฉููุฏู
}

int main() {
    thread t1(consumer);
    thread t2(producer);

    t1.join();
    t2.join();

    return 0;
}
```

---

### **ด. ุชุญูู ุฏูู ุงู ูุซุงู**
#### **๐ ูุฑุงุญู ุงุฌุฑุง:**
1. **ูุตุฑูโฺฉููุฏู (consumer)**:
   - ุงุจุชุฏุง **ููู `mutex` ุฑุง ุฏุฑุงูุช ูโฺฉูุฏ**.
   - ุณูพุณ **ุจุง `cv.wait()` ููุชุธุฑ ูโูุงูุฏ** ุชุง `ready == true` ุดูุฏ.
   - ุฏุฑ ุงู ูุฏุชุ **ููู ุฑุง ุขุฒุงุฏ ูโฺฉูุฏ** ุชุง ุชููุฏฺฉููุฏู ุจุชูุงูุฏ ฺฉุงุฑุด ุฑุง ุงูุฌุงู ุฏูุฏ.
   - ููุช ฺฉู `ready` ููุฏุงุฑ `true` ฺฏุฑูุชุ **ุจุฏุงุฑ ุดุฏู ู ุฏุงุฏู ุฑุง ูพุฑุฏุงุฒุด ูโฺฉูุฏ**.

2. **ุชููุฏฺฉููุฏู (producer)**:
   - ุจุนุฏ ุงุฒ ฑ ุซุงูู ุชุฃุฎุฑุ **ููู `mutex` ุฑุง ุฏุฑุงูุช ูโฺฉูุฏ**.
   - ููุฏุงุฑ `data` ุฑุง ุจุฑุงุจุฑ `100` ูุฑุงุฑ ุฏุงุฏู ู `ready` ุฑุง `true` ูโฺฉูุฏ.
   - **ฺฉ ุฑุดุชูโ ููุชุธุฑ ุฑุง ุจุฏุงุฑ ูโฺฉูุฏ** (`cv.notify_one();`).

โ **ูุชุฌู:** ูุตุฑูโฺฉููุฏู ุจุฏูู ูุตุฑู ุจููุฏูโ ูพุฑุฏุงุฒูุฏูุ **ููุชุธุฑ ุฏุงุฏู ูโูุงูุฏ** ู ููุท ููุช ฺฉู `producer` ุฏุงุฏู ุฑุง ุชููุฏ ฺฉูุฏุ ุจุฏุงุฑ ูโุดูุฏ.

---

## **ต. ูุซุงู `notify_all()`: ุจุฏุงุฑ ฺฉุฑุฏู ฺูุฏู ูุตุฑูโฺฉููุฏู**
ุงฺฏุฑ ฺูุฏู ุฑุดุชูโ ูุตุฑูโฺฉููุฏู ุฏุงุดุชู ุจุงุดูุ ุงุฒ `notify_all()` ุงุณุชูุงุฏู ูโฺฉูู.

### **๐ ฺฉุฏ: ฺูุฏ ูุตุฑูโฺฉููุฏู ู ฺฉ ุชููุฏฺฉููุฏู**
```cpp
#include <iostream>
#include <thread>
#include <mutex>
#include <condition_variable>
#include <vector>

using namespace std;

mutex mtx;
condition_variable cv;
int data = 0;
bool ready = false;

void consumer(int id) {
    unique_lock<mutex> lock(mtx);
    cv.wait(lock, [] { return ready; });  // ุงูุชุธุงุฑ ุจุฑุง ุฏุงุฏู

    cout << "Consumer " << id << " received data: " << data << endl;
}

void producer() {
    this_thread::sleep_for(chrono::seconds(1));

    unique_lock<mutex> lock(mtx);
    data = 42;
    ready = true;
    
    cout << "Producer produced data: " << data << endl;
    cv.notify_all();  // ุจุฏุงุฑ ฺฉุฑุฏู ุชูุงู ูุตุฑูโฺฉููุฏูโูุง
}

int main() {
    vector<thread> consumers;
    for (int i = 1; i <= 3; ++i)
        consumers.emplace_back(consumer, i);

    thread t1(producer);

    for (auto &t : consumers) t.join();
    t1.join();

    return 0;
}
```

---

### **ถ. `condition_variable` ุฏุฑ ููุงุจู `sleep_for`**
ุงฺฏุฑ `condition_variable` ุฑุง ุญุฐู ฺฉูู ู ููุท ุงุฒ `sleep_for` ุงุณุชูุงุฏู ฺฉููุ **ฺฉุงุฑุง ุจู ุดุฏุช ฺฉุงูุด ูโุงุจุฏ** ุฒุฑุง:
- ูุตุฑูโฺฉููุฏูโูุง **ุจููุฏู ุฏุฑ ฺฉ ุญููู ฺฺฉ ูโฺฉููุฏ** ฺฉู ุขุง ุฏุงุฏู ุขูุฏู ุงุณุช ุง ูู.
- ูพุฑุฏุงุฒูุฏู **ูุฏุงู ุฏุฑฺฏุฑ ูพุฑุฏุงุฒุด ุบุฑุถุฑูุฑ ูโุดูุฏ**.
- ุฏุฑ ุญุงูุช ฺูุฏ ูุตุฑูโฺฉููุฏูุ ูพุฑุฏุงุฒุด **ุบุฑ ุจููู ู ฺฉูุฏ** ุฎูุงูุฏ ุจูุฏ.

๐ **`condition_variable` ุจุงุนุซ ูโุดูุฏ ูุตุฑูโฺฉููุฏู ููุท ููุช ฺฉู ูุงุฒู ุงุณุชุ ุจุฏุงุฑ ุดูุฏ.**

---

### **ท. ุฌูุนโุจูุฏ ู ูฺฉุงุช ููู**
โ **`condition_variable` ุจุงุนุซ ูุฏุฑุช ฺฉุงุฑุขูุฏ ุงูุชุธุงุฑ ู ุจุฏุงุฑ ุฏุฑ ุจุฑูุงููโูุง ฺูุฏูุฎ ูโุดูุฏ.**  
โ **`wait()`** ููุชุธุฑ ฺฉ ุฑูุฏุงุฏ ูโูุงูุฏุ ุฏุฑุญุงูโฺฉู ููู ุฑุง ุขุฒุงุฏ ูโฺฉูุฏ.  
โ **`notify_one()`** ฺฉ ุฑุดุชูโ ููุชุธุฑ ุฑุง ุจุฏุงุฑ ูโฺฉูุฏ.  
โ **`notify_all()`** ูููโ ุฑุดุชูโูุง ููุชุธุฑ ุฑุง ุจุฏุงุฑ ูโฺฉูุฏ.  
โ **ููุดู ุจุงุฏ `condition_variable` ุฑุง ุจุง `mutex` ุงุณุชูุงุฏู ฺฉูู.**  

---

### **ธ. ฺู ุฒูุงู ุงุฒ `condition_variable` ุงุณุชูุงุฏู ฺฉููุ**
โ ุฒูุงู ฺฉู ฺฉ ุง ฺูุฏ **ุฑุดุชู ุจุงุฏ ููุชุธุฑ ฺฉ ุดุฑุท ุฎุงุต ุจูุงููุฏ**.  
โ ุฒูุงู ฺฉู **ูุจุงุฏ ูพุฑุฏุงุฒูุฏู ุฑุง ุจููุฏู ูุตุฑู ฺฉูู**.  
โ ุฏุฑ ุณูุงุฑููุง **ุงุฑุชุจุงุท ุจู ุชููุฏฺฉููุฏู ู ูุตุฑูโฺฉููุฏู**.  
โ ุฏุฑ **ุจุฑูุงููโูุง ุจูุงุฏุฑูฺฏ (Real-time)** ุจุฑุง ุจูููโุณุงุฒ ูพุฑุฏุงุฒุดโูุง ููุฒูุงู.

๐ **`condition_variable` ฺฉ ุงุฒ ูููโุชุฑู ุงุจุฒุงุฑูุง ููฺฏุงูโุณุงุฒ ุฏุฑ C++ ุงุณุช ฺฉู ฺฉุงุฑุง ุจุฑูุงููโูุง ฺูุฏูุฎ ุฑุง ุจูุจูุฏ ูโุฏูุฏ!**

## Communicating Tasks
ฺฉุชุงุจุฎุงูู ุงุณุชุงูุฏุงุฑุฏ ฺูุฏ ูุงุจูุช ุฑุง ูุฑุงูู ูโฺฉูุฏ ฺฉู ุจู ุจุฑูุงููโููุณุงู ุงูฺฉุงู ูโุฏูุฏ ุชุง ุฏุฑ ุณุทุญ ููููู ูุธุงู (ฺฉุงุฑ ฺฉู ูโุชูุงูุฏ ุจูโุทูุฑ ููุฒูุงู ุงูุฌุงู ุดูุฏ) ฺฉุงุฑ ฺฉููุฏุ ุจูโุฌุง ุงูฺฉู ูุณุชููุงู ุฏุฑ ุณุทุญ ูพุงูโุชุฑ ุจุง ูุฎโูุง (threads) ู ูููโูุง (locks) ุณุฑูฺฉุงุฑ ุฏุงุดุชู ุจุงุดูุฏ:

1. **future** ู **promise** ุจุฑุง ุจุงุฒฺฏุฑุฏุงูุฏู ฺฉ ููุฏุงุฑ ุงุฒ ฺฉ ูุธููโุง ฺฉู ุฑู ฺฉ ูุฎ ุฌุฏุงฺฏุงูู ุงุฌุฑุง ุดุฏู ุงุณุช.  
2. **packaged_task** ุจุฑุง ฺฉูฺฉ ุจู ุงุฌุฑุง ูุธุงู ู ุงุชุตุงู ูฺฉุงูุฒูโูุง ูุฑุจูุท ุจู ุจุงุฒฺฏุฑุฏุงูุฏู ูุชุฌู.  
3. **async()** ุจุฑุง ุงุฌุฑุง ฺฉ ูุธูู ุจู ุฑูุด ุจุณุงุฑ ูุดุงุจู ุจุง ูุฑุงุฎูุงู ฺฉ ุชุงุจุน.  

ุงู ูุงุจูุชโูุง ุฏุฑ **<future>** ูุฑุงุฑ ุฏุงุฑูุฏ.

## future and promise
ูฺฉุชู ููู ุฏุฑุจุงุฑู **future** ู **promise** ุงู ุงุณุช ฺฉู ุขูโูุง ุงูฺฉุงู ุงูุชูุงู ฺฉ ููุฏุงุฑ ุจู ุฏู ูุธูู ุฑุง ุจุฏูู ูุงุฒ ุจู ุงุณุชูุงุฏู ุตุฑุญ ุงุฒ ฺฉ ููู ูุฑุงูู ูโฺฉููุฏุ ุจูโุนุจุงุฑุช ุฏฺฏุฑุ **ยซุณุณุชูยป** ุงู ุงูุชูุงู ุฑุง ุจูโุตูุฑุช ฺฉุงุฑุขูุฏ ูพุงุฏูโุณุงุฒ ูโฺฉูุฏ.  

ุงุฏูโ ุงุตู ุณุงุฏู ุงุณุช: ุฒูุงู ฺฉู ฺฉ ูุธูู ูโุฎูุงูุฏ ููุฏุงุฑ ุฑุง ุจู ูุธููโ ุฏฺฏุฑ ููุชูู ฺฉูุฏุ ุขู ููุฏุงุฑ ุฑุง ุฏุฑ ฺฉ **promise** ูุฑุงุฑ ูโุฏูุฏ. ุจู ููุนุ ูพุงุฏูโุณุงุฒ ุงู ูฺฉุงูุฒู ุจุงุนุซ ูโุดูุฏ ฺฉู ููุฏุงุฑ ุฏุฑ **future** ูุชูุงุธุฑ ุธุงูุฑ ุดูุฏ ู ุงุฒ ุขูุฌุง ูุงุจู ุฎูุงูุฏู ุจุงุดุฏ (ูุนูููุงู ุชูุณุท ูุธููโุง ฺฉู ุขู ุฑุง ุงุฌุฑุง ฺฉุฑุฏู ุงุณุช).  

ูุง ูโุชูุงูู ุงู ููููู ุฑุง ุจูโุตูุฑุช ฺฏุฑุงูฺฉ ููุงุด ุฏูู:

![](../image/5/5.1.png)

ุงฺฏุฑ ฺฉ **future<X>** ุจู ูุงู **fx** ุฏุงุดุชู ุจุงุดูุ ูโุชูุงูู ููุฏุงุฑ ููุน **X** ุฑุง ุงุฒ ุขู ุฏุฑุงูุช ฺฉูู:

```cpp
X v = fx.get(); // ุฏุฑ ุตูุฑุช ูุฒููุ ููุชุธุฑ ูโูุงูู ุชุง ููุฏุงุฑ ูุญุงุณุจู ุดูุฏ
```

ุงฺฏุฑ ููุฏุงุฑ ูููุฒ ุขูุงุฏู ูุจุงุดุฏุ ูุฎ (thread) ูุง ุชุง ุฒูุงู ฺฉู ููุฏุงุฑ ุจุฑุณุฏุ ูุณุฏูุฏ (blocked) ูโุดูุฏ. ุงฺฏุฑ ููุฏุงุฑ ูุงุจู ูุญุงุณุจู ูุจุงุดุฏุ **get()** ููฺฉู ุงุณุช ฺฉ ุงุณุชุซูุง (exception) ูพุฑุชุงุจ ฺฉูุฏ (ุงู ุงุณุชุซูุง ููฺฉู ุงุณุช ุงุฒ ุณุณุชู ุจุงุดุฏ ุง ุงุฒ ูุธููโุง ฺฉู ุณุน ุฏุงุดุชู ููุฏุงุฑ ุฑุง ุงุฒ ุขู ุจฺฏุฑู ููุชูู ุดุฏู ุจุงุดุฏ).

ูุฏู ุงุตู **promise** ุงู ุงุณุช ฺฉู ุนููุงุช ุณุงุฏูโ ยซูุฑุงุฑ ุฏุงุฏูยป ููุฏุงุฑ ุฑุง ูุฑุงูู ฺฉูุฏ (ุงู ุนููุงุชโูุง **set_value()** ู **set_exception()** ูุงู ุฏุงุฑูุฏ) ุชุง ุจุง **get()** ุงุฒ **future** ูุทุงุจูุช ุฏุงุดุชู ุจุงุดุฏ.  

ูุงูโูุง **future** ู **promise** ุชุงุฑุฎ ูุณุชูุฏุ ูุทูุงู ูุฑุง ุณุฑุฒูุด ูฺฉูุฏ! ุงู ูุงูโูุง ููุจุน ุบู ุจุฑุง ุจุงุฒ ุจุง ฺฉููุงุช ูุณุชูุฏ.

ุงฺฏุฑ ฺฉ **promise** ุฏุงุดุชู ุจุงุดุฏ ู ูุงุฒ ุจู ุงุฑุณุงู ฺฉ ูุชุฌู ุงุฒ ููุน **X** ุจู ฺฉ **future** ุฏุงุดุชู ุจุงุดุฏุ ูโุชูุงูุฏ ุจู ุฏู ุฑูุด ุงู ฺฉุงุฑ ุฑุง ุงูุฌุงู ุฏูุฏ:  

1. ููุฏุงุฑ ุฑุง ุงุฑุณุงู ฺฉูุฏ.  
2. ฺฉ ุงุณุชุซูุง ุฑุง ุงุฑุณุงู ฺฉูุฏ.  

ุจูโุนููุงู ูุซุงู:

```cpp
void f(promise<X>& px) // ฺฉ ูุธูู: ูุฑุงุฑ ุฏุงุฏู ูุชุฌู ุฏุฑ px
{
    try {
        X res;
        // ... ููุฏุงุฑ res ุฑุง ูุญุงุณุจู ฺฉูุฏ ...
        px.set_value(res);
    }
    catch (...) { // ูุดฺฉู: ููุฏุงุฑ res ูุญุงุณุจู ูุดุฏ
        // ุงุณุชุซูุง ุฑุง ุจู ูุฎ future ููุชูู ฺฉูุฏ:
        px.set_exception(current_exception());
    }
}
```

**current_exception()** ุจู ุงุณุชุซูุง ฺฏุฑูุชูโุดุฏู ุงุดุงุฑู ุฏุงุฑุฏ (ยง30.4.1.2).  

ุจุฑุง ูพุฑุฏุงุฒุด ุงุณุชุซูุง ฺฉู ุงุฒ ุทุฑู **future** ููุชูู ุดุฏู ุงุณุชุ ุชุงุจุน ฺฉู **get()** ุฑุง ุตุฏุง ูโุฒูุฏ ุจุงุฏ ุขูุงุฏูโ ฺฏุฑูุชู ุขู ุฏุฑ ุฌุง ุจุงุดุฏ. ุจูโุนููุงู ูุซุงู:

```cpp
void g(future<X>& fx) // ฺฉ ูุธูู: ุฏุฑุงูุช ูุชุฌู ุงุฒ fx
{
    try {
        X v = fx.get(); // ุฏุฑ ุตูุฑุช ูุฒููุ ููุชุธุฑ ูโูุงูู ุชุง ููุฏุงุฑ ูุญุงุณุจู ุดูุฏ
        // ... ุงุณุชูุงุฏู ุงุฒ v ...
    }
    catch (...) { // ูุดฺฉู: ฺฉุณ ูุชูุงูุณุช v ุฑุง ูุญุงุณุจู ฺฉูุฏ
        // ... ูุฏุฑุช ุฎุทุง ...
    }
}
```

---

### **ุชูุถุญ ฺฉุงูู future ู promise ุฏุฑ C++**

ุฏุฑ ุจุฑูุงููโููุณ ููุฑููุฏ (concurrent programming)ุ ูุฏุฑุช ุฏุงุฏูโูุง ุจู ฺูุฏู **ูุฎ (thread)** ฺฉ ุงุฒ ฺุงูุดโูุง ุงุณุงุณ ุงุณุช. ุฏุฑ ุจุณุงุฑ ุงุฒ ููุงูุนุ ูุงุฒ ุฏุงุฑู ุฏุงุฏูโุง ุฑุง ุงุฒ ฺฉ ูุธูู (task) ุจู ูุธููโ ุฏฺฏุฑ ููุชูู ฺฉูู. ูุนูููุงู ุงู ฺฉุงุฑ ุจุง **ูููโูุง (locks)** ุงูุฌุงู ูโุดูุฏุ ุงูุง ุงุณุชูุงุฏูโ ูุณุชูู ุงุฒ ูููโูุง ููฺฉู ุงุณุช ุจุงุนุซ ูุดฺฉูุงุช ูุงููุฏ **ุจูโุจุณุช (deadlock)**ุ **ุดุฑุงุท ุฑูุงุจุช (race conditions)** ู **ุงูุช ุนููฺฉุฑุฏ** ุดูุฏ.

C++ ุจุฑุง ุญู ุงู ูุดฺฉู **future** ู **promise** ุฑุง ุฏุฑ ฺฉุชุงุจุฎุงููโ **`<future>`** ุงุฑุงุฆู ฺฉุฑุฏู ุงุณุช ฺฉู ุจุฏูู ูุงุฒ ุจู ุงุณุชูุงุฏูโ ุตุฑุญ ุงุฒ **ูููโูุง**ุ ุงูฺฉุงู ุงูุชูุงู ุฏุงุฏูโูุง ุจู **ุฏู ูุธููโ ููุฒูุงู** ุฑุง ูุฑุงูู ูโฺฉููุฏ.  

---

## **1. ููููู future ู promise**

### **Promise ฺุณุชุ**
**`promise<T>`** ูุณููโุง ุงุณุช ฺฉู ุจู ุดูุง ุงุฌุงุฒู ูโุฏูุฏ ฺฉ ููุฏุงุฑ **T** ุฑุง ุฏุฑ ุขูุฏู ุชูุธู ฺฉูุฏ. ุงู ููุฏุงุฑ ููฺฉู ุงุณุช ฺฉ ููุฏุงุฑ ุนุงุฏ ุจุงุดุฏ ุง ฺฉ **ุงุณุชุซูุง (exception)**.

### **Future ฺุณุชุ**
**`future<T>`** ูุณููโุง ุจุฑุง ุฏุฑุงูุช ููุฏุงุฑ **T** ุฏุฑ ุขูุฏู ุงุณุช. ุงู ููุฏุงุฑ ููุงู ููุฏุงุฑ ุงุณุช ฺฉู ฺฉ **promise** ุฏุฑ ูุฎ ุฏฺฏุฑ ุขู ุฑุง ุชูุธู ฺฉุฑุฏู ุงุณุช.

### **ุงุฑุชุจุงุท ุจู Future ู Promise**
ููุช ุฏุงุฏูโุง ุฑุง ุฏุฑ ฺฉ **promise** ูุฑุงุฑ ูโุฏููุ **ุณุณุชู** ุจู ุทูุฑ ุฎูุฏฺฉุงุฑ ุงู ููุฏุงุฑ ุฑุง ุฏุฑ **future** ูุชูุงุธุฑ ููุงุงู ูโฺฉูุฏ. ุงู ฺฉุงุฑ ุจูโุตูุฑุช ฺฉุงุฑุขูุฏ ุงูุฌุงู ูโุดูุฏ ู ูุงุฒ ุจู **ููู ุฏุณุช** ูุฏุงุฑุฏ.

---

## **2. ูุญูู ุงุณุชูุงุฏู ุงุฒ future ู promise**
### **ุฎูุงูุฏู ููุฏุงุฑ ุงุฒ ฺฉ future**
ุงฺฏุฑ ฺฉ **future** ุงุฒ ููุน **X** ุฏุงุดุชู ุจุงุดูุ ูโุชูุงูู ููุฏุงุฑ ุขู ุฑุง ุจุง `get()` ุฏุฑุงูุช ฺฉูู:

```cpp
X v = fx.get(); // ุฏุฑ ุตูุฑุช ูุฒููุ ููุชุธุฑ ูโูุงูู ุชุง ููุฏุงุฑ ูุญุงุณุจู ุดูุฏ
```

### **ูุญูู ุนููฺฉุฑุฏ `get()`**
1. ุงฺฏุฑ ููุฏุงุฑ ุขูุงุฏู ุจุงุดุฏุ ุจูุงูุงุตูู ููุฏุงุฑ ุฑุง ุจุฑูโฺฏุฑุฏุงูุฏ.
2. ุงฺฏุฑ ููุฏุงุฑ ูููุฒ ุขูุงุฏู ูุจุงุดุฏุ **ูุฎ ูุณุฏูุฏ (blocked)** ูโุดูุฏ ุชุง ุฒูุงู ฺฉู ููุฏุงุฑ ุจุฑุณุฏ.
3. ุงฺฏุฑ ููุฏุงุฑ ุจู ูุฑ ุฏูู ูุงุจู ูุญุงุณุจู ูุจุงุดุฏุ `get()` ููฺฉู ุงุณุช **ฺฉ ุงุณุชุซูุง ูพุฑุชุงุจ ฺฉูุฏ**.

---

## **3. ูุฑุงุฑ ุฏุงุฏู ููุฏุงุฑ ุฏุฑ promise**
ูุฏู ุงุตู **promise** ุงู ุงุณุช ฺฉู ุงูฺฉุงู ูุฑุงุฑ ุฏุงุฏู ููุฏุงุฑ ุฑุง ูุฑุงูู ฺฉูุฏ. ุจุฑุง ุงูุฌุงู ุงู ฺฉุงุฑุ ุงุฒ ุฏู ูุชุฏ ุงุณุชูุงุฏู ูโฺฉูู:

1. **`set_value()`** โ ููุฏุงุฑ ููุง ุฑุง ุฏุฑ promise ูุฑุงุฑ ูโุฏูุฏ.
2. **`set_exception()`** โ ฺฉ ุงุณุชุซูุง ุฑุง ุฏุฑ promise ูุฑุงุฑ ูโุฏูุฏ.

---

## **4. ูุซุงู ุนูู: ุงุฑุณุงู ููุฏุงุฑ ุงุฒ promise ุจู future**
ูุฑุถ ฺฉูุฏ ูโุฎูุงูู ููุฏุงุฑ ฺฉ ูุชุบุฑ ุงุฒ ููุน **X** ุฑุง ุงุฒ ฺฉ ูุฎ ุจู ูุฎ ุฏฺฏุฑ ููุชูู ฺฉูู:

### **ูุธููโุง ฺฉู ููุฏุงุฑ ุฑุง ุชููุฏ ู ุฏุฑ `promise` ูุฑุงุฑ ูโุฏูุฏ**
```cpp
void f(std::promise<X>& px) // ฺฉ ูุธูู: ูุฑุงุฑ ุฏุงุฏู ูุชุฌู ุฏุฑ px
{
    try {
        X res;
        // ... ููุฏุงุฑ res ุฑุง ูุญุงุณุจู ฺฉูุฏ ...
        px.set_value(res); // ููุฏุงุฑ ุฑุง ุฏุฑ promise ูุฑุงุฑ ูโุฏูู
    }
    catch (...) { // ุฎุทุง: ููุฏุงุฑ res ูุญุงุณุจู ูุดุฏ
        px.set_exception(std::current_exception()); // ุงุณุชุซูุง ุฑุง ุจู future ุงุฑุณุงู ูโฺฉูู
    }
}
```

๐น **ฺฉุงุฑ ฺฉู ุงู ุชุงุจุน ุงูุฌุงู ูโุฏูุฏ:**
- ููุฏุงุฑ **`res`** ุฑุง ูุญุงุณุจู ูโฺฉูุฏ.
- ุงฺฏุฑ ูุญุงุณุจู ููููุชโุขูุฒ ุจูุฏุ ููุฏุงุฑ ุฑุง ุฏุฑ **promise** ูุฑุงุฑ ูโุฏูุฏ.
- ุงฺฏุฑ ุฎุทุง ุฑุฎ ุฏูุฏุ **ุงุณุชุซูุง** ุฑุง ุฏุฑ **promise** ุฐุฎุฑู ูโฺฉูุฏ.

---

### **ูุธููโุง ฺฉู ููุฏุงุฑ ุฑุง ุงุฒ `future` ุฏุฑุงูุช ูโฺฉูุฏ**
```cpp
void g(std::future<X>& fx) // ฺฉ ูุธูู: ุฏุฑุงูุช ูุชุฌู ุงุฒ fx
{
    try {
        X v = fx.get(); // ุงฺฏุฑ ููุฏุงุฑ ุขูุงุฏู ูุจูุฏุ ููุชุธุฑ ูโูุงูู
        // ... ุงุฒ v ุงุณุชูุงุฏู ฺฉูุฏ ...
    }
    catch (...) { // ุฎุทุง: ฺฉุณ ูุชูุงูุณุช v ุฑุง ูุญุงุณุจู ฺฉูุฏ
        // ... ูุฏุฑุช ุฎุทุง ...
    }
}
```

๐น **ฺฉุงุฑ ฺฉู ุงู ุชุงุจุน ุงูุฌุงู ูโุฏูุฏ:**
- ููุฏุงุฑ ุฑุง ุงุฒ **future** ูโุฎูุงูุฏ.
- ุงฺฏุฑ ููุฏุงุฑ ุขูุงุฏู ูุจุงุดุฏุ ูุฎ ุฑุง ูุณุฏูุฏ ูโฺฉูุฏ ุชุง ููุฏุงุฑ ุจุฑุณุฏ.
- ุงฺฏุฑ **promise** ุงุณุชุซูุง ุงุฑุณุงู ฺฉุฑุฏู ุจุงุดุฏุ ุขู ุฑุง ูโฺฏุฑุฏ ู ูุฏุฑุช ูโฺฉูุฏ.

---

## **5. ุจุฑุฑุณ ุฏูู ุงุณุชุซูุงูุง ู `current_exception()`**
ฺฏุงู ุงููุงุช ููุฏุงุฑ ูุงุจู ูุญุงุณุจู ูุณุช ู **ฺฉ ุงุณุชุซูุง ุฑุฎ ูโุฏูุฏ**. ุฏุฑ ฺูู ุดุฑุงุทุ ูโุชูุงู **ุงุณุชุซูุง ุฑุง ูุฒ ุงุฒ ุทุฑู promise ุจู future ููุชูู ฺฉุฑุฏ**.

### **ุงุฑุณุงู ุงุณุชุซูุง**
```cpp
catch (...) { 
    px.set_exception(std::current_exception()); // ุงุณุชุซูุง ุฑุง ุจู future ููุชูู ฺฉู
}
```

### **ุฏุฑุงูุช ู ูุฏุฑุช ุงุณุชุซูุง**
```cpp
catch (...) { 
    // ูุฏุฑุช ุฎุทุง
}
```
**`current_exception()`** ุจู **ุขุฎุฑู ุงุณุชุซูุง ุฑุฎ ุฏุงุฏู ุฏุฑ ุจููฺฉ `try-catch`** ุงุดุงุฑู ุฏุงุฑุฏ.

---

## **6. ุชูุงูุช `future` ู `promise` ุจุง `thread` ู `mutex`**
๐น **`std::thread`** โ ุจุฑุง ุงุฌุฑุง ุชูุงุจุน ุฏุฑ ูุฎโูุง ุฌุฏุฏ ุงุณุชูุงุฏู ูโุดูุฏุ ุงูุง ูุฏุฑุช ุฏุงุฏูโูุง ุฑุง ุจุฑ ุนูุฏู ูุฏุงุฑุฏ.  
๐น **`std::mutex`** โ ุจุฑุง ูุฏุฑุช ููุฒูุงู ู ุฌููฺฏุฑ ุงุฒ ุชุฏุงุฎู ุฏุงุฏูโูุง ุงุณุชูุงุฏู ูโุดูุฏ.  
๐น **`std::promise` ู `std::future`** โ ุจุฑุง ุงูุชูุงู ุฏุงุฏูโูุง ุจู ูุฎโูุง ุจู **ุฑูุด ุงูู ู ฺฉุงุฑุขูุฏ ุจุฏูู ูุงุฒ ุจู ููู ุฏุณุช** ุทุฑุงุญ ุดุฏูโุงูุฏ.

---

## **7. ูุชุฌูโฺฏุฑ**
- **future ู promise** ุงูฺฉุงู ุงูุชูุงู ุฏุงุฏูโูุง ุฑุง ุจู **ุฏู ูุธููโ ููุฒูุงู** ุจุฏูู ูุงุฒ ุจู **ูููโูุง** ูุฑุงูู ูโฺฉููุฏ.
- **promise** ููุฏุงุฑ ุง ุงุณุชุซูุง ุฑุง ุฐุฎุฑู ูโฺฉูุฏ.
- **future** ููุฏุงุฑ ุฑุง ุฏุฑุงูุช ูโฺฉูุฏ ู ุงฺฏุฑ ููุฏุงุฑ ุขูุงุฏู ูุจุงุดุฏุ ูุฎ ุฑุง ุชุง ุฏุฑุงูุช ููุฏุงุฑ ูุณุฏูุฏ ูโฺฉูุฏ.
- **`get()`** ุง ููุฏุงุฑ ุฑุง ุจุงุฒูโฺฏุฑุฏุงูุฏ ุง ฺฉ ุงุณุชุซูุง ูพุฑุชุงุจ ูโฺฉูุฏ.
- **`set_value()`** ููุฏุงุฑ ุฑุง ุฏุฑ promise ุชูุธู ูโฺฉูุฏ.
- **`set_exception()`** ฺฉ ุงุณุชุซูุง ุฑุง ุจู future ุงุฑุณุงู ูโฺฉูุฏ.
- ุงู ูฺฉุงูุณู ุจู **ุจูุจูุฏ ุนููฺฉุฑุฏ ู ุฌููฺฏุฑ ุงุฒ ูุดฺฉูุงุช ููุฒูุงู** ฺฉูฺฉ ูโฺฉูุฏ.

---

**ูุซุงู ฺฉู: ุชุฑฺฉุจ promise ู future ุจุง ูุฎ (thread)**

```cpp
#include <iostream>
#include <future>
#include <thread>

void compute(std::promise<int>& px) {
    try {
        int res = 42;  // ููุฏุงุฑ ุชููุฏ ฺฉู
        px.set_value(res);  // ููุฏุงุฑ ุฑุง ุฏุฑ promise ุฐุฎุฑู ฺฉู
    } catch (...) {
        px.set_exception(std::current_exception()); // ุงฺฏุฑ ุฎุทุง ุฑุฎ ุฏุงุฏุ ุขู ุฑุง ุงุฑุณุงู ฺฉู
    }
}

int main() {
    std::promise<int> px;
    std::future<int> fx = px.get_future();

    std::thread t(compute, std::ref(px)); // ุงุฌุฑุง ุชุงุจุน ุฏุฑ ฺฉ ูุฎ ุฌุฏุงฺฏุงูู

    try {
        int value = fx.get(); // ููุฏุงุฑ ุฑุง ุฏุฑุงูุช ฺฉู
        std::cout << "Result: " << value << std::endl;
    } catch (...) {
        std::cout << "Error: Exception occurred!" << std::endl;
    }

    t.join(); // ููุชุธุฑ ุงุชูุงู ูุฎ ุจูุงู
    return 0;
}
```
โ **ุชูุถุญ:**  
- `promise<int>` ููุฏุงุฑ ุฑุง ุฏุฑ ฺฉ ูุฎ ุชูุธู ูโฺฉูุฏ.  
- `future<int>` ููุฏุงุฑ ุฑุง ุฏุฑ ูุฎ ุงุตู ุฏุฑุงูุช ูโฺฉูุฏ.  
- `std::thread` ูุธููโ ูพุฑุฏุงุฒุด ููุฏุงุฑ ุฑุง ุงุฌุฑุง ูโฺฉูุฏ.  
- `get()` ููุฏุงุฑ ุฑุง ุฎูุงูุฏู ู ุงฺฏุฑ ุขูุงุฏู ูุจูุฏุ ููุชุธุฑ ูโูุงูุฏ.  

ุจุง ุงู ุฑูุดุ ูโุชูุงู ุจู **ุจุฑูุงููโููุณ ููุฑููุฏ ุงูู ู ฺฉุงุฑุขูุฏ** ุฏุณุช ุงูุช. ๐

## packaged_task
ฺุทูุฑ ูโุชูุงูู ฺฉ **future** ุฑุง ุจู ูุธููโุง ฺฉู ูุงุฒ ุจู ูุชุฌู ุฏุงุฑุฏ ู **promise** ูุฑุจูุทู ุฑุง ุจู ูุฎ (thread) ฺฉู ุจุงุฏ ุขู ูุชุฌู ุฑุง ุชููุฏ ฺฉูุฏุ ุงุฑุชุจุงุท ุฏููุ ููุน **packaged_task** ุจุฑุง ุณุงุฏูโุชุฑ ฺฉุฑุฏู ุฑุงูโุงูุฏุงุฒ ูุธุงู ูุชุตู ุจู **future**ูุง ู **promise**ูุง ฺฉู ุจุงุฏ ุฑู ูุฎโูุง ุงุฌุฑุง ุดููุฏุ ุงุฑุงุฆู ุดุฏู ุงุณุช. ฺฉ **packaged_task** ฺฉุฏ ุจุณุชูโุจูุฏ ุดุฏูโุง ุฑุง ูุฑุงูู ูโฺฉูุฏ ุชุง ููุฏุงุฑ ุจุงุฒฺฏุดุช ุง ุงุณุชุซูุง ุงุฒ ูุธูู ุฑุง ุฏุฑ ฺฉ **promise** ูุฑุงุฑ ุฏูุฏ (ูุงููุฏ ฺฉุฏ ฺฉู ุฏุฑ ยง5.3.5.1 ูุดุงู ุฏุงุฏู ุดุฏู ุงุณุช). ุงฺฏุฑ ุงุฒ ุขู ุจุฎูุงูุฏ ุจุง ูุฑุงุฎูุงู **get_future**ุ ฺฉ **packaged_task** ุจู ุดูุง **future** ูุฑุจูุท ุจู **promise** ุฎูุฏ ุฑุง ูโุฏูุฏ. ุจู ุนููุงู ูุซุงูุ ูโุชูุงูู ุฏู ูุธูู ุฑุงูโุงูุฏุงุฒ ฺฉูู ุชุง ูุฑ ฺฉุฏุงู ูู ุงุฒ ุนูุงุตุฑ ฺฉ **vector<double>** ุฑุง ุจุง ุงุณุชูุงุฏู ุงุฒ ุชุงุจุน **accumulate()** ุฌูุนโุขูุฑ ฺฉููุฏ:

```cpp
double accum(double* beg, double* end, double init)
// ูุญุงุณุจู ูุฌููุน ุจุงุฒู [beg:end) ุจุง ููุฏุงุฑ ุงููู init
{
    return accumulate(beg, end, init);
}
```

```cpp
double comp2(vector<double>& v)
{
    using Task_type = double(double*, double*, double); // ููุน ูุธูู
    packaged_task<Task_type> pt0 {accum}; // ุจุณุชูโุจูุฏ ูุธูู (ุนู accum)
    packaged_task<Task_type> pt1 {accum};
    future<double> f0 {pt0.get_future()}; // ฺฏุฑูุชู future ูุฑุจูุท ุจู pt0
    future<double> f1 {pt1.get_future()}; // ฺฏุฑูุชู future ูุฑุจูุท ุจู pt1
    double* first = &v[0];
    thread t1 {move(pt0), first, first + v.size()/2, 0}; // ุดุฑูุน ูุฎ ุจุฑุง pt0
    thread t2 {move(pt1), first + v.size()/2, first + v.size(), 0}; // ุดุฑูุน ูุฎ ุจุฑุง pt1
    // ...
    return f0.get() + f1.get(); // ฺฏุฑูุชู ูุชุงุฌ
}
```

ุงูฺฏู **packaged_task** ููุน ูุธูู ุฑุง ุจู ุนููุงู ูพุงุฑุงูุชุฑ ุงูฺฏู ุฎูุฏ ูโฺฏุฑุฏ (ฺฉู ุฏุฑ ุงูุฌุง **Task_type** ฺฉ ูุณุชุนุงุฑ ุจุฑุง `double(double*, double*, double)` ุงุณุช) ู ูุธูู ุฑุง ุจู ุนููุงู ูพุงุฑุงูุชุฑ ุณุงุฒูุฏู ุฎูุฏ ูโฺฏุฑุฏ (ฺฉู ุฏุฑ ุงูุฌุง **accum** ุงุณุช). ุนููุงุช **move()** ููุฑุฏ ูุงุฒ ุงุณุช ุฒุฑุง ฺฉ **packaged_task** ูุงุจู ฺฉูพ ฺฉุฑุฏู ูุณุช.  
ุชูุฌู ุฏุงุดุชู ุจุงุดุฏ ฺฉู ุฏุฑ ุงู ฺฉุฏ ูฺ ุงุดุงุฑูโุง ุจู ูููโูุง (locks) ูุดุฏู ุงุณุช: ูุง ูุงุฏุฑ ูุณุชู ุฑู ูุธุงู ฺฉู ุจุงุฏ ุงูุฌุงู ุดููุฏ ุชูุฑฺฉุฒ ฺฉููุ ูู ูฺฉุงูุฒูโูุง ฺฉู ุจุฑุง ูุฏุฑุช ุงุฑุชุจุงุทุงุช ุขูโูุง ุงุณุชูุงุฏู ูโุดููุฏ. ุงู ุฏู ูุธูู ุฑู ูุฎโูุง ุฌุฏุงฺฏุงูู ุงุฌุฑุง ุฎูุงููุฏ ุดุฏ ู ุจูุงุจุฑุงู ููฺฉู ุงุณุช ุจู ุตูุฑุช ููุงุฒ ุงุฌุฑุง ุดููุฏ.

---

ุชุงุจุน `accumulate()` ุฏุฑ C++ ฺฉ ุงูฺฏูุฑุชู ุงุณุชุงูุฏุงุฑุฏ ุงุฒ ฺฉุชุงุจุฎุงูู `<numeric>` ุงุณุช ฺฉู ุจุฑุง ูุญุงุณุจู ูุฌููุน ุง ูุฑ ููุน ุชุฌูุน ุฏฺฏุฑ ุฑู ฺฉ ุจุงุฒู ุงุฒ ุฏุงุฏูโูุง (ูุงููุฏ ุขุฑุงู ุง ูฺฉุชูุฑ) ุงุณุชูุงุฏู ูโุดูุฏ. ุงู ุชุงุจุน ุจู ุทูุฑ ูพุดโูุฑุถ ุจุฑุง ุฌูุน ฺฉุฑุฏู ููุงุฏุฑ ุฏุฑ ฺฉ ุจุงุฒู ุงุณุชูุงุฏู ูโุดูุฏุ ุงูุง ูโุชูุงู ุงุฒ ุขู ุจุฑุง ุณุงุฑ ุนููุงุชโูุง ุชุฌูุน (ูุงููุฏ ูุงูฺฏูุ ุถุฑุจ ู ...) ูุฒ ุงุณุชูุงุฏู ฺฉุฑุฏ.

### ุณูุชฺฉุณ:
```cpp
#include <numeric>
T accumulate(InputIterator first, InputIterator last, T init);
T accumulate(InputIterator first, InputIterator last, T init, BinaryOperation op);
```

- **`first` ู `last`:** ุงู ุฏู ูพุงุฑุงูุชุฑ ูุดุงูโุฏููุฏู ุดุฑูุน ู ูพุงุงู ุจุงุฒูโุง ูุณุชูุฏ ฺฉู ุจุงุฏ ุชุฌูุน ุดููุฏ.
- **`init`:** ููุฏุงุฑ ุงูููโุง ฺฉู ุจู ูุญุงุณุจุงุช ุงูุฒูุฏู ูโุดูุฏ.
- **`op` (ุงุฎุชุงุฑ):** ุงู ูพุงุฑุงูุชุฑ ฺฉ ุชุงุจุน ุฏูุฏู ุงุณุช ฺฉู ุฏู ููุฏุงุฑ ุฑุง ูโฺฏุฑุฏ ู ูุชุฌู ุชุฑฺฉุจ ุขูโูุง ุฑุง ุจุฑูโฺฏุฑุฏุงูุฏ (ุจุฑุง ูุซุงู ุฌูุนุ ุถุฑุจ ู ุบุฑู). ุงฺฏุฑ ุงู ูพุงุฑุงูุชุฑ ูุดุฎุต ูุดูุฏุ ุจู ุทูุฑ ูพุดโูุฑุถ ุงุฒ ุนููฺฏุฑ ุฌูุน (`+`) ุงุณุชูุงุฏู ูโุดูุฏ.

### ูุซุงู ุณุงุฏู ุงุฒ `accumulate`:

ูุฑุถ ฺฉูุฏ ฺฉู ฺฉ ุขุฑุงู ุงุฒ ุงุนุฏุงุฏ ุตุญุญ ุฏุงุฑุฏ ู ูโุฎูุงูุฏ ูุฌููุน ุขูโูุง ุฑุง ูุญุงุณุจู ฺฉูุฏ:

```cpp
#include <iostream>
#include <vector>
#include <numeric>

int main() {
    // ฺฉ ูฺฉุชูุฑ ุงุฒ ุงุนุฏุงุฏ
    std::vector<int> vec = {1, 2, 3, 4, 5};

    // ุงุณุชูุงุฏู ุงุฒ accumulate ุจุฑุง ูุญุงุณุจู ูุฌููุน
    int sum = std::accumulate(vec.begin(), vec.end(), 0);

    std::cout << "Sum: " << sum << std::endl;  // ุฎุฑูุฌ: Sum: 15

    return 0;
}
```

ุฏุฑ ุงู ูุซุงู:
- `vec.begin()` ู `vec.end()` ุจู ุชุฑุชุจ ูุดุงูโุฏููุฏู ุขุบุงุฒ ู ูพุงุงู ูฺฉุชูุฑ ูุณุชูุฏ.
- ููุฏุงุฑ ุงููู `0` ุงุณุช.
- ุจู ุฏูู ุงูฺฉู ุนููฺฏุฑ ูพุดโูุฑุถ `accumulate` ุฌูุน ุงุณุชุ ุจู ุทูุฑ ุฎูุฏฺฉุงุฑ ุงุนุฏุงุฏ ุฏุงุฎู ูฺฉุชูุฑ ุฑุง ุฌูุน ูโฺฉูุฏ.

### ูุซุงู ุจุง ุงุณุชูุงุฏู ุงุฒ `op` (ุชุงุจุน ุฏูุฏู):

ุฏุฑ ุงูุฌุง ูโุฎูุงูู ุงุฒ `accumulate` ุจุฑุง ุถุฑุจ ุชูุงู ุนูุงุตุฑ ฺฉ ูฺฉุชูุฑ ุงุณุชูุงุฏู ฺฉูู:

```cpp
#include <iostream>
#include <vector>
#include <numeric>
#include <functional>

int main() {
    // ฺฉ ูฺฉุชูุฑ ุงุฒ ุงุนุฏุงุฏ
    std::vector<int> vec = {1, 2, 3, 4, 5};

    // ุงุณุชูุงุฏู ุงุฒ accumulate ุจุฑุง ุถุฑุจ ุชูุงู ุนูุงุตุฑ
    int product = std::accumulate(vec.begin(), vec.end(), 1, std::multiplies<int>());

    std::cout << "Product: " << product << std::endl;  // ุฎุฑูุฌ: Product: 120

    return 0;
}
```

ุฏุฑ ุงู ูุซุงู:
- ููุฏุงุฑ ุงููู `1` ุงุณุช (ฺูู ุถุฑุจ ุจุง 1 ุดุฑูุน ูโุดูุฏ).
- ุชุงุจุน `std::multiplies<int>()` ฺฉู ฺฉ ุชุงุจุน ุฏูุฏู ุจุฑุง ุถุฑุจ ุงุณุชุ ุจู ุนููุงู ุชุงุจุน ุชุฌูุน (reduction function) ุงุณุชูุงุฏู ูโุดูุฏ.

### ุฌูุนโุจูุฏ:
ุชุงุจุน `accumulate()` ุฏุฑ C++ ุจู ุดูุง ุงู ุงูฺฉุงู ุฑุง ูโุฏูุฏ ฺฉู ุจู ุฑุงุญุช ุชุฌูุนโูุง ูุงููุฏ ุฌูุนุ ุถุฑุจุ ุง ุญุช ุณุงุฑ ุนููุงุชโูุง ุณูุงุฑุด ุฑุง ุจุฑ ุฑู ฺฉ ุจุงุฒู ุงุฒ ุฏุงุฏูโูุง ุงูุฌุงู ุฏูุฏ. ุงู ุชุงุจุน ูโุชูุงูุฏ ุงุฒ ฺฉ ููุฏุงุฑ ุงููู ุดุฑูุน ฺฉูุฏ ู ุณูพุณ ุจุง ุงุณุชูุงุฏู ุงุฒ ฺฉ ุชุงุจุน ุฏูุฏู (ฺฉู ุจู ุทูุฑ ูพุดโูุฑุถ ุฌูุน ุงุณุช) ุชูุงู ููุงุฏุฑ ุฏุฑ ุจุงุฒู ุฑุง ุชุฑฺฉุจ ฺฉูุฏ.

---

ุงู ูุชู ุฏุฑ ููุฑุฏ ุงุณุชูุงุฏู ุงุฒ `packaged_task` ุฏุฑ C++ ุงุณุช ฺฉู ุจุฑุง ูุฏุฑุช ู ุงุฑุชุจุงุท ุจู `futures` ู `promises` ุจู ฺฉุงุฑ ูโุฑูุฏ. ูุฏู ุงุตู ุงู ุงุณุช ฺฉู ุจุฏูู ูฺฏุฑุงู ุงุฒ ูฺฉุงูุฒูโูุง ูพฺุฏู ููุฒูุงู (ูุซู ูููโูุง)ุ ุจุชูุงูู ูุธุงู ุฑุง ุจู ุทูุฑ ููุฒูุงู (parallel) ุงุฌุฑุง ฺฉูู ู ูุชุงุฌ ุขูโูุง ุฑุง ุฏุฑุงูุช ฺฉูู.

### 1. ููููู `packaged_task`:

- `packaged_task` ฺฉ ููุน ฺฉูพุณูููโุณุงุฒ ุงุณุช ฺฉู ฺฉ ฺฉุงุฑ (task) ุฑุง ุจุณุชูโุจูุฏ ูโฺฉูุฏ. ุงู ฺฉุงุฑ ููฺฉู ุงุณุช ูุฑ ููุน ุชุงุจุน ุง ุงูฺฏูุฑุชู ุจุงุดุฏ ฺฉู ุจู ูุชุฌู ูุงุฒ ุฏุงุฑุฏ.
- `packaged_task` ฺฉ `promise` ุฏุงุฎู ุฏุงุฑุฏ ฺฉู ูโุชูุงูุฏ ูุชุฌู ุง ุงุณุชุซูุง (exception) ูุงุด ุงุฒ ุงุฌุฑุง ุชุงุจุน ุฑุง ุฐุฎุฑู ฺฉูุฏ.
- ุจุง ุงุณุชูุงุฏู ุงุฒ `get_future()` ูโุชูุงู ฺฉ ุดุก `future` ุฏุฑุงูุช ฺฉุฑุฏ ฺฉู ุจู `promise` ูุฑุชุจุท ุจุง `packaged_task` ุงุดุงุฑู ูโฺฉูุฏ. ุงู `future` ุจู ุดูุง ุงุฌุงุฒู ูโุฏูุฏ ุชุง ุงุฒ ูุชุฌู ุง ุงุณุชุซูุง ุจุนุฏ ุงุฒ ุงุชูุงู ฺฉุงุฑ ุงุณุชูุงุฏู ฺฉูุฏ.

### 2. ฺฉุงุฑฺฉุฑุฏ ฺฉุฏ ููููู:

ุฏุฑ ุงู ฺฉุฏุ ุฏู ูุธูู ุจุฑุง ุฌูุน ููุงุฏุฑ ฺฉ ุขุฑุงู ุงุฒ ููุน `vector<double>` ุจู ุตูุฑุช ููุงุฒ (ุจุง ุงุณุชูุงุฏู ุงุฒ ุฏู ูุฎ ุง thread) ุชุนุฑู ุดุฏู ุงุณุช. ูุฑ ูุธูู ูุตู ุงุฒ ุขุฑุงู ุฑุง ุฌูุน ูโฺฉูุฏ. 

#### ูุฑุงุญู ฺฉุฏ:

1. **ุชุนุฑู ุชุงุจุน `accum`:** 
   ุงู ุชุงุจุน ุงุฒ `accumulate` ุงุณุชูุงุฏู ูโฺฉูุฏ ุชุง ูุฌููุน ููุงุฏุฑ ุฑุง ฺฉู ุฏุฑ ฺฉ ุจุงุฒู ุงุฒ ุขุฑุงู ูุฑุงุฑ ุฏุงุฑูุฏ ูุญุงุณุจู ฺฉูุฏ.

   ```cpp
   double accum(double* beg, double* end, double init)
   {
       return accumulate(beg, end, init);
   }
   ```

2. **ุชุนุฑู ุชุงุจุน `comp2`:** 
   ุฏุฑ ุงู ุชุงุจุนุ ุฏู `packaged_task` ุชุนุฑู ูโุดูุฏ ฺฉู ูุฑฺฉุฏุงู ฺฉ ุด ุงุฒ ููุน `accum` ุฑุง ุจุณุชูโุจูุฏ ูโฺฉููุฏ. ุณูพุณุ ุจุง ุงุณุชูุงุฏู ุงุฒ `get_future`ุ ฺฉ `future` ุจุฑุง ูุฑฺฉุฏุงู ุงุฒ ุงู `packaged_task` ูุง ฺฏุฑูุชู ูโุดูุฏ ุชุง ุจุนุฏุงู ุจุชูุงูู ูุชุงุฌ ุขููุง ุฑุง ุฏุฑุงูุช ฺฉูู.

   ```cpp
   double comp2(vector<double>& v)
   {
       using Task_type = double(double*, double*, double); // ููุน ุชุณฺฉ
       packaged_task<Task_type> pt0 {accum}; // ุจุณุชูโุจูุฏ ุงููู ุชุณฺฉ
       packaged_task<Task_type> pt1 {accum}; // ุจุณุชูโุจูุฏ ุฏููู ุชุณฺฉ
       future<double> f0 {pt0.get_future()}; // ุฏุฑุงูุช future ุจุฑุง ุงููู ุชุณฺฉ
       future<double> f1 {pt1.get_future()}; // ุฏุฑุงูุช future ุจุฑุง ุฏููู ุชุณฺฉ
   ```

3. **ุงุฌุงุฏ ูุฎโูุง:**
   ุณูพุณ ุฏู ูุฎ (`thread`) ุจุฑุง ุงุฌุฑุง ูุฑฺฉุฏุงู ุงุฒ ูุธุงู ุชุนุฑู ูโุดูุฏ. ุงู ูุฎโูุง ุจู ุทูุฑ ููุงุฒ (parallel) ุงุฌุฑุง ูโุดููุฏ.

   ```cpp
   double* first = &v[0];
   thread t1 {move(pt0), first, first + v.size()/2, 0}; // ุงุฌุฑุง ูุฎ ุจุฑุง ุงููู ููู ุงุฒ ุขุฑุงู
   thread t2 {move(pt1), first + v.size()/2, first + v.size(), 0}; // ุงุฌุฑุง ูุฎ ุจุฑุง ุฏููู ููู ุงุฒ ุขุฑุงู
   ```

   ุฏุฑ ุงูุฌุงุ ุงุฒ `move` ุงุณุชูุงุฏู ูโุดูุฏ ุฒุฑุง `packaged_task` ูุงุจู ฺฉูพ ฺฉุฑุฏู ูุณุช ู ุจุงุฏ ุจู ุตูุฑุช ุงูุชูุงู (move) ุงุฒ ูุฎ ุงุตู ุจู ูุฎโูุง ุฌุฏุฏ ููุชูู ุดูุฏ.

4. **ุฏุฑุงูุช ูุชุงุฌ:**
   ุจุนุฏ ุงุฒ ุงุชูุงู ุงุฌุฑุง ูุฎโูุงุ ูุชุงุฌ ูุฑฺฉุฏุงู ุงุฒ ูุธุงู ุจุง ุงุณุชูุงุฏู ุงุฒ `get()` ุงุฒ `future` ูุง ุฏุฑุงูุช ูโุดูุฏ. ุงู ุชุงุจุน ุจููฺฉู ูโุดูุฏ ุชุง ุฒูุงู ฺฉู ูุชุฌู ุฏุฑ ุฏุณุชุฑุณ ุจุงุดุฏ.

   ```cpp
   return f0.get() + f1.get(); // ุฌูุน ูุชุงุฌ ูุฑ ุฏู ุชุณฺฉ
   ```

### 3. ูุฒุงุง ุงุณุชูุงุฏู ุงุฒ `packaged_task`:

- **ุงูุชูุงู ูุชุงุฌ ุจู ุตูุฑุช ุงูู:** ุจู ุฌุง ุงุณุชูุงุฏู ุงุฒ ูููโูุง ู ูฺฉุงูุฒูโูุง ูพฺุฏู ุจุฑุง ููุงููฺฏ ฺฉุฑุฏู ุฏุงุฏูโูุง ุจู ูุฎโูุงุ ูโุชูุงูู ุงุฒ `future` ู `promise` ุจุฑุง ูุฏุฑุช ุงุฑุชุจุงุทุงุช ุจู ูุฎโูุง ุงุณุชูุงุฏู ฺฉูู.
- **ุณุงุฏูโุณุงุฒ ฺฉุฏ:** ุดูุง ููุท ุจู ุชุงุจุน ุง ฺฉุงุฑ ฺฉู ุจุงุฏ ุงูุฌุงู ุดูุฏ ุชูุฌู ูโฺฉูุฏ ู ูุงุฒ ุจู ูฺฏุฑุงู ุฏุฑ ููุฑุฏ ฺฺฏููฺฏ ูุฏุฑุช ูุถุนุช ูุฎโูุง ุง ููุงููฺฏโุณุงุฒ ูุชุงุฌ ูุณุช.
- **ูพุดุชุจุงู ุงุฒ ฺูุฏู ูุฎ:** ุจุง ุงุณุชูุงุฏู ุงุฒ `packaged_task` ู `future` ูโุชูุงูู ูุธุงู ุฑุง ุจู ูุฎโูุง ูุฎุชูู ุงุฎุชุตุงุต ุฏูู ู ูุชุงุฌ ุฑุง ุจุนุฏุงู ุฌูุนโุขูุฑ ฺฉูู.

### 4. ูุญูู ุนููฺฉุฑุฏ ุฏุฑ ูุญุท ฺูุฏูุฎ:

ุงู ุฑูุด ุจู ุทูุฑ ุทุฑุงุญ ุดุฏู ุงุณุช ฺฉู ุฏู ุจุฎุด ุงุฒ ุขุฑุงู ุฏุฑ ุฏู ูุฎ ูุฎุชูู ูพุฑุฏุงุฒุด ูโุดููุฏุ ุจู ุทูุฑ ููุงุฒ ู ุจุฏูู ูุงุฒ ุจู ููุงููฺฏโุณุงุฒ ูพฺุฏู. ูุฑ ูุฎ ุจุง ุงุณุชูุงุฏู ุงุฒ `packaged_task` ุฎูุฏ ฺฉ ูุชุฌู ุชููุฏ ูโฺฉูุฏ ฺฉู ุฏุฑ ููุงุช ุจุง ุงุณุชูุงุฏู ุงุฒ `get()` ุจู ุตูุฑุช ููุฒูุงู ุฌูุนโุขูุฑ ูโุดูุฏ.

### ูุชุฌูโฺฏุฑ:
ุงุณุชูุงุฏู ุงุฒ `packaged_task` ุฏุฑ ุงู ูุซุงู ฺฉูฺฉ ูโฺฉูุฏ ฺฉู ฺฉุฏ ููุฒูุงู ุจู ุตูุฑุช ุณุงุฏู ู ูุคุซุฑ ูพุงุฏูโุณุงุฒ ุดูุฏ. ุจู ุฌุง ูุฏุฑุช ูพฺุฏู ูููโูุงุ ุงุฒ ูฺฉุงูุฒูโูุง ุณุงุฏูโุง ูุงููุฏ `future` ู `promise` ุจุฑุง ููุงููฺฏโุณุงุฒ ูุชุงุฌ ูุฎโูุง ุงุณุชูุงุฏู ูโุดูุฏ. ุงู ุฑูุด ุจู ุฑุงุญุช ูโุชูุงูุฏ ุจุฑุง ุชูุณู ุจุงุฑ ฺฉุงุฑ ุจู ูุฎโูุง ูุฎุชูู ุฏุฑ ูพุฑุฏุงุฒุดโูุง ููุงุฒ ู ุชูุฒุนโุดุฏู ููุฑุฏ ุงุณุชูุงุฏู ูุฑุงุฑ ฺฏุฑุฏ.

--- 

ููููู `packaged_task` ุฏุฑ C++ ุจุฑุง ูุฏุฑุช ู ููุงููฺฏ ุจู ูุธุงู ูุฎุชูู ุฏุฑ ูุญุท ฺูุฏูุฎ (multithreading) ุทุฑุงุญ ุดุฏู ุงุณุช. ุจุฑุง ุงูฺฉู ุจูุชุฑ ูุชูุฌู ุดูุฏุ ุงุจุชุฏุง ุจุงุฏ ููููู `future` ู `promise` ุฑุง ุฏุฑฺฉ ฺฉูุฏุ ุฒุฑุง ุงู ุฏู ุจุฎุด ุงุตู ฺฉุงุฑฺฉุฑุฏ `packaged_task` ูุณุชูุฏ. 

### 1. **ููููู `future` ู `promise`:**
- **`promise`:** ฺฉ ุดุก ุงุณุช ฺฉู ุจุฑุง ูฺฏูุฏุงุฑ ูุชุฌู ฺฉ ูุญุงุณุจู ุง ุนูู ูพฺุฏู ุงุณุชูุงุฏู ูโุดูุฏ. ุฏุฑ ูุงูุนุ ุดูุง ุจู ฺฉ `promise` ูโฺฏูุฏ ฺฉู ุงูุชุธุงุฑ ุฏุงุฑุฏ ฺฉ ูุชุฌู ุฎุงุต ุฑุง ุชููุฏ ฺฉูุฏ.
- **`future`:** ฺฉ ุดุก ุงุณุช ฺฉู ุจู ุดูุง ุงูฺฉุงู ูโุฏูุฏ ุจู ูุชุฌูโุง ฺฉู ุชูุณุท ฺฉ `promise` ุชููุฏ ูโุดูุฏ ุฏุณุชุฑุณ ูพุฏุง ฺฉูุฏ. ุฏุฑ ูุงูุนุ `future` ุจู ุดูุง ุงุฌุงุฒู ูโุฏูุฏ ฺฉู ููุชุธุฑ ุจูุงูุฏ ุชุง ูุชุฌู ุงุฒ ฺฉุงุฑ ุจุฑฺฏุฑุฏุฏ.

### 2. **ููููู `packaged_task`:**
`packaged_task` ฺฉ ฺฉูพุณูููโุณุงุฒ ุงุณุช ฺฉู ุดูุง ูโุชูุงูุฏ ฺฉ ุชุงุจุน ุง ุงูฺฏูุฑุชู ุฑุง ุฏุฑ ุขู ูุฑุงุฑ ุฏูุฏ ู ุขู ุฑุง ุจู ุตูุฑุช ุบุฑููุฒูุงู (asynchronously) ุฏุฑ ฺฉ ูุฎ ุฏฺฏุฑ ุงุฌุฑุง ฺฉูุฏ. ููฺููุ `packaged_task` ุจู ุดูุง ุงู ุงูฺฉุงู ุฑุง ูโุฏูุฏ ฺฉู ฺฉ `future` ุฏุฑุงูุช ฺฉูุฏ ฺฉู ุจู ูุชุฌู (ุง ุงุณุชุซูุง) ุขู ุชุงุจุน ุฏุณุชุฑุณ ูพุฏุง ฺฉูุฏ.

### 3. **ุณุงุฎุชุงุฑ `packaged_task`:**
ุฏุฑ ุญููุชุ `packaged_task` ฺฉ ุชุฑฺฉุจ ุงุฒ `task` (ูุธููโุง ฺฉู ุจุงุฏ ุงุฌุฑุง ุดูุฏ) ู `promise` (ฺฉู ูุชุฌู ุขู ุฑุง ุฐุฎุฑู ูโฺฉูุฏ) ุงุณุช. ุฒูุงู ฺฉู `packaged_task` ุจู ุงุฌุฑุง ุฏุฑ ูโุขุฏุ ูุชุฌู ุขู ุฏุฑ `promise` ูุฑุงุฑ ูโฺฏุฑุฏ ู ุดูุง ูโุชูุงูุฏ ุจุง ุงุณุชูุงุฏู ุงุฒ `future` ูุชุฌู ุฑุง ุฏุฑุงูุช ฺฉูุฏ.

### 4. **ูุซุงู ุณุงุฏู:**

ูุฑุถ ฺฉูุฏ ุดูุง ฺฉ ุชุงุจุน ุฏุงุฑุฏ ฺฉู ุจู ุทูุฑ ููุฒูุงู ุฏู ุนุฏุฏ ุฑุง ุฌูุน ูโฺฉูุฏ ู ูโุฎูุงูุฏ ูุชุฌู ุขู ุฑุง ุฏุฑ ฺฉ `future` ุฏุฑุงูุช ฺฉูุฏ. ุจุง ุงุณุชูุงุฏู ุงุฒ `packaged_task` ูโุชูุงูุฏ ุงู ฺฉุงุฑ ุฑุง ุงูุฌุงู ุฏูุฏ.

```cpp
#include <iostream>
#include <thread>
#include <future>

// ุชุงุจุน ฺฉู ุฏู ุนุฏุฏ ุฑุง ุฌูุน ูโฺฉูุฏ
int add(int a, int b) {
    return a + b;
}

int main() {
    // ุณุงุฎุช packaged_task ฺฉู ุชุงุจุน add ุฑุง ุจุณุชูโุจูุฏ ูโฺฉูุฏ
    std::packaged_task<int(int, int)> pt(add);

    // ุฏุฑุงูุช future ุจุฑุง ุฏุฑุงูุช ูุชุฌู ุงุฒ packaged_task
    std::future<int> result = pt.get_future();

    // ุงุฌุงุฏ ูุฎ ุจุฑุง ุงุฌุฑุง packaged_task
    std::thread t(std::move(pt), 3, 5);  // ูุฎ ุฌูุน ฺฉุฑุฏู 3 ู 5

    // ููุชุธุฑ ูโูุงูู ุชุง ูุชุฌู ุฑุง ุงุฒ future ุฏุฑุงูุช ฺฉูู
    std::cout << "Result: " << result.get() << std::endl;

    // ุงุทููุงู ุงุฒ ุงูฺฉู ูุฎ ุจู ูพุงุงู ุฑุณุฏู
    t.join();

    return 0;
}
```

### ุชูุถุญุงุช:
1. **ุชุนุฑู ุชุงุจุน `add`:** ุงู ุชุงุจุน ุฏู ุนุฏุฏ ุฑุง ุฏุฑุงูุช ูโฺฉูุฏ ู ูุฌููุน ุขูโูุง ุฑุง ุจุฑูโฺฏุฑุฏุงูุฏ.
2. **ุชุนุฑู `packaged_task`:** ูุง ฺฉ ุดุก `packaged_task` ุจู ูุงู `pt` ุงุฌุงุฏ ูโฺฉูู ฺฉู ุชุงุจุน `add` ุฑุง ุจุณุชูโุจูุฏ ูโฺฉูุฏ. ููุน ุฏุงุฏูโุง ฺฉู `packaged_task` ูโุชูุงูุฏ ุจุณุชูโุจูุฏ ฺฉูุฏ (ุฏุฑ ุงูุฌุง `int(int, int)`) ูุดุงู ูโุฏูุฏ ฺฉู ุงู ุชุงุจุน ุฏู ุนุฏุฏ ุตุญุญ ุฑุง ูโฺฏุฑุฏ ู ฺฉ ุนุฏุฏ ุตุญุญ ุจุงุฒ ูโฺฏุฑุฏุงูุฏ.
3. **ุฏุฑุงูุช `future`:** ุจุง ุงุณุชูุงุฏู ุงุฒ `get_future()` ุงุฒ `packaged_task` ฺฉ `future` ูโฺฏุฑู ฺฉู ุจู ูุชุฌู ุชุงุจุน `add` ุงุดุงุฑู ูโฺฉูุฏ.
4. **ุงุฌุงุฏ ูุฎ:** ฺฉ ูุฎ (`std::thread`) ุณุงุฎุชู ูโุดูุฏ ุชุง ุชุงุจุน `add` ุฑุง ุจู ุทูุฑ ููุฒูุงู (concurrently) ุงุฌุฑุง ฺฉูุฏ.
5. **ุฏุฑุงูุช ูุชุฌู ุจุง `get()`:** ุจุนุฏ ุงุฒ ุงุฌุฑุง ุชุงุจุน ุฏุฑ ูุฎุ ูุง ุงุฒ `future` ุงุณุชูุงุฏู ูโฺฉูู ุชุง ูุชุฌู ุฑุง ุฏุฑุงูุช ฺฉูู. ุฏุฑ ุงูุฌุงุ `result.get()` ูุชุฌู ุฌูุน ฺฉุฑุฏู ุฏู ุนุฏุฏ ุฑุง ูโุฏูุฏ.
6. **ูพุงุงู ูุฎ:** `t.join()` ุงุทููุงู ูโุฏูุฏ ฺฉู ูุฎ ุจู ูพุงุงู ุฑุณุฏู ุจุงุดุฏ ูุจู ุงุฒ ุงูฺฉู ุจุฑูุงูู ุฎุงุชูู ุงุจุฏ.

### 5. **ฺุฑุง ุงุฒ `packaged_task` ุงุณุชูุงุฏู ฺฉููุ**
- **ููุงููฺฏ ุขุณุงู:** `packaged_task` ุจู ุดูุง ุงู ุงูฺฉุงู ุฑุง ูโุฏูุฏ ฺฉู ฺฉุฏ ุฑุง ุจุฏูู ูุงุฒ ุจู ุงุณุชูุงุฏู ุงุฒ ูููโูุง ุง ููุงููฺฏโฺฉููุฏูโูุง ูพฺุฏู ุจููุณุฏ. ุดูุง ูโุชูุงูุฏ ุจู ุฑุงุญุช ุงุฒ `future` ุจุฑุง ุฏุฑุงูุช ูุชุงุฌ ุงุณุชูุงุฏู ฺฉูุฏ.
- **ุงูุชูุงู ูุธุงู ุจู ูุฎโูุง:** ุจุง ุงุณุชูุงุฏู ุงุฒ `packaged_task`ุ ูโุชูุงูุฏ ูุธุงู ุฑุง ุจู ูุฎโูุง ูุฎุชูู ููุชูู ฺฉูุฏ ู ูุทูุฆู ุจุงุดุฏ ฺฉู ููุช ูุชุฌู ูุญุงุณุจู ุดุฏุ ุจู ุฏุฑุณุช ุฏุฑ `promise` ูุฑุงุฑ ูโฺฏุฑุฏ ู ุดูุง ูโุชูุงูุฏ ุขู ุฑุง ุงุฒ `future` ุฏุฑุงูุช ฺฉูุฏ.

### 6. **ูุฒุงุง ุงุณุชูุงุฏู ุงุฒ `packaged_task`:**
- **ูุฏุฑุช ุณุงุฏู ููุฒูุงู:** ุจุฏูู ูุงุฒ ุจู ุงุณุชูุงุฏู ุงุฒ ูููโูุงุ ุจู ุฑุงุญุช ูโุชูุงูุฏ ูุชุงุฌ ฺฉุงุฑูุง ููุงุฒ ุฑุง ุฏุฑุงูุช ฺฉูุฏ.
- **ฺฉูพุณูููโุณุงุฒ:** ูโุชูุงูุฏ ุชูุงุจุน ุฑุง ุจู ุฑุงุญุช ุจุณุชูโุจูุฏ ฺฉูุฏ ู ุขููุง ุฑุง ุจู ูุฎโูุง ูุฎุชูู ุงุฎุชุตุงุต ุฏูุฏ.
- **ููุงุณโูพุฐุฑ:** ุจุง ุงุณุชูุงุฏู ุงุฒ `packaged_task`ุ ูโุชูุงูุฏ ุจุฑูุงููโูุง ููุงุฒ ุจุง ุชุนุฏุงุฏ ุฒุงุฏ ูุฎ ุงุฌุงุฏ ฺฉูุฏ ู ุงู ฺฉุงุฑ ุฑุง ุจู ุดฺฉู ุณุงุฏู ุงูุฌุงู ุฏูุฏ.

### ุฌูุนโุจูุฏ:
`packaged_task` ุงุจุฒุงุฑ ูุฏุฑุชููุฏ ุงุณุช ฺฉู ฺฉูฺฉ ูโฺฉูุฏ ฺฉุงุฑูุง ูพฺุฏู ููุฒูุงู ุฑุง ุจู ุฑุงุญุช ูุฏุฑุช ฺฉูุฏ. ุจุง ุงุณุชูุงุฏู ุงุฒ ุงู ููุนุ ูโุชูุงูุฏ ูุชุฌูโ ฺฉุงุฑูุง ููุงุฒ ุฑุง ุจุง ุงุณุชูุงุฏู ุงุฒ `future` ูุง ุฏุฑุงูุช ฺฉูุฏ ู ุงุฒ ูพฺุฏฺฏโูุง ููุฒูุงูโุณุงุฒ (ูุงููุฏ ูููโูุง) ุฌููฺฏุฑ ฺฉูุฏ.

---

## async()
ุฏุฑ ุงู ูุตูุ ุฎุท ุชูฺฉุฑ ฺฉู ุฏูุจุงู ฺฉุฑุฏูโุงูุ ุณุงุฏูโุชุฑู ู ุฏุฑ ุนู ุญุงู ุงุฒ ูุฏุฑุชููุฏุชุฑูโูุงุณุช: ฺฉ ูุธูู ุฑุง ุจูโุนููุงู ฺฉ ุชุงุจุน ุฏุฑ ูุธุฑ ุจฺฏุฑุฏ ฺฉู ููฺฉู ุงุณุช ุจู ุทูุฑ ููโุฒูุงู ุจุง ุฏฺฏุฑ ูุธุงู ุงุฌุฑุง ุดูุฏ. ุงู ุชููุง ูุฏู ูพุดุชุจุงูโุดุฏู ุชูุณุท ฺฉุชุงุจุฎุงูู ุงุณุชุงูุฏุงุฑุฏ C++ ูุณุชุ ุงูุง ุจุฑุง ูุงุฒูุง ูุชููุน ุจุณุงุฑ ููุงุณุจ ุงุณุช. ูุฏูโูุง ูพฺุฏูโุชุฑ ู ุฏุดูุงุฑุชุฑุ ูุงููุฏ ุณุจฺฉโูุง ุจุฑูุงููโููุณ ฺฉู ุจู ุญุงูุธู ูุดุชุฑฺฉ ูุงุจุณุชูโุงูุฏุ ูโุชูุงููุฏ ุฏุฑ ุตูุฑุช ูุงุฒ ุงุณุชูุงุฏู ุดููุฏ.

ุจุฑุง ุฑุงูโุงูุฏุงุฒ ูุธุงู ฺฉู ููฺฉู ุงุณุช ุจูโุทูุฑ ุบุฑููุฒูุงู ุงุฌุฑุง ุดููุฏุ ูโุชูุงูู ุงุฒ `async()` ุงุณุชูุงุฏู ฺฉูู:
```cpp
double comp4(vector<double>& v)
// ุงฺฏุฑ v ุจู ุงูุฏุงุฒู ฺฉุงู ุจุฒุฑฺฏ ุจุงุดุฏุ ูุธุงู ุฒุงุฏ ุฑุงูโุงูุฏุงุฒ ูโุดูุฏ
{
    if (v.size() < 10000) return accum(v.begin(), v.end(), 0.0);
    auto v0 = &v[0];
    auto sz = v.size();
    auto f0 = async(accum, v0, v0 + sz / 4, 0.0); // ุฑุจุน ุงูู
    auto f1 = async(accum, v0 + sz / 4, v0 + sz / 2, 0.0); // ุฑุจุน ุฏูู
    auto f2 = async(accum, v0 + sz / 2, v0 + sz * 3 / 4, 0.0); // ุฑุจุน ุณูู
    auto f3 = async(accum, v0 + sz * 3 / 4, v0 + sz, 0.0); // ุฑุจุน ฺูุงุฑู
    return f0.get() + f1.get() + f2.get() + f3.get(); // ุฌูุนโุขูุฑ ู ุชุฑฺฉุจ ูุชุงุฌ
}
```

ุงุณุงุณุงูุ `async()` ุจุฎุด "ูุฑุงุฎูุงู ุชุงุจุน" ุฑุง ุงุฒ ุจุฎุด "ุฏุฑุงูุช ูุชุฌู" ุฌุฏุง ูโฺฉูุฏ ู ูุฑ ุฏู ุฑุง ุงุฒ ุงุฌุฑุง ูุงูุน ูุธูู ุชูฺฉฺฉ ูโฺฉูุฏ. ุจุง ุงุณุชูุงุฏู ุงุฒ `async()` ูุงุฒ ุจู ูฺฉุฑ ฺฉุฑุฏู ุฏุฑ ููุฑุฏ ูุฎโูุง ู ูููโูุง ูุฏุงุฑุฏ. ุจูฺฉู ุชููุง ุฏุฑ ููุฑุฏ ูุธุงู ูฺฉุฑ ูโฺฉูุฏ ฺฉู ุจูโุทูุฑ ุจุงูููู ูุชุงุฌ ุฎูุฏ ุฑุง ุจูโุตูุฑุช ุบุฑููุฒูุงู ูุญุงุณุจู ูโฺฉููุฏ. ูุญุฏูุฏุช ุขุดฺฉุงุฑ ุงู ุงุณุช ฺฉู ูุจุงุฏ ุงุฒ `async()` ุจุฑุง ูุธุงู ฺฉู ููุงุจุน ูุดุชุฑฺฉ ูุงุฒ ุจู ููู ุฏุงุฑูุฏ ุงุณุชูุงุฏู ฺฉูุฏุ ุฒุฑุง ุจุง `async()` ุญุช ููโุฏุงูุฏ ฺฉู ฺูุฏ ูุฎ ุจุฑุง ุงูุฌุงู ูุธุงู ุงุณุชูุงุฏู ุฎูุงูุฏ ุดุฏุ ุฒุฑุง ุงู ููุถูุน ุจุณุชฺฏ ุจู ุชุตูู `async()` ุฏุงุฑุฏ ฺฉู ุจุฑ ุงุณุงุณ ููุงุจุน ุณุณุชู ุฏุฑ ุฏุณุชุฑุณ ุฏุฑ ุฒูุงู ูุฑุงุฎูุงู ุงุชุฎุงุฐ ูโุดูุฏ. ุจูโุนููุงู ูุซุงูุ `async()` ููฺฉู ุงุณุช ุจุฑุฑุณ ฺฉูุฏ ฺฉู ุขุง ูุณุชูโูุง ุขุฒุงุฏ (ูพุฑุฏุงุฒูุฏูโูุง) ุฏุฑ ุฏุณุชุฑุณ ูุณุชูุฏ ุง ููุ ูุจู ุงุฒ ุงูฺฉู ุชุตูู ุจฺฏุฑุฏ ฺู ุชุนุฏุงุฏ ูุฎ ุงุณุชูุงุฏู ฺฉูุฏ.

ูุทูุงู ุชูุฌู ุฏุงุดุชู ุจุงุดุฏ ฺฉู `async()` ููุท ฺฉ ูฺฉุงูุฒู ูฺู ุจุฑุง ูุญุงุณุจุงุช ููุงุฒ ุจู ููุธูุฑ ุงูุฒุงุด ุนููฺฉุฑุฏ ูุณุช. ุจูโุนููุงู ูุซุงูุ ููฺูู ูโุชูุงู ุงุฒ ุขู ุจุฑุง ุฑุงูโุงูุฏุงุฒ ฺฉ ูุธูู ุฌูุช ุฏุฑุงูุช ุงุทูุงุนุงุช ุงุฒ ฺฉุงุฑุจุฑ ุงุณุชูุงุฏู ฺฉุฑุฏุ ุฏุฑ ุญุงู ฺฉู "ุจุฑูุงูู ุงุตู" ุจุง ุงูุฌุงู ฺฉุงุฑ ุฏฺฏุฑ ูุนุงู ูโูุงูุฏ.

---

ุฎุท ุชูฺฉุฑ ฺฉู ุฏุฑ ุงู ูุตู ุฏูุจุงู ฺฉุฑุฏูโุงูุ ุจู ูุธุฑ ูู ุณุงุฏูโุชุฑู ู ุฏุฑ ุนู ุญุงู ฺฉ ุงุฒ ูุฏุฑุชููุฏุชุฑูโูุงุณุช: ุจู ฺฉ ูุธูู ุจู ุนููุงู ฺฉ ุชุงุจุน ูฺฏุงู ฺฉูุฏ ฺฉู ููฺฉู ุงุณุช ุจู ุทูุฑ ููโุฒูุงู ุจุง ุณุงุฑ ูุธุงู ุงุฌุฑุง ุดูุฏ. ุงู ูุฏู ุชููุง ูุฏู ูพุดุชุจุงูโุดุฏู ุชูุณุท ฺฉุชุงุจุฎุงูู ุงุณุชุงูุฏุงุฑุฏ C++ ูุณุชุ ุงูุง ุจุฑุง ุทู ูุณุน ุงุฒ ูุงุฒูุง ุจู ุฎูุจ ุฌูุงุจ ูโุฏูุฏ. ูุฏูโูุง ูพฺุฏูโุชุฑ ู ุฏููโุชุฑุ ูุงููุฏ ุณุจฺฉโูุง ุจุฑูุงููโููุณ ฺฉู ุจู ุญุงูุธู ูุดุชุฑฺฉ ูุงุจุณุชู ูุณุชูุฏุ ุฏุฑ ุตูุฑุช ูุงุฒ ูุงุจู ุงุณุชูุงุฏู ูุณุชูุฏ.

ุจุฑุง ุฑุงูโุงูุฏุงุฒ ูุธุงู ฺฉู ููฺฉู ุงุณุช ุจู ุตูุฑุช ูุงููโุฒูุงู ุงุฌุฑุง ุดููุฏุ ูโุชูุงูู ุงุฒ **`async()`** ุงุณุชูุงุฏู ฺฉูู:

```cpp
double comp4(vector<double>& v)
// ุฑุงูโุงูุฏุงุฒ ฺูุฏู ูุธูู ุงฺฏุฑ v ุจู ุงูุฏุงุฒู ฺฉุงู ุจุฒุฑฺฏ ุจุงุดุฏ
{
    if (v.size() < 10000) return accum(v.begin(), v.end(), 0.0);
    auto v0 = &v[0];
    auto sz = v.size();
    auto f0 = async(accum, v0, v0 + sz / 4, 0.0); // ฺฉ ฺูุงุฑู ุงูู
    auto f1 = async(accum, v0 + sz / 4, v0 + sz / 2, 0.0); // ฺฉ ฺูุงุฑู ุฏูู
    auto f2 = async(accum, v0 + sz / 2, v0 + sz * 3 / 4, 0.0); // ฺฉ ฺูุงุฑู ุณูู
    auto f3 = async(accum, v0 + sz * 3 / 4, v0 + sz, 0.0); // ฺฉ ฺูุงุฑู ฺูุงุฑู
    return f0.get() + f1.get() + f2.get() + f3.get(); // ุฌูุนโุขูุฑ ู ุชุฑฺฉุจ ูุชุงุฌ
}
```

ุงุณุงุณุงูุ **`async()`** ูุณูุช ยซูุฑุงุฎูุงูยป ฺฉ ุชุงุจุน ุฑุง ุงุฒ ูุณูุช ยซุฏุฑุงูุช ูุชุฌูยป ุฌุฏุง ูโฺฉูุฏ ู ูุฑ ุฏู ุฑุง ุงุฒ ุงุฌุฑุง ูุงูุน ูุธูู ุฌุฏุง ูโฺฉูุฏ. ุจุง ุงุณุชูุงุฏู ุงุฒ **`async()`**, ุดูุง ูุงุฒ ุจู ูฺฉุฑ ฺฉุฑุฏู ุฏุฑ ููุฑุฏ ูุฎโูุง ู ูููโูุง ูุฏุงุฑุฏ. ุจู ุฌุง ุขูุ ุดูุง ููุท ุฏุฑ ููุฑุฏ ูุธุงู ูฺฉุฑ ูโฺฉูุฏ ฺฉู ุจู ุทูุฑ ุจุงูููู ูุชุงุฌ ุฎูุฏ ุฑุง ุจู ุตูุฑุช ูุงููโุฒูุงู ูุญุงุณุจู ูโฺฉููุฏ. ูุญุฏูุฏุช ูุงุถุญ ูุฌูุฏ ุฏุงุฑุฏ: ุจู ูฺ ุนููุงู ุงุฒ **`async()`** ุจุฑุง ูุธุงู ฺฉู ููุงุจุน ูุดุชุฑฺฉ ูุงุฒ ุจู ููู ุฏุงุฑูุฏ ุงุณุชูุงุฏู ูฺฉูุฏ โ ุจุง **`async()`** ุญุช ููโุฏุงูุฏ ฺฉู ฺูุฏ ูุฎ ุจุฑุง ุงูุฌุงู ูุธูู ุงุณุชูุงุฏู ุฎูุงููุฏ ุดุฏุ ุฒุฑุง ุงู ุชุตูู ุจู ุนูุฏู ุฎูุฏ **`async()`** ุงุณุช ฺฉู ุจุฑ ุงุณุงุณ ุขูฺู ุงุฒ ููุงุจุน ุณุณุชู ุฏุฑ ุฒูุงู ูุฑุงุฎูุงู ูโุฏุงูุฏุ ุชุตูู ูโฺฏุฑุฏ. ุจู ุนููุงู ูุซุงูุ **`async()`** ููฺฉู ุงุณุช ุจุฑุฑุณ ฺฉูุฏ ฺฉู ุขุง ูุณุชูโูุง ุขุฒุงุฏ (ูพุฑุฏุงุฒูุฏูโูุง) ุฏุฑ ุฏุณุชุฑุณ ูุณุชูุฏ ุง ูู ูุจู ุงุฒ ุงูฺฉู ุชุตูู ุจฺฏุฑุฏ ฺูุฏ ูุฎ ุงุณุชูุงุฏู ฺฉูุฏ.

ูุทูุงู ุชูุฌู ุฏุงุดุชู ุจุงุดุฏ ฺฉู **`async()`** ููุท ฺฉ ูฺฉุงูุฒู ุชุฎุตุต ุจุฑุง ูุญุงุณุจุงุช ููุงุฒ ุจู ููุธูุฑ ุงูุฒุงุด ุนููฺฉุฑุฏ ูุณุช. ุจู ุนููุงู ูุซุงูุ ูโุชูุงู ุงุฒ ุขู ุจุฑุง ุฑุงูโุงูุฏุงุฒ ูุธููโุง ุจุฑุง ุฏุฑุงูุช ุงุทูุงุนุงุช ุงุฒ ฺฉุงุฑุจุฑ ุงุณุชูุงุฏู ฺฉุฑุฏุ ุจู ุทูุฑ ฺฉู ยซุจุฑูุงูู ุงุตูยป ูุนุงู ุจุงู ูโูุงูุฏ ู ฺฉุงุฑ ุฏฺฏุฑ ุฑุง ุงูุฌุงู ูโุฏูุฏ.

ุฏุฑ ุงู ูุชูุ ููุณูุฏู ุจู ูุนุฑู ู ุชูุถุญ ุชุงุจุน `async()` ุฏุฑ C++ ูโูพุฑุฏุงุฒุฏ ู ฺฺฏููฺฏ ุงุณุชูุงุฏู ุงุฒ ุขู ุจุฑุง ุงุฌุฑุง ููุฒูุงู ุง ุจู ุงุตุทูุงุญ *asynchronous* ฺฉุงุฑูุง ุฑุง ุชูุถุญ ูโุฏูุฏ. ุฏุฑ ุงุฏุงููุ ุจู ุชูุถุญ ุฏููโุชุฑ ูุทูุจ ูโูพุฑุฏุงุฒู.

### ููููู ฺฉู:
ุฏุฑ ุงูุฌุงุ ููุณูุฏู ูโุฎูุงูุฏ ฺฉ ฺฉุงุฑ ุฑุง ุจู ุนููุงู ฺฉ ุชุงุจุน ุฏุฑ ูุธุฑ ุจฺฏุฑุฏ ฺฉู ูโุชูุงูุฏ ุจู ุทูุฑ ููุฒูุงู ุจุง ุฏฺฏุฑ ูุธุงู ุงุฌุฑุง ุดูุฏ. ุงู ุฑูฺฉุฑุฏ ุจุณุงุฑ ุณุงุฏู ู ุฏุฑ ุนู ุญุงู ูุฏุฑุชููุฏ ุงุณุช. ุจู ุฌุง ุงูฺฉู ูุณุชููุงู ุจู ููุถูุนุงุช ูพฺุฏู ูุงููุฏ ุญุงูุธู ูุดุชุฑฺฉ ุง ูููโูุง (locks) ูฺฉุฑ ฺฉููุ ฺฉุงูุณุช ฺฉู ุงู ูุธุงู ุฑุง ุจู ุนููุงู ูุธุงู ูุณุชูู ุฏุฑ ูุธุฑ ุจฺฏุฑู ฺฉู ููฺฉู ุงุณุช ุจู ุทูุฑ ููุฒูุงู ุงุฌุฑุง ุดููุฏ.

### ูุนุฑู `async()`:
ุชุงุจุน `async()` ุฏุฑ C++ ุจุฑุง ุงุฌุฑุง ฺฉุงุฑูุง ุจู ุตูุฑุช ููุฒูุงู ุง *asynchronous* ุจู ฺฉุงุฑ ูโุฑูุฏ. ุจู ุนุจุงุฑุช ุณุงุฏูโุชุฑุ ุงู ุชุงุจุน ุจู ุดูุง ุงูฺฉุงู ูโุฏูุฏ ฺฉู ฺฉ ูุธูู ุฑุง ุฏุฑ ูพุณโุฒููู ุงุฌุฑุง ฺฉูุฏุ ุฏุฑ ุญุงู ฺฉู ุจุฑูุงูู ููฺูุงู ุฏุฑ ุญุงู ุงูุฌุงู ฺฉุงุฑูุง ุฏฺฏุฑ ุงุณุช.

ุฏุฑ ฺฉุฏ ุงุฑุงุฆูโุดุฏูุ ูุฑุถ ุจุฑ ุงู ุงุณุช ฺฉู ฺฉ ูฺฉุชูุฑ `v` ุจุง ููุงุฏุฑ ุนุฏุฏ ูุฌูุฏ ุฏุงุฑุฏ. ุฏุฑ ุงูุฌุงุ ูุฏู ุงู ุงุณุช ฺฉู ูุฌููุน ููุงุฏุฑ ุงู ูฺฉุชูุฑ ูุญุงุณุจู ุดูุฏ. ุงฺฏุฑ ุงูุฏุงุฒู ูฺฉุชูุฑ ฺฉูฺฺฉ ุจุงุดุฏ (ฺฉูุชุฑ ุงุฒ 10000)ุ ูุชุฌู ุจู ุทูุฑ ูุนููู ูุญุงุณุจู ูโุดูุฏ. ุงูุง ุงฺฏุฑ ุงูุฏุงุฒู ูฺฉุชูุฑ ุจุฒุฑฺฏ ุจุงุดุฏุ ุงู ฺฉุงุฑ ุจู ฺูุงุฑ ุจุฎุด ุชูุณู ูโุดูุฏ ู ูุฑ ุจุฎุด ุจู ุทูุฑ ููุฒูุงู (ุจุง ุงุณุชูุงุฏู ุงุฒ `async()`) ูุญุงุณุจู ูโุดูุฏ.

### ุฌุฒุฆุงุช ฺฉุฏ:
```cpp
double comp4(vector<double>& v) {
    if (v.size() < 10000) return accum(v.begin(), v.end(), 0.0);
    
    auto v0 = &v[0];
    auto sz = v.size();
    
    // ุงุณุชูุงุฏู ุงุฒ async ุจุฑุง ูุญุงุณุจู ฺูุงุฑ ุจุฎุด ูุฎุชูู
    auto f0 = async(accum, v0, v0 + sz / 4, 0.0); // ุจุฎุด ุงูู
    auto f1 = async(accum, v0 + sz / 4, v0 + sz / 2, 0.0); // ุจุฎุด ุฏูู
    auto f2 = async(accum, v0 + sz / 2, v0 + sz * 3 / 4, 0.0); // ุจุฎุด ุณูู
    auto f3 = async(accum, v0 + sz * 3 / 4, v0 + sz, 0.0); // ุจุฎุด ฺูุงุฑู
    
    // ุฌูุนโุจูุฏ ูุชุงุฌ
    return f0.get() + f1.get() + f2.get() + f3.get();
}
```

### ุชูุถุญุงุช ุจุดุชุฑ:
- `async()` ูุธูู ุชูุณู ู ูุญุงุณุจู ููุงุฏุฑ ูฺฉุชูุฑ ุฑุง ุจู ุทูุฑ ููุฒูุงู ุงูุฌุงู ูโุฏูุฏ. ูุฑ ุจุฎุด ุงุฒ ูฺฉุชูุฑ (ุจู ฺูุงุฑ ูุณูุช ุชูุณู ุดุฏู ุงุณุช) ุจู ุทูุฑ ููุฒูุงู ุฏุฑ ฺฉ ุง ฺูุฏ ูุฎ (thread) ูุฎุชูู ูพุฑุฏุงุฒุด ูโุดูุฏ.
- ุชุงุจุน `get()` ุจุฑุง ูุฑ ฺฉ ุงุฒ ูุธุงู (ฺฉู ุจู ุตูุฑุช async ุงุฌุฑุง ุดุฏูโุงูุฏ) ุจุฑุง ุฏุฑุงูุช ูุชุฌู ููุง ุงุณุชูุงุฏู ูโุดูุฏ.
- `async()` ุจู ุทูุฑ ุฎูุฏฺฉุงุฑ ูุธุงู ุฑุง ูุฏุฑุช ูโฺฉูุฏ ู ุชุนุฏุงุฏ ูุฎโูุง ุฑุง ุจุณุชู ุจู ููุงุจุน ุณุณุชู (ูุงููุฏ ุชุนุฏุงุฏ ูุณุชูโูุง ูพุฑุฏุงุฒูุฏู) ุงูุชุฎุงุจ ูโฺฉูุฏ.

### ูุญุฏูุฏุชโูุง:
- `async()` ุจุดุชุฑ ุจุฑุง ฺฉุงุฑูุง ููุงุณุจ ุงุณุช ฺฉู ูุงุฒ ุจู ุงุดุชุฑุงฺฉโฺฏุฐุงุฑ ููุงุจุน (ูุซู ุญุงูุธู) ุจู ูุฎโูุง ูุฏุงุดุชู ุจุงุดูุฏ. ฺุฑุง ฺฉู ุฏุฑ ุตูุฑุช ฺฉู ฺูุฏ ูุธูู ูุงุฒ ุจู ุงุณุชูุงุฏู ุงุฒ ููุงุจุน ูุดุชุฑฺฉ ุฏุงุดุชู ุจุงุดูุฏุ ูุณุงุฆู ูพฺุฏูโุชุฑ ููฺูู ูููโูุง (locks) ุจู ูุฌูุฏ ูโุขุฏ ฺฉู ุฏุฑ ุงูุฌุง ุงุฒ ุขูโูุง ุงุฌุชูุงุจ ุดุฏู ุงุณุช.
- `async()` ุชุตูู ูโฺฏุฑุฏ ฺฉู ฺูุฏ ูุฎ ุจุฑุง ุงุฌุฑุง ฺฉุงุฑูุง ุงุณุชูุงุฏู ุดูุฏ ู ุดูุง ุจู ุทูุฑ ูุณุชูู ููโุชูุงูุฏ ฺฉูุชุฑู ฺฉูุฏ ฺฉู ฺูุฏ ูุฎ ุจุฑุง ุงุฌุฑุง ุงูุชุฎุงุจ ูโุดูุฏ.

### ูุฒุงุง ุงุณุชูุงุฏู ุงุฒ `async()`:
- ุจุง ุงุณุชูุงุฏู ุงุฒ `async()`, ูุงุฒ ูุณุช ฺฉู ูุณุชููุงู ุจู ูุฏุฑุช ูุฎโูุง ู ูููโูุง ูฺฉุฑ ฺฉูุฏ.
- ุชููุง ฺฉุงูุณุช ฺฉู ูุธุงู ุฑุง ูุดุฎุต ฺฉูุฏ ฺฉู ููฺฉู ุงุณุช ุจู ุตูุฑุช ููุฒูุงู ุงุฌุฑุง ุดููุฏ.
- ุงู ูโุชูุงูุฏ ุจุฑุง ูพุฑุฏุงุฒุดโูุง ุณูฺฏูุ ูุงููุฏ ูพุฑุฏุงุฒุดโูุง ุฏุงุฏูโูุง ุจุฒุฑฺฏุ ุจุณุงุฑ ููุฏ ุจุงุดุฏ.

### ูฺฉุชู ุฏฺฏุฑ:
- ุงุฒ `async()` ููุท ุจุฑุง ฺฉุงุฑูุง ฺฉู ุจู ููุงุจุน ูุดุชุฑฺฉ ูุงุฒ ูุฏุงุฑูุฏ ุงุณุชูุงุฏู ฺฉูุฏุ ุฒุฑุง ูุฏุฑุช ููุงุจุน ูุดุชุฑฺฉ ุฏุฑ ุจุฑูุงููโูุง ฺฉู ุงุฒ `async()` ุงุณุชูุงุฏู ูโฺฉููุฏุ ูโุชูุงูุฏ ูพฺุฏู ุจุงุดุฏ.

## Small Utility Components
ุชูุงู ูุคูููโูุง ฺฉุชุงุจุฎุงูู ุงุณุชุงูุฏุงุฑุฏ ุจู ุตูุฑุช ูุงุถุญ ู ุจุง ุจุฑฺุณุจโูุง ูุดุฎุตุ ูุงููุฏ ยซุธุฑูุชโูุงยป ุง ยซูุฑูุฏ/ุฎุฑูุฌยป ุงุฑุงุฆู ููโุดููุฏ. ุงู ุจุฎุด ฺูุฏ ูุซุงู ุงุฒ ูุคูููโูุง ฺฉูฺฺฉ ู ููุฏ ฺฉู ุจู ุทูุฑ ฺฏุณุชุฑุฏู ุงุณุชูุงุฏู ูโุดููุฏ ุฑุง ุงุฑุงุฆู ูโุฏูุฏ:
โข ุณุงุนุช ู ูุฏุช ุฒูุงู ุจุฑุง ุงูุฏุงุฒูโฺฏุฑ ุฒูุงู.
โข ุชูุงุจุน ููุนุ ูุงููุฏ iterator_traits ู is_arithmeticุ ุจุฑุง ุจูโุฏุณุช ุขูุฑุฏู ุงุทูุงุนุงุช ุฏุฑ ููุฑุฏ ุงููุงุน ุฏุงุฏูโูุง.
โข ุฌูุช (pair) ู ุชุงูพู (tuple) ุจุฑุง ููุงูุฏฺฏ ูุฌููุนูโูุง ฺฉูฺฺฉ ู ููฺฉู ุงุณุช ูุงููฺฏู ุงุฒ ููุงุฏุฑ.
ูฺฉุชู ุงูุฌุง ุงู ุงุณุช ฺฉู ฺฉ ุชุงุจุน ุง ููุน ุฏุงุฏู ูุฒููุงู ูุงุฒ ุจู ูพฺุฏฺฏ ุง ุงุฑุชุจุงุท ูุฒุฏฺฉ ุจุง ูุฌููุนูโุง ุงุฒ ุชูุงุจุน ู ุงููุงุน ุฏฺฏุฑ ูุฏุงุฑุฏ ุชุง ููุฏ ูุงูุน ุดูุฏ. ุงู ูุคูููโูุง ฺฉุชุงุจุฎุงูู ุจุดุชุฑ ุจู ุนููุงู ุจููฺฉโูุง ุณุงุฎุช ุจุฑุง ุชุณููุงุช ฺฉุชุงุจุฎุงููโุง ูุฏุฑุชููุฏุชุฑ ุนูู ูโฺฉููุฏุ ุงุฒ ุฌููู ุณุงุฑ ูุคูููโูุง ฺฉุชุงุจุฎุงูู ุงุณุชุงูุฏุงุฑุฏ.

## Time
ฺฉุชุงุจุฎุงูู ุงุณุชุงูุฏุงุฑุฏ ุงูฺฉุงูุงุช ุจุฑุง ฺฉุงุฑ ุจุง ุฒูุงู ูุฑุงูู ูโฺฉูุฏ. ุจู ุนููุงู ูุซุงูุ ุงู ุฑูุด ูพุงูโุง ุจุฑุง ุงูุฏุงุฒูโฺฏุฑ ุฒูุงู ุงุณุช:

```cpp
using namespace std::chrono; // ูุดุงูุฏู ยง35.2
auto t0 = high_resolution_clock::now();
do_work();
auto t1 = high_resolution_clock::now();
cout << duration_cast<milliseconds>(t1โt0).count() << "msec\n";
```

ุณุงุนุช ุฒูุงู ฺฉ **time_point** (ููุทูโุง ุงุฒ ุฒูุงู) ุฑุง ุจุฑูโฺฏุฑุฏุงูุฏ. ฺฉู ฺฉุฑุฏู ุฏู **time_point** ุงุฒ ููุ ฺฉ **duration** (ูุฏุช ุฒูุงู) ุฑุง ุจู ุดูุง ูโุฏูุฏ. ุณุงุนุชโูุง ูุฎุชูู ูุชุงุฌ ุฎูุฏ ุฑุง ุฏุฑ ูุงุญุฏูุง ูุฎุชูู ุฒูุงู ูโุฏููุฏ (ุณุงุนุช ฺฉู ูู ุงุณุชูุงุฏู ฺฉุฑุฏูโุงูุ ูุงููุซุงูู ุฑุง ุงูุฏุงุฒูโฺฏุฑ ูโฺฉูุฏ)ุ ุจูุงุจุฑุงู ูุนูููุงู ุงุฏู ุฎูุจ ุงุณุช ฺฉู ูุฏุช ุฒูุงู ุฑุง ุจู ฺฉ ูุงุญุฏ ุดูุงุฎุชูโุดุฏู ุชุจุฏู ฺฉูุฏ. ุงู ููุงู ฺฉุงุฑ ุงุณุช ฺฉู `duration_cast` ุงูุฌุงู ูโุฏูุฏ.

ุงูฺฉุงูุงุช ฺฉุชุงุจุฎุงูู ุงุณุชุงูุฏุงุฑุฏ ุจุฑุง ฺฉุงุฑ ุจุง ุฒูุงู ุฏุฑ ุฒุฑุจุฎุด `std::chrono` ุฏุฑ ูุฏุฑ `<chrono>` ูพุฏุง ูโุดูุฏ (ยง35.2).

ุฏุฑ ููุฑุฏ ยซฺฉุงุฑุงยป ฺฉุฏ ุงุธูุงุฑ ูุธุฑ ูฺฉูุฏ ูฺฏุฑ ุงูฺฉู ุงุจุชุฏุง ุงูุฏุงุฒูโฺฏุฑโูุง ุฒูุงู ุงูุฌุงู ุฏุงุฏู ุจุงุดุฏ. ุญุฏุณโูุง ูุฑุจูุท ุจู ุนููฺฉุฑุฏ ฺฉุฏ ูุนูููุงู ุบุฑูุงุจู ุงุนุชูุงุฏ ูุณุชูุฏ.

## Type Functions
ฺฉ ุชุงุจุน ููุน (type function) ุชุงุจุน ุงุณุช ฺฉู ุฏุฑ ุฒูุงู ฺฉุงููพุงู ุจุง ุชูุฌู ุจู ฺฉ ููุน ุจู ุนููุงู ุขุฑฺฏููุงู ุง ุจุงุฒฺฏุดุช ููุนุ ุงุฑุฒุงุจ ูโุดูุฏ. ฺฉุชุงุจุฎุงูู ุงุณุชุงูุฏุงุฑุฏ ุงููุงุน ูุฎุชูู ุงุฒ ุชูุงุจุน ููุน ุฑุง ุจุฑุง ฺฉูฺฉ ุจู ูพุงุฏูโุณุงุฒโฺฉููุฏฺฏุงู ฺฉุชุงุจุฎุงูู ู ุจุฑูุงููโููุณุงู ุจู ุทูุฑ ฺฉู ูุฑุงูู ฺฉุฑุฏู ุงุณุช ุชุง ฺฉุฏ ุจููุณูุฏ ฺฉู ุงุฒ ุฌูุจูโูุง ุฒุจุงูุ ฺฉุชุงุจุฎุงูู ุงุณุชุงูุฏุงุฑุฏ ู ฺฉุฏ ุจู ุทูุฑ ฺฉู ุจูุฑูโุจุฑุฏุงุฑ ฺฉูุฏ.

ุจุฑุง ุงููุงุน ุนุฏุฏุ `numeric_limits` ุงุฒ ูุฏุฑ `<limits>` ุงุทูุงุนุงุช ููุฏ ูุฎุชูู ุฑุง ุงุฑุงุฆู ูโุฏูุฏ (ยง5.6.5). ุจุฑุง ูุซุงู:

```cpp
constexpr float min = numeric_limits<float>::min(); // ฺฉูฺฺฉุชุฑู ุนุฏุฏ ูุซุจุช float (ยง40.2)
```

ุจู ุทูุฑ ูุดุงุจูุ ุงูุฏุงุฒู ุงุดุงุก ูโุชูุงูุฏ ุชูุณุท ุนููฺฏุฑ ุฏุงุฎู `sizeof` ูพุฏุง ุดูุฏ (ยง2.2.2). ุจุฑุง ูุซุงู:

```cpp
constexpr int szi = sizeof(int); // ุชุนุฏุงุฏ ุจุงุชโูุง ฺฉ int
```

ุงู ุชูุงุจุน ููุน ุจุฎุด ุงุฒ ูฺฉุงูุฒูโูุง C++ ุจุฑุง ูุญุงุณุจุงุช ุฏุฑ ุฒูุงู ฺฉุงููพุงู ูุณุชูุฏ ฺฉู ุงูฺฉุงู ุจุฑุฑุณ ุฏููโุชุฑ ููุน ู ุนููฺฉุฑุฏ ุจูุชุฑ ุฑุง ูุฑุงูู ูโฺฉููุฏุ ฺุฒ ฺฉู ุฏุฑ ุบุฑ ุงู ุตูุฑุช ุงูฺฉุงูโูพุฐุฑ ูุจูุฏ. ุงุณุชูุงุฏู ุงุฒ ฺูู ูฺฺฏโูุง ุงุบูุจ ุจู ูุงู ุจุฑูุงููโููุณ ูุชุง (metaprogramming) ุง (ุฒูุงู ฺฉู ุงูฺฏููุง (templates) ุฏุฎู ูุณุชูุฏ) ุจุฑูุงููโููุณ ูุชุง ุงูฺฏู (template metaprogramming) ุดูุงุฎุชู ูโุดูุฏ (ูุตู 28). ุฏุฑ ุงูุฌุงุ ูู ุชููุง ุฏู ูฺฺฏ ฺฉู ุชูุณุท ฺฉุชุงุจุฎุงูู ุงุณุชุงูุฏุงุฑุฏ ูุฑุงูู ุดุฏูโุงูุฏ ุฑุง ูุนุฑู ูโฺฉูู: `iterator_traits` (ยง5.4.2.1) ู `type predicates` (ยง5.4.2.2).

## iterator_traits
ุชุงุจุน `sort()` ุฏุฑ ฺฉุชุงุจุฎุงูู ุงุณุชุงูุฏุงุฑุฏ ฺฉ ุฌูุช ุงุฒ ุชฺฉุฑุงุฑฺฏุฑูุง (iterators) ุฑุง ูโฺฏุฑุฏ ฺฉู ุจุงุฏ ฺฉ ุฏูุจุงูู ุฑุง ุชุนุฑู ฺฉููุฏ (ยง4.5). ุนูุงูู ุจุฑ ุงูุ ุขู ุชฺฉุฑุงุฑฺฏุฑูุง ุจุงุฏ ุฏุณุชุฑุณ ุชุตุงุฏู ุจู ุขู ุฏูุจุงูู ุฑุง ูุฑุงูู ฺฉููุฏุ ุนู ุจุงุฏ ุชฺฉุฑุงุฑฺฏุฑูุง **ุฏุณุชุฑุณ ุชุตุงุฏู** (random-access iterators) ุจุงุดูุฏ. ุจุฑุฎ ุงุฒ ฺฉุงูุชูุฑูุง ูุงููุฏ `forward_list` ุงู ุงูฺฉุงู ุฑุง ูุฑุงูู ููโฺฉููุฏ. ุจูโูฺูุ ฺฉ `forward_list` ฺฉ ูุณุช ูพููุฏ ฺฉโุทุฑูู ุงุณุช ฺฉู ุฏุฑ ุขู ุงุณุชูุงุฏู ุงุฒ ุงูุฏุณโฺฏุฐุงุฑ ูุฒููโุจุฑ ุฎูุงูุฏ ุจูุฏ ู ูฺ ุฑูุด ูุนููู ุจุฑุง ุงุฑุฌุงุน ุจู ฺฉ ุนูุตุฑ ูุจู ูุฌูุฏ ูุฏุงุฑุฏ. ุจุง ุงู ุญุงูุ ูุงููุฏ ุจุดุชุฑ ฺฉุงูุชูุฑูุงุ `forward_list` ุชฺฉุฑุงุฑฺฏุฑูุง **ุฌููุจุฑูุฏู** (forward iterators) ุฑุง ุงุฑุงุฆู ูโุฏูุฏ ฺฉู ูโุชูุงู ุงุฒ ุขูโูุง ุจุฑุง ูพูุงุด ุฏูุจุงูู ุจุง ุงุณุชูุงุฏู ุงุฒ ุงูฺฏูุฑุชูโูุง ู ุฏุณุชูุฑุงุช `for` ุงุณุชูุงุฏู ฺฉุฑุฏ (ยง33.1.1).

ฺฉุชุงุจุฎุงูู ุงุณุชุงูุฏุงุฑุฏ ฺฉ ูฺฉุงูุฒู ุจู ูุงู `iterator_traits` ูุฑุงูู ูโฺฉูุฏ ฺฉู ุจู ูุง ุงู ุงูฺฉุงู ุฑุง ูโุฏูุฏ ฺฉู ุจุฑุฑุณ ฺฉูู ฺู ููุน ุชฺฉุฑุงุฑฺฏุฑ ูพุดุชุจุงู ูโุดูุฏ. ุจุง ุชูุฌู ุจู ุงูุ ูโุชูุงูู ุชุงุจุน `sort()` ุจุฑุง ุฏูุจุงููโูุง ุฑุง ุงุฒ ยง4.5.6 ุจูโุทูุฑ ุจูุชุฑ ุชูุณุนู ุฏูู ุชุง ูู `vector` ู ูู `forward_list` ุฑุง ุจูพุฐุฑุฏ. ุจุฑุง ูุซุงู:

```cpp
void test(vector<string>& v, forward_list<int>& lst)
{
    sort(v); // ูุฑุชุจโุณุงุฒ ูฺฉุชูุฑ
    sort(lst); // ูุฑุชุจโุณุงุฒ ูุณุช ูพููุฏ ฺฉโุทุฑูู
}
```

ุชฺฉูฺฉโูุง ฺฉู ุจุฑุง ุงูุฌุงู ุงู ฺฉุงุฑ ูุงุฒ ุงุณุช ูุนูููุงู ููุฏ ูุณุชูุฏ. ุงุจุชุฏุงุ ูู ุฏู ุชุงุจุน ฺฉูฺฉ ูโููุณู ฺฉู ฺฉ ุขุฑฺฏููุงู ุงุถุงู ูโฺฏุฑูุฏ ฺฉู ูุดุงู ูโุฏูุฏ ุขุง ูุฑุงุฑ ุงุณุช ุจุฑุง ุชฺฉุฑุงุฑฺฏุฑูุง ุฏุณุชุฑุณ ุชุตุงุฏู ุง ุชฺฉุฑุงุฑฺฏุฑูุง ุฌููุจุฑูุฏู ุงุณุชูุงุฏู ุดููุฏ. ูุณุฎูโุง ฺฉู ุชฺฉุฑุงุฑฺฏุฑูุง ุฏุณุชุฑุณ ุชุตุงุฏู ุฑุง ูโฺฏุฑุฏุ ุณุงุฏู ุงุณุช:

```cpp
template<typename Ran> // ุจุฑุง ุชฺฉุฑุงุฑฺฏุฑูุง ุฏุณุชุฑุณ ุชุตุงุฏู
void sort_helper(Ran beg, Ran end, random_access_iterator_tag) // ูโุชูุงูู ุงุฒ [beg:end) ุงูุฏุณโฺฏุฐุงุฑ ฺฉูู
{
    sort(beg,end); // ููุท ุขู ุฑุง ูุฑุชุจ ูโฺฉูู
}
```

ูุณุฎูโุง ฺฉู ุจุฑุง ุชฺฉุฑุงุฑฺฏุฑูุง ุฌููุจุฑูุฏู ุงุณุช ุชูุฑุจุงู ุจู ููู ุณุงุฏฺฏ ุงุณุชุ ููุท ูุณุช ุฑุง ุจู ฺฉ ูฺฉุชูุฑ ฺฉูพ ูโฺฉููุ ูุฑุชุจ ูโฺฉูู ู ุฏูุจุงุฑู ฺฉูพ ูโฺฉูู:

```cpp
template<typename For> // ุจุฑุง ุชฺฉุฑุงุฑฺฏุฑูุง ุฌููุจุฑูุฏู
void sort_helper(For beg, For end, forward_iterator_tag) // ูโุชูุงูู ุงุฒ [beg:end) ุนุจูุฑ ฺฉูู
{
    vector<decltype(*beg)> v {beg,end}; // ฺฉ ูฺฉุชูุฑ ุงุฒ [beg:end) ุงุฌุงุฏ ูโฺฉูู
    sort(v.begin(),v.end());
    copy(v.begin(),v.end(),beg); // ุนูุงุตุฑ ุฑุง ุฏูุจุงุฑู ฺฉูพ ูโฺฉูู
}
```

`decltype()` ฺฉ ุชุงุจุน ููุน ุฏุงุฎู ุงุณุช ฺฉู ููุน ุงุนูุงูโุดุฏู ุขุฑฺฏููุงู ุฎูุฏ ุฑุง ุจุฑูโฺฏุฑุฏุงูุฏ (ยง6.3.6.3). ุจูุงุจุฑุงูุ `v` ฺฉ ูฺฉุชูุฑ ุงุฒ ููุน `X` ุงุณุช ฺฉู `X` ููุน ุนูุตุฑ ุฏูุจุงูู ูุฑูุฏ ุงุณุช.

ุฌุงุฏู ูุงูุน "ููุน" ุฏุฑ ุงูุชุฎุงุจ ุชูุงุจุน ฺฉูฺฉ ุงุณุช:

```cpp
template<typename C>
void sort(C& c)
{
    using Iter = Iterator_type<C>;
    sort_helper(c.begin(),c.end(),Iterator_category<Iter>{});
}
```

ุฏุฑ ุงูุฌุงุ ูู ุงุฒ ุฏู ุชุงุจุน ููุน ุงุณุชูุงุฏู ูโฺฉูู: `Iterator_type<C>` ููุน ุชฺฉุฑุงุฑฺฏุฑ `C` ุฑุง ุจุฑูโฺฏุฑุฏุงูุฏ (ุนู `C::iterator`) ู ุณูพุณ `Iterator_category<Iter>{}` ฺฉ ููุฏุงุฑ "ุจุฑฺุณุจ" ูโุณุงุฒุฏ ฺฉู ููุน ุชฺฉุฑุงุฑฺฏุฑ ฺฉู ูุฑุงูู ุดุฏู ุฑุง ูุดุงู ูโุฏูุฏ:
- `std::random_access_iterator_tag` ุงฺฏุฑ ุชฺฉุฑุงุฑฺฏุฑ `C` ุฏุณุชุฑุณ ุชุตุงุฏู ุฑุง ูพุดุชุจุงู ฺฉูุฏ.
- `std::forward_iterator_tag` ุงฺฏุฑ ุชฺฉุฑุงุฑฺฏุฑ `C` ุชููุง ูพูุงุด ุฌูู ุฑุง ูพุดุชุจุงู ฺฉูุฏ.

ุจุง ุชูุฌู ุจู ุงูุ ูโุชูุงูู ุจู ุฏู ุงูฺฏูุฑุชู ูุฑุชุจโุณุงุฒ ุฏุฑ ุฒูุงู ฺฉุงููพุงู ุงูุชุฎุงุจ ฺฉูู. ุงู ุชฺฉูฺฉ ฺฉู ุจู ุขู **ุงุฑุณุงู ุจุฑฺุณุจ** (tag dispatch) ฺฏูุชู ูโุดูุฏุ ฺฉ ุงุฒ ุชฺฉูฺฉโูุง ุงุณุช ฺฉู ุฏุฑ ฺฉุชุงุจุฎุงูู ุงุณุชุงูุฏุงุฑุฏ ู ุฌุงูุง ุฏฺฏุฑ ุจุฑุง ุจูุจูุฏ ุงูุนุทุงูโูพุฐุฑ ู ุนููฺฉุฑุฏ ุงุณุชูุงุฏู ูโุดูุฏ.

ูพุดุชุจุงู ฺฉุชุงุจุฎุงูู ุงุณุชุงูุฏุงุฑุฏ ุจุฑุง ุชฺฉูฺฉโูุง ุงุณุชูุงุฏู ุงุฒ ุชฺฉุฑุงุฑฺฏุฑูุงุ ูุงููุฏ ุงุฑุณุงู ุจุฑฺุณุจุ ุฏุฑ ูุงูุจ ฺฉ ุงูฺฏู ฺฉูุงุณ ุณุงุฏู ุจู ูุงู `iterator_traits` ุงุฒ ูุฏุฑ `<iterator>` (ยง33.1.3) ุงุฑุงุฆู ุดุฏู ุงุณุช. ุงู ุงูฺฉุงู ุฑุง ูุฑุงูู ูโฺฉูุฏ ุชุง ุชูุงุจุน ููุน ููุฑุฏ ุงุณุชูุงุฏู ุฏุฑ `sort()` ุจู ุณุงุฏฺฏ ุชุนุฑู ุดููุฏ:

```cpp
template<typename C>
using Iterator_type = typename C::iterator; // ููุน ุชฺฉุฑุงุฑฺฏุฑ C
template<typename Iter>
using Iterator_category = typename std::iterator_traits<Iter>::iterator_category; // ุฏุณุชูโุจูุฏ Iter
```

ุงฺฏุฑ ููโุฎูุงูุฏ ุจุฏุงูุฏ ฺู ููุน "ุฌุงุฏู ููุน ุฏุฑ ุฒูุงู ฺฉุงููพุงู" ุจุฑุง ูุฑุงูู ฺฉุฑุฏู ูฺฺฏโูุง ฺฉุชุงุจุฎุงูู ุงุณุชุงูุฏุงุฑุฏ ุงุณุชูุงุฏู ุดุฏู ุงุณุชุ ูโุชูุงูุฏ ุงุฒ ุงูฺฉุงูุงุช ูุงููุฏ `iterator_traits` ุตุฑูโูุธุฑ ฺฉูุฏ. ุงูุง ุฏุฑ ุงู ุตูุฑุชุ ูุงุฏุฑ ูุฎูุงูุฏ ุจูุฏ ุงุฒ ุชฺฉูฺฉโูุง ฺฉู ุขูโูุง ูพุดุชุจุงู ูโฺฉููุฏ ุจุฑุง ุจูุจูุฏ ฺฉุฏ ุฎูุฏ ุงุณุชูุงุฏู ฺฉูุฏ.

---

ุงู ูุชู ุจู ุจุฑุฑุณ ูุญูู ุงุณุชูุงุฏู ุงุฒ **ุชุงุจุน sort()** ุฏุฑ ฺฉุชุงุจุฎุงูู ุงุณุชุงูุฏุงุฑุฏ C++ ู ูุญูู ุงูุฌุงู ุจูููโุณุงุฒโูุง ูุฎุชูู ุฏุฑ ุงุณุชูุงุฏู ุงุฒ ุขู ุจุฑุง ุงููุงุน ูุฎุชูู ุชฺฉุฑุงุฑฺฏุฑูุง (iterators) ูโูพุฑุฏุงุฒุฏ. ุฏุฑ ุงุฏุงููุ ุชูุถุญ ุฏูู ู ุณุงุฏูโุชุฑ ุงุฒ ููุงูู ุจุงูโุดุฏู ุฏุฑ ูุชู ูโุฏูู.

### ูุฏู ฺฉู:
ฺฉุชุงุจุฎุงูู ุงุณุชุงูุฏุงุฑุฏ C++ ุชุงุจุน `sort()` ุฑุง ุจุฑุง ูุฑุชุจโุณุงุฒ ุฏูุจุงููโุง ุงุฒ ุฏุงุฏูโูุง ูุฑุงูู ูโฺฉูุฏ. ุงู ุชุงุจุน ุฏู **ุชฺฉุฑุงุฑฺฏุฑ** (iterators) ูโฺฏุฑุฏ ฺฉู ูุญุฏูุฏูโุง ุงุฒ ุฏุงุฏูโูุง ุฑุง ูุดุฎุต ูโฺฉููุฏ. ุงู ุชฺฉุฑุงุฑฺฏุฑูุง ุจุงุฏ ุงุฒ ููุน **ุฏุณุชุฑุณ ุชุตุงุฏู** (random-access) ุจุงุดูุฏ. ุจู ุงู ูุนู ฺฉู ูโุชูุงู ุจู ุฑุงุญุช ุจู ูุฑ ุนูุตุฑ ุงุฒ ุฏูุจุงูู ุจุง ุงุณุชูุงุฏู ุงุฒ ุงูุฏุณโฺฏุฐุงุฑ ุฏุณุชุฑุณ ูพุฏุง ฺฉุฑุฏ.

ุงูุง ุจุฑุฎ ุงุฒ ฺฉุงูุชูุฑูุงุ ูุงููุฏ `forward_list`ุ ุงู ุงูฺฉุงู ุฑุง ูุฏุงุฑูุฏ. ฺุฑุงุ ฺูู `forward_list` ฺฉ **ูุณุช ูพููุฏ ฺฉโุทุฑูู** ุงุณุช ฺฉู ููโุชูุงู ุจู ุฑุงุญุช ุจู ุนูุงุตุฑ ูุจู ุฏุณุชุฑุณ ูพุฏุง ฺฉุฑุฏ ู ููโุชูุงู ุงุฒ ุงูุฏุณโฺฏุฐุงุฑ ุงุณุชูุงุฏู ฺฉุฑุฏ. ุงู ุจู ุงู ูุนู ุงุณุช ฺฉู ุจุฑุง ุงุณุชูุงุฏู ุงุฒ `sort()` ุจุงุฏ ุฑุงูโุญูโูุง ูพุฏุง ฺฉูู.

### ุฑุงูโุญู:
ุจุฑุง ุญู ุงู ูุดฺฉูุ ฺฉุชุงุจุฎุงูู ุงุณุชุงูุฏุงุฑุฏ C++ ุงุฒ **ุชฺฉูฺฉโูุง ุจุฑูุงููโููุณ ูุชุง** (Metaprogramming) ู **ุจุฑฺุณุจโูุง ููุน** (Type Tags) ุงุณุชูุงุฏู ูโฺฉูุฏ. ูุฏู ุงู ุงุณุช ฺฉู ุจุง ุชูุฌู ุจู ููุน ุชฺฉุฑุงุฑฺฏุฑุ ุจูโุทูุฑ ุฎูุฏฺฉุงุฑ ุชุตูู ุจฺฏุฑู ฺฉู ุงุฒ ฺฉุฏุงู ุฑูุด ูุฑุชุจโุณุงุฒ ุงุณุชูุงุฏู ฺฉูู.

#### 1. **ุชูุงูุช ุชฺฉุฑุงุฑฺฏุฑูุง**:
- **ุชฺฉุฑุงุฑฺฏุฑูุง ุฏุณุชุฑุณ ุชุตุงุฏู** (ูุซู ุชฺฉุฑุงุฑฺฏุฑูุง `vector`) ุงูฺฉุงู ุฏุณุชุฑุณ ุจู ูุฑ ุนูุตุฑ ุจุง ุงุณุชูุงุฏู ุงุฒ ุงูุฏุณโฺฏุฐุงุฑ ุฑุง ูโุฏููุฏ.
- **ุชฺฉุฑุงุฑฺฏุฑูุง ุฌููุจุฑูุฏู** (ูุซู ุชฺฉุฑุงุฑฺฏุฑูุง `forward_list`) ููุท ูโุชูุงููุฏ ุฏูุจุงูู ุฑุง ุจู ุฌูู ูพูุงุด ฺฉููุฏ ู ุงุฒ ุงูุฏุณโฺฏุฐุงุฑ ูพุดุชุจุงู ููโฺฉููุฏ.

#### 2. **ุชุงุจุน ฺฉูฺฉ ุจุฑุง ุชฺฉุฑุงุฑฺฏุฑูุง ุฏุณุชุฑุณ ุชุตุงุฏู**:
ุจุฑุง ุฏูุจุงููโูุง ฺฉู ุงุฒ ุชฺฉุฑุงุฑฺฏุฑูุง ุฏุณุชุฑุณ ุชุตุงุฏู ุงุณุชูุงุฏู ูโฺฉููุฏุ ูโุชูุงูู ุงุฒ ูุฑุชุจโุณุงุฒ ุณุงุฏู ุงุณุชูุงุฏู ฺฉูู:

```cpp
template<typename Ran>  // ุจุฑุง ุชฺฉุฑุงุฑฺฏุฑูุง ุฏุณุชุฑุณ ุชุตุงุฏู
void sort_helper(Ran beg, Ran end, random_access_iterator_tag) {
    sort(beg, end);  // ูุฑุชุจโุณุงุฒ ุฏูุจุงูู ุจุง sort ุงุณุชุงูุฏุงุฑุฏ
}
```

ุงู ุชุงุจุน ุจุณุงุฑ ุณุงุฏู ุงุณุช. ฺูู ูโุชูุงูู ุจู ูุฑ ุนูุตุฑ ุฏูุจุงูู ุฏุณุชุฑุณ ุชุตุงุฏู ุฏุงุดุชู ุจุงุดูุ ฺฉุงู ุงุณุช ุงุฒ `sort()` ุงุณุชูุงุฏู ฺฉูู ุชุง ุฏูุจุงูู ูุฑุชุจ ุดูุฏ.

#### 3. **ุชุงุจุน ฺฉูฺฉ ุจุฑุง ุชฺฉุฑุงุฑฺฏุฑูุง ุฌููุจุฑูุฏู**:
ุจุฑุง ุฏูุจุงููโูุง ฺฉู ุงุฒ ุชฺฉุฑุงุฑฺฏุฑูุง ุฌููุจุฑูุฏู ุงุณุชูุงุฏู ูโฺฉููุฏ (ูุซู `forward_list`)ุ ฺูู ููโุชูุงู ุงุฒ ุงูุฏุณโฺฏุฐุงุฑ ุงุณุชูุงุฏู ฺฉุฑุฏุ ุจุงุฏ ฺฉ ุฑุงูโุญู ุฏฺฏุฑ ูพุฏุง ฺฉูู: ุงุจุชุฏุง ุฏูุจุงูู ุฑุง ุจู ฺฉ **ูฺฉุชูุฑ** ุชุจุฏู ูโฺฉููุ ุณูพุณ ุขู ุฑุง ูุฑุชุจ ฺฉุฑุฏู ู ุฏูุจุงุฑู ุจู ุฏูุจุงูู ุงุตู ฺฉูพ ูโฺฉูู:

```cpp
template<typename For>  // ุจุฑุง ุชฺฉุฑุงุฑฺฏุฑูุง ุฌููุจุฑูุฏู
void sort_helper(For beg, For end, forward_iterator_tag) {
    vector<decltype(*beg)> v {beg, end};  // ุชุจุฏู ุจู ูฺฉุชูุฑ
    sort(v.begin(), v.end());  // ูุฑุชุจโุณุงุฒ ูฺฉุชูุฑ
    copy(v.begin(), v.end(), beg);  // ฺฉูพ ฺฉุฑุฏู ุจู ุฏูุจุงูู ุงุตู
}
```

ุฏุฑ ุงูุฌุงุ ุงุฒ ุชุงุจุน `decltype()` ุจุฑุง ุชุนู ููุน ุฏุงุฏู ุงุณุชูุงุฏู ูโฺฉูู ู ุฏูุจุงูู ุฑุง ุจู ูฺฉุชูุฑ ุชุจุฏู ูโฺฉููุ ุณูพุณ ูุฑุชุจ ูโฺฉูู ู ุฏูุจุงุฑู ุขู ุฑุง ุจู ุฏูุจุงูู ุงุตู ฺฉูพ ูโฺฉูู.

#### 4. **ุงูุชุฎุงุจ ููุงุณุจโุชุฑู ุชุงุจุน ุจุฑ ุงุณุงุณ ููุน ุชฺฉุฑุงุฑฺฏุฑ**:
ุจุฑุง ุงูฺฉู ุจูโุทูุฑ ุฎูุฏฺฉุงุฑ ุชุงุจุน ููุงุณุจ ุจุฑุง ูุฑ ููุน ุชฺฉุฑุงุฑฺฏุฑ ุงูุชุฎุงุจ ุดูุฏุ ุงุฒ ูฺฺฏโูุง **ููุน** ุฏุฑ C++ ุงุณุชูุงุฏู ูโฺฉูู:

```cpp
template<typename C>
void sort(C& c) {
    using Iter = Iterator_type<C>;  // ููุน ุชฺฉุฑุงุฑฺฏุฑ C
    sort_helper(c.begin(), c.end(), Iterator_category<Iter>{});
}
```

ุฏุฑ ุงูุฌุง:
- **`Iterator_type<C>`** ููุน ุชฺฉุฑุงุฑฺฏุฑ ฺฉุงูุชูุฑ `C` ุฑุง ูุดุฎุต ูโฺฉูุฏ (ูุซู `C::iterator`).
- **`Iterator_category<Iter>`** ููุน ุชฺฉุฑุงุฑฺฏุฑ ุฑุง ุดูุงุณุง ูโฺฉูุฏ ู ุจูโุทูุฑ ุฎูุฏฺฉุงุฑ ุจุฑฺุณุจ ูุฑุจูุท ุจู ุขู ุฑุง ุจู ุชุงุจุน ฺฉูฺฉ ุงุฑุณุงู ูโฺฉูุฏ.

#### 5. **ุจุฑฺุณุจโูุง ููุน (Tag Dispatch)**:
ุงุฒ ุขูุฌุง ฺฉู ุชฺฉุฑุงุฑฺฏุฑูุง ููฺฉู ุงุณุช ุฏุณุชุฑุณ ุชุตุงุฏู ุง ุฌููุจุฑูุฏู ุฏุงุดุชู ุจุงุดูุฏุ ุจุฑุง ุงูุชุฎุงุจ ุชุงุจุน ููุงุณุจ ุฏุฑ ุฒูุงู ฺฉุงููพุงู ุงุฒ **ุจุฑฺุณุจโูุง ููุน** ุงุณุชูุงุฏู ูโฺฉูู. ุงู ุจุฑฺุณุจโูุง ุนุจุงุฑุชูุฏ ุงุฒ:
- `random_access_iterator_tag` ุจุฑุง ุชฺฉุฑุงุฑฺฏุฑูุง ุฏุณุชุฑุณ ุชุตุงุฏู
- `forward_iterator_tag` ุจุฑุง ุชฺฉุฑุงุฑฺฏุฑูุง ุฌููุจุฑูุฏู

ุงู ุจุฑฺุณุจโูุง ุจูโุทูุฑ ุฎูุฏฺฉุงุฑ ุงูุชุฎุงุจ ูโุดููุฏ ู ุจู ุชุงุจุน ฺฉูฺฉ ุงุฑุณุงู ูโุดููุฏ ุชุง ูุฑุชุจโุณุงุฒ ููุงุณุจ ุงูุฌุงู ุดูุฏ.

#### 6. **ุงุณุชูุงุฏู ุงุฒ `iterator_traits`**:
ฺฉุชุงุจุฎุงูู ุงุณุชุงูุฏุงุฑุฏ C++ ุงู ุงูฺฉุงู ุฑุง ูุฑุงูู ฺฉุฑุฏู ุงุณุช ฺฉู ุจุชูุงูู ููุน ุชฺฉุฑุงุฑฺฏุฑ ู ุฏุณุชูโุจูุฏ ุขู ุฑุง ุดูุงุณุง ฺฉูู. ุงู ฺฉุงุฑ ุชูุณุท `iterator_traits` ุงูุฌุงู ูโุดูุฏ ฺฉู ฺฉ ูุงูุจ ฺฉูุงุณ ุณุงุฏู ุงุฒ ูุฏุฑ `<iterator>` ุงุณุช:

```cpp
template<typename C>
using Iterator_type = typename C::iterator;  // ููุน ุชฺฉุฑุงุฑฺฏุฑ C
template<typename Iter>
using Iterator_category = typename std::iterator_traits<Iter>::iterator_category;  // ุฏุณุชูโุจูุฏ ุชฺฉุฑุงุฑฺฏุฑ
```

ุงู ฺฉุฏูุง ุจูโุทูุฑ ุฎูุฏฺฉุงุฑ ููุน ุชฺฉุฑุงุฑฺฏุฑ ู ุฏุณุชูโุจูุฏ ุขู ุฑุง ุดูุงุณุง ูโฺฉููุฏ ู ุจุฑ ุงุณุงุณ ุขู ูุฑุชุจโุณุงุฒ ููุงุณุจ ุฑุง ุงูุชุฎุงุจ ูโฺฉููุฏ.

### ูุชุฌู:
ุจุง ุงุณุชูุงุฏู ุงุฒ ุงู ุชฺฉูฺฉโูุงุ ฺฉุฏ ูุง ูุงุฏุฑ ุงุณุช ุจูโุทูุฑ ุฎูุฏฺฉุงุฑ ููุน ุชฺฉุฑุงุฑฺฏุฑ ุฑุง ุดูุงุณุง ฺฉุฑุฏู ู ุงุฒ ูุฑุชุจโุณุงุฒ ุจููู ุจุฑุง ุขู ุงุณุชูุงุฏู ฺฉูุฏ. ุงู ุชฺฉูฺฉโูุง ุจู ุจุฑูุงููโููุณุงู ุงู ุงูฺฉุงู ุฑุง ูโุฏููุฏ ฺฉู ฺฉุฏ ุฎูุฏ ุฑุง ุจูโฺฏูููโุง ุจููุณูุฏ ฺฉู ูู ุจุฑุง ุชฺฉุฑุงุฑฺฏุฑูุง ุฏุณุชุฑุณ ุชุตุงุฏู ู ูู ุจุฑุง ุชฺฉุฑุงุฑฺฏุฑูุง ุฌููุจุฑูุฏู ุจููู ุจุงุดุฏ.

ุงู ุฑูุด **ุจุฑูุงููโููุณ ูุชุง** ุง **Meta-programming** ูุงูุฏู ูโุดูุฏุ ุฒุฑุง ุชุตููุงุช ุฏุฑ ุฒูุงู ฺฉุงููพุงู ฺฏุฑูุชู ูโุดููุฏุ ูู ุฏุฑ ุฒูุงู ุงุฌุฑุง. ุงู ุชฺฉูฺฉ ุจู ุจูููโุณุงุฒ ุนููฺฉุฑุฏ ู ุงูุฒุงุด ุงูุนุทุงูโูพุฐุฑ ฺฉุฏ ฺฉูฺฉ ูโฺฉูุฏ.

## Type Predicates
ฺฉ ูพุดโุดุฑุท ููุน ฺฉุชุงุจุฎุงูู ุงุณุชุงูุฏุงุฑุฏ ฺฉ ุชุงุจุน ููุน ุณุงุฏู ุงุณุช ฺฉู ุจู ฺฉ ุณูุงู ุจูุงุฏ ุฏุฑ ููุฑุฏ ุงููุงุน ูพุงุณุฎ ูโุฏูุฏ. ุจู ุนููุงู ูุซุงู:
```cpp
bool b1 = Is_arithmetic<int>(); // ุจููุ int ฺฉ ููุน ุญุณุงุจ ุงุณุช
bool b2 = Is_arithmetic<string>(); // ููุ std::string ฺฉ ููุน ุญุณุงุจ ูุณุช
```
ุงู ูพุดโุดุฑุทโูุง ุฏุฑ `<type_traits>` ุงูุช ูโุดููุฏ ู ุฏุฑ ยง35.4.1 ุชูุตู ุดุฏูโุงูุฏ. ุณุงุฑ ูุซุงูโูุง ุดุงูู `is_class`ุ `is_pod`ุ `is_literal_type`ุ `has_virtual_destructor` ู `is_base_of` ูุณุชูุฏ. ุงูโูุง ุฒูุงู ฺฉู ูุง ุชููพูุช ูโููุณูุ ุจุณุงุฑ ููุฏ ูุณุชูุฏ. ุจู ุนููุงู ูุซุงู:
```cpp
template<typename Scalar>
class complex {
    Scalar re, im;
public:
    static_assert(Is_arithmetic<Scalar>(), "ูุชุงุณููุ ูู ููุท ุงุฒ ูพฺุฏูโูุง ุงุฒ ุงููุงุน ุญุณุงุจ ูพุดุชุจุงู ูโฺฉูู");
    // ...
};
```
ุจุฑุง ุจูุจูุฏ ุฎูุงูุง ูุณุจุช ุจู ุงุณุชูุงุฏู ูุณุชูู ุงุฒ ฺฉุชุงุจุฎุงูู ุงุณุชุงูุฏุงุฑุฏุ ูู ฺฉ ุชุงุจุน ููุน ุชุนุฑู ฺฉุฑุฏูโุงู:
```cpp
template<typename T>
constexpr bool Is_arithmetic()
{
    return std::is_arithmetic<T>::value;
}
```
ุจุฑูุงููโูุง ูุฏู ุงุฒ `::value` ุจู ุทูุฑ ูุณุชูู ุจู ุฌุง `()` ุงุณุชูุงุฏู ูโฺฉููุฏุ ุงูุง ูู ุงู ฺฉุงุฑ ุฑุง ูุณุจุชุงู ุฒุดุช ูโุฏุงูู ู ุฌุฒุฆุงุช ูพุงุฏูโุณุงุฒ ุฑุง ุงูุดุง ูโฺฉูุฏ.

## pair and tuple
ฺฏุงู ุงููุงุช ูุงุฒ ุฏุงุฑู ุจู ุฏุงุฏูโูุง ฺฉู ุตุฑูุงู ุฏุงุฏู ูุณุชูุฏุ ุนู ูุฌููุนูโุง ุงุฒ ููุงุฏุฑุ ูู ฺฉ ุดุก ุงุฒ ฺฉ ฺฉูุงุณ ุจุง ูุนูุง ูุดุฎุต ู ููุงูู ุฎุงุต ฺฉู ุจุงุฏ ุฏุฑ ููุฑุฏ ููุฏุงุฑ ุขู ุฑุนุงุช ุดูุฏ (ุจุฎุดโูุง 2.4.3.2 ู 13.4). ุฏุฑ ฺูู ููุงุฑุฏุ ูโุชูุงูู ฺฉ ุณุงุฎุชุงุฑ ุณุงุฏู ุจุง ูุฌููุนูโุง ุงุฒ ุงุนุถุง ุจูโุทูุฑ ููุงุณุจ ูุงูโฺฏุฐุงุฑ ุดุฏู ุชุนุฑู ฺฉูู. ุจูโุนููุงู ูุซุงูุ ุงูฺฏูุฑุชู ุงุณุชุงูุฏุงุฑุฏ `equal_range` (ยง32.6.1) ฺฉ ุฌูุช ุงุฒ ุงุชุฑุงุชูุฑูุง ุฑุง ุจุฑูโฺฏุฑุฏุงูุฏ ฺฉู ุฒุฑุชุฑุชุจ (subsequence) ูุทุงุจู ุจุง ฺฉ ุดุฑุท ุฑุง ูุดุฎุต ูโฺฉูุฏ:

```cpp
template<typename Forward_iterator, typename T, typename Compare>
pair<Forward_iterator, Forward_iterator>
equal_range(Forward_iterator first, Forward_iterator last, const T& val, Compare cmp);
```

ุจุง ุชูุฌู ุจู ฺฉ ุชูุงู ูุฑุชุจ [first:last)ุ `equal_range()` ุฌูุช ุฑุง ุจุฑูโฺฏุฑุฏุงูุฏ ฺฉู ุฒุฑุชุฑุชุจ ูุทุงุจู ุจุง ุดุฑุท `cmp` ุฑุง ูุดุงู ูโุฏูุฏ. ูโุชูุงูู ุงุฒ ุงู ุจุฑุง ุฌุณุชุฌู ุฏุฑ ฺฉ ุชูุงู ูุฑุชุจ ุงุฒ `Record`ูุง ุงุณุชูุงุฏู ฺฉูู:

```cpp
auto rec_eq = [](const Record& r1, const Record& r2) { return r1.name < r2.name; };  // ููุงุณู ูุงูโูุง

void f(const vector<Record>& v)  // ูุฑุถ ูโุดูุฏ ฺฉู v ุจุฑ ุงุณุงุณ ููุฏ "name" ูุฑุชุจ ุดุฏู ุงุณุช
{
    auto er = equal_range(v.begin(), v.end(), Record{"Reg"}, rec_eq);
    for (auto p = er.first; p != er.second; ++p)  // ฺุงูพ ุชูุงู ุฑฺฉูุฑุฏูุง ุจุฑุงุจุฑ
        cout << *p;  // ูุฑุถ ูโุดูุฏ ฺฉู << ุจุฑุง Record ุชุนุฑู ุดุฏู ุงุณุช
}
```

ุงููู ุนุถู ฺฉ ุฌูุช ุจู ูุงู `first` ู ุฏููู ุนุถู ุจู ูุงู `second` ุฎูุงูุฏู ูโุดูุฏ. ุงู ูุงูโฺฏุฐุงุฑโูุง ููฺฉู ุงุณุช ุงุจุชุฏุง ฺฉู ุนุฌุจ ุจู ูุธุฑ ุจุฑุณูุฏุ ุงูุง ฺูู ูุงูโฺฏุฐุงุฑโูุง ฺฉููุงุฎุช ููฺฏุงู ููุดุชู ฺฉุฏูุง ุนููู (generic code) ุจุณุงุฑ ููุฏ ุงุณุช.

ุฌูุช ุงุณุชุงูุฏุงุฑุฏ (pair) ุงุฒ ฺฉุชุงุจุฎุงูู ุงุณุชุงูุฏุงุฑุฏ (<utility>) ุจูโุทูุฑ ูฺฉุฑุฑ ุฏุฑ ฺฉุชุงุจุฎุงูู ุงุณุชุงูุฏุงุฑุฏ ู ุฏุฑ ุฌุงูุง ุฏฺฏุฑ ุงุณุชูุงุฏู ูโุดูุฏ. ฺฉ ุฌูุชุ ุนููฺฏุฑูุง ูุงููุฏ `=`, `==`, ู `<` ุฑุง ูุฑุงูู ูโฺฉูุฏุ ุงฺฏุฑ ุนูุงุตุฑ ุขู ูุฒ ุงู ุนููฺฏุฑูุง ุฑุง ุฏุงุดุชู ุจุงุดูุฏ. ุชุงุจุน `make_pair()` ุงู ุงูฺฉุงู ุฑุง ูุฑุงูู ูโฺฉูุฏ ฺฉู ุจุฏูู ุฐฺฉุฑ ููุน ุขูุ ฺฉ ุฌูุช ุจุณุงุฒู (ยง34.2.4.1). ุจุฑุง ูุซุงู:

```cpp
void f(vector<string>& v)
{
    auto pp = make_pair(v.begin(), 2);  // pp ฺฉ ุฌูุช ุงุฒ ููุน pair<vector<string>::iterator, int> ุงุณุช
    // ...
}
```

ุงฺฏุฑ ูุงุฒ ุจู ุจุด ุงุฒ ุฏู ุนูุตุฑ (ุง ฺฉูุชุฑ) ุฏุงุดุชู ุจุงุดุฏุ ูโุชูุงูุฏ ุงุฒ `tuple` (ุงุฒ <utility>; ยง34.2.4.2) ุงุณุชูุงุฏู ฺฉูุฏ. ฺฉ `tuple` ฺฉ ุฏูุจุงูู ูุงููฺฏู ุงุฒ ุนูุงุตุฑ ุงุณุชุ ุจุฑุง ูุซุงู:

```cpp
tuple<string, int, double> t2("Sild", 123, 3.14);  // ููุน ุจูโุทูุฑ ุตุฑุญ ูุดุฎุต ุดุฏู ุงุณุช
auto t = make_tuple(string("Herring"), 10, 1.23);  // ููุน ุจูโุทูุฑ ุฎูุฏฺฉุงุฑ ุงุณุชูุจุงุท ูโุดูุฏ
// t ฺฉ tuple<string, int, double> ุงุณุช
string s = get<0>(t);  // ฺฏุฑูุชู ุงููู ุนูุตุฑ tuple
int x = get<1>(t);
double d = get<2>(t);
```

ุนูุงุตุฑ ฺฉ `tuple` ุดูุงุฑูโฺฏุฐุงุฑ ูโุดููุฏ (ุงุฒ ุตูุฑ ุดุฑูุน ูโุดูุฏ)ุ ูู ุงูฺฉู ูุงููุฏ ุนูุงุตุฑ ุฌูุชโูุง (pairs) ูุงูโฺฏุฐุงุฑ ุดููุฏ. ุจุฑุง ุงูุชุฎุงุจ ุนูุงุตุฑ ุฏุฑ ุฒูุงู ฺฉุงููพุงูุ ุจุงุฏ ูุชุฃุณูุงูู ุงุฒ ุฏุณุชูุฑ `get<1>(t)` ุงุณุชูุงุฏู ฺฉููุ ูู `get(t,1)` ุง `t[1]` (ยง28.5.2).

ูุงููุฏ ุฌูุชโูุงุ `tuple`ูุง ูุฒ ูโุชูุงููุฏ ูุณุจุช ุจู ฺฉุฏฺฏุฑ ุชุฎุตุต ุฏุงุฏู ุดููุฏ ู ููุงุณู ุดููุฏุ ุงฺฏุฑ ุนูุงุตุฑ ุขูโูุง ูุฒ ุงู ูฺฺฏโูุง ุฑุง ุฏุงุดุชู ุจุงุดูุฏ.

ฺฉ ุฌูุช ุฏุฑ ุฑุงุจุทโูุง (interfaces) ุฑุงุฌ ุงุณุช ุฒุฑุง ุงุบูุจ ูุงุฒ ุฏุงุฑู ุจุด ุงุฒ ฺฉ ููุฏุงุฑ ุฑุง ุจุงุฒฺฏุฑุฏุงููุ ูุงููุฏ ฺฉ ูุชุฌู ู ุดุงุฎุต ุงุฒ ฺฉูุช ุขู ูุชุฌู. ูุงุฒ ุจู ุณู ุง ุจุดุชุฑ ุจุฎุด ุฏุฑ ูุชุฌู ฺฉูุชุฑ ุฑุงุฌ ุงุณุชุ ุจูุงุจุฑุงู `tuple`ูุง ุจุดุชุฑ ุฏุฑ ูพุงุฏูโุณุงุฒ ุงูฺฏูุฑุชูโูุง ุนููู (generic algorithms) ุงูุช ูโุดููุฏ.

---

ุฏุฑ ุงู ูุชูุ ุตุญุจุช ุงุฒ ุงุณุชูุงุฏู ุงุฒ ุณุงุฎุชุงุฑูุง ุฏุงุฏูโุง ูุงููุฏ `pair` ู `tuple` ุฏุฑ ุฒุจุงู ุจุฑูุงููโููุณ C++ ูโุดูุฏ ฺฉู ุจุฑุง ุฐุฎุฑูโุณุงุฒ ููุงุฏุฑ ูุฎุชูู ู ฺฉุงุฑ ุจุง ุขูโูุง ุงุณุชูุงุฏู ูโุดููุฏ. ุงู ุณุงุฎุชุงุฑูุง ูุนูููุงู ุฏุฑ ููุงูุน ฺฉุงุฑุจุฑุฏ ุฏุงุฑูุฏ ฺฉู ูุงุฒ ุฏุงุฑู ุจุด ุงุฒ ฺฉ ููุฏุงุฑ ุฑุง ุฏุฑ ฺฉูุงุฑ ูู ุฐุฎุฑู ฺฉูู ู ุจูโุฑุงุญุช ุจู ุงู ููุงุฏุฑ ุฏุณุชุฑุณ ุฏุงุดุชู ุจุงุดู. ุจู ุทูุฑ ุฎุงุตุ ูุชู ุฏุฑุจุงุฑูโ ุนููฺฉุฑุฏ ู ูุญููโ ุงุณุชูุงุฏู ุงุฒ ุงู ุณุงุฎุชุงุฑูุง ุชูุถุญ ูโุฏูุฏ.

### 1. **ูุงุฒ ุจู ุฏุงุฏูโูุง ุจูโุนููุงู ุฏุงุฏู ุณุงุฏู**
ุงุจุชุฏุง ุงุดุงุฑู ูโุดูุฏ ฺฉู ฺฏุงู ุงููุงุช ูุงุฒ ุจู ุฏุงุฏูโูุง ุฏุงุฑู ฺฉู ุตุฑูุงู ููุงุฏุฑ ูุณุชูุฏุ ูู ุงุดุงุก ุจุง ูฺฺฏโูุง ู ุฑูุชุงุฑูุง ูพฺุฏู. ุจุฑุง ุงู ฺฉุงุฑ ูโุชูุงูู ุงุฒ ุณุงุฎุชุงุฑูุง ุณุงุฏูโุง ูุงููุฏ `struct` ุงุณุชูุงุฏู ฺฉููุ ุงูุง ุฏุฑ ุจุณุงุฑ ุงุฒ ููุงุฑุฏุ ฺฉุชุงุจุฎุงูู ุงุณุชุงูุฏุงุฑุฏ C++ ุงู ุงูฺฉุงู ุฑุง ูุฑุงูู ูโฺฉูุฏ ฺฉู ุจูโุฌุง ููุดุชู ุชุนุฑูโูุง ูพฺุฏูุ ุฎูุฏ ุณุงุฎุชุงุฑูุง ุฑุง ุงุฌุงุฏ ฺฉูู.

### 2. **ุงูฺฏูุฑุชู `equal_range`**
ุฏุฑ ุงูุฌุงุ ุงูฺฏูุฑุชู `equal_range` ฺฉู ฺฉ ุงุฒ ุงูฺฏูุฑุชูโูุง ุงุณุชุงูุฏุงุฑุฏ C++ ุงุณุชุ ูุนุฑู ูโุดูุฏ. ุงู ุงูฺฏูุฑุชู ฺฉ ุฌูุช ุงุฒ ุงุชุฑุงุชูุฑูุง (ุชุฑฺฉุจ ุฏู ูุดุงูฺฏุฑ ุฏุฑ ฺฉ ูุฌููุนู) ุจุฑูโฺฏุฑุฏุงูุฏ ฺฉู ูุดุงูโุฏููุฏูโ ุฒุฑุชุฑุชุจ (subsequence) ุงุฒ ฺฉ ุชูุงู ูุฑุชุจ ุงุณุช ฺฉู ุจุง ฺฉ ููุฏุงุฑ ุฎุงุต ูุทุงุจูุช ุฏุงุฑุฏ.

```cpp
template<typename Forward_iterator, typename T, typename Compare>
pair<Forward_iterator, Forward_iterator>
equal_range(Forward_iterator first, Forward_iterator last, const T& val, Compare cmp);
```

ุฏุฑ ุงู ุงูฺฏูุฑุชูุ ูุฑุถ ุจุฑ ุงู ุงุณุช ฺฉู ฺฉ ุชูุงู ูุฑุชุจ ุฏุงุฑู (ุจู `first` ู `last`) ู ูโุฎูุงูู ุฌูุช ุงุชุฑุงุชูุฑูุง ุฑุง ูพุฏุง ฺฉูู ฺฉู ูุญุฏูุฏูโุง ุงุฒ ููุงุฏุฑ ุฑุง ูุดุงู ุฏููุฏ ฺฉู ูุทุงุจู ุจุง ุดุฑุท `cmp` ุจุงุดูุฏ.

ุฏุฑ ุงุฏุงููุ ฺฉ ูุซุงู ุขูุฑุฏู ูโุดูุฏ ฺฉู ูุดุงู ูโุฏูุฏ ฺฺฏููู ูโุชูุงู ุงุฒ `equal_range` ุจุฑุง ุฌุณุชุฌู ุฑฺฉูุฑุฏูุง ฺฉู ูุงูุดุงู ุจุง ููุฏุงุฑ ุฎุงุต ุดุฑูุน ูโุดูุฏ ุงุณุชูุงุฏู ฺฉุฑุฏ. ุฏุฑ ุงูุฌุงุ ููุงุณู ุจุฑ ุงุณุงุณ ูุงู ุฑฺฉูุฑุฏูุง ุงูุฌุงู ูโุดูุฏ.

### 3. **ูุงูโฺฏุฐุงุฑ ุฏุฑ ุฌูุชโูุง (Pair)**
ุฏุฑ `pair`ูุง ุงุณุชุงูุฏุงุฑุฏุ ุฏู ุนุถู ุจูโุทูุฑ ูพุดโูุฑุถ ุจุง ูุงูโูุง `first` ู `second` ูุงูโฺฏุฐุงุฑ ูโุดููุฏ. ุงู ูุงูโฺฏุฐุงุฑ ุดุงุฏ ุฏุฑ ุงุจุชุฏุง ฺฉู ุนุฌุจ ุจู ูุธุฑ ุจุฑุณุฏุ ุงูุง ุงู ฺฉููุงุฎุช ุฏุฑ ูุงูโฺฏุฐุงุฑ ุจุณุงุฑ ููุฏ ุงุณุช ู ุจุงุนุซ ูโุดูุฏ ฺฉู ฺฉุฏูุง ุนููู (generic code) ุจู ุฑุงุญุช ููุดุชู ุดููุฏ. ุงู ูฺฺฏ ุจู ุจุฑูุงููโููุณุงู ฺฉูฺฉ ูโฺฉูุฏ ุชุง ุฏุฑ ุดุฑุงุท ูุฎุชูู ุจูโุฑุงุญุช ุงุฒ ุฌูุชโูุง ุงุณุชูุงุฏู ฺฉููุฏ.

### 4. **ุณุงุฎุช ุฌูุชโูุง ุจุง `make_pair()`**
ุจุฑุง ุงุฌุงุฏ ฺฉ ุฌูุช ุจุฏูู ุฐฺฉุฑ ุตุฑุญ ููุน ุขูุ ูโุชูุงู ุงุฒ ุชุงุจุน `make_pair()` ุงุณุชูุงุฏู ฺฉุฑุฏ. ุงู ุชุงุจุน ุจู ุดูุง ุงุฌุงุฒู ูโุฏูุฏ ุจุฏูู ุงูฺฉู ููุน ุฌูุช ุฑุง ูุดุฎุต ฺฉูุฏุ ุจูโุทูุฑ ุฎูุฏฺฉุงุฑ ุฌูุช ุจุง ุงููุงุน ูุดุฎุต ุจุณุงุฒุฏ.

```cpp
auto pp = make_pair(v.begin(), 2);
```

ุฏุฑ ุงูุฌุงุ ููุน ุฌูุช ุจูโุทูุฑ ุฎูุฏฺฉุงุฑ ุงุฒ ููุงุฏุฑ ุฏุงุฏูโุดุฏู (ุงุชุฑุงุชูุฑ ู ุนุฏุฏ ุตุญุญ) ุงุณุชูุจุงุท ูโุดูุฏ.

### 5. **ุงุณุชูุงุฏู ุงุฒ `tuple`**
ุงฺฏุฑ ูุงุฒ ุจู ุฐุฎุฑูโุณุงุฒ ุจุด ุงุฒ ุฏู ููุฏุงุฑ ุฏุงุดุชู ุจุงุดูุ ูโุชูุงูู ุงุฒ `tuple` ุงุณุชูุงุฏู ฺฉูู ฺฉู ฺฉ ุฏูุจุงูู ูุงููฺฏู ุงุฒ ุงููุงุน ูุฎุชูู ุฏุงุฏู ุงุณุช. ุจุฑุง ูุซุงูุ ฺฉ `tuple` ูโุชูุงูุฏ ุดุงูู ฺฉ ุฑุดุชูุ ฺฉ ุนุฏุฏ ุตุญุญ ู ฺฉ ุนุฏุฏ ุงุนุดุงุฑ ุจุงุดุฏ.

```cpp
tuple<string, int, double> t2("Sild", 123, 3.14);
```

ููฺููุ ูโุชูุงู ุงุฒ `make_tuple` ุงุณุชูุงุฏู ฺฉุฑุฏ ฺฉู ููุนโูุง ุฑุง ุจูโุทูุฑ ุฎูุฏฺฉุงุฑ ุงุณุชูุจุงุท ูโฺฉูุฏ:

```cpp
auto t = make_tuple("Herring", 10, 1.23);
```

ุจุฑุง ุฏุณุชุฑุณ ุจู ูุฑ ุนูุตุฑ ุงุฒ `tuple` ุจุงุฏ ุงุฒ ุชุงุจุน `get` ุงุณุชูุงุฏู ฺฉุฑุฏ ู ุจูโุทูุฑ ูุดุฎุต ุดูุงุฑู ุงูุฏุณ ุนูุตุฑ ููุฑุฏ ูุธุฑ ุฑุง ุฐฺฉุฑ ฺฉุฑุฏ (ุจุฑุง ูุซุงู `get<0>(t)` ุจุฑุง ุฏุฑุงูุช ุงููู ุนูุตุฑ).

### 6. **ููุงุณู ู ุชุฎุตุต `pair` ู `tuple`**
ุฌูุชโูุง ู `tuple`ูุง ูโุชูุงููุฏ ุจู ฺฉุฏฺฏุฑ ุชุฎุตุต ุฏุงุฏู ุดููุฏ ู ููุงุณู ุดููุฏุ ุจู ุดุฑุท ฺฉู ุนูุงุตุฑ ุขููุง ุงู ูฺฺฏโูุง ุฑุง ุฏุงุดุชู ุจุงุดูุฏ. ุงู ูุงุจูุช ุจุฑุง ฺฉุงุฑ ุจุง ุฏุงุฏูโูุง ุชุฑฺฉุจ ุจุณุงุฑ ููุฏ ุงุณุช.

### 7. **ุงุณุชูุงุฏู ุฑุงุฌ ุงุฒ `pair` ู `tuple`**
- **ุฌูุชโูุง (`pair`)** ูุนูููุงู ุฏุฑ ุฑุงุจุทโูุง (interfaces) ุงุณุชูุงุฏู ูโุดููุฏุ ุฒุฑุง ุงุบูุจ ูุงุฒ ุฏุงุฑู ฺฉู ุจุด ุงุฒ ฺฉ ูุชุฌู ุฑุง ุจู ุชุงุจุน ุจุงุฒฺฏุฑุฏุงููุ ูุงููุฏ ูุชุฌู ู ุดุงุฎุต ฺฉูุช ุขู. ุจุฑุง ูุซุงูุ ููฺฉู ุงุณุช ุจุฎูุงูู ูุชุฌู ฺฉ ุฌุณุชุฌู ุฑุง ุจูโููุฑุงู ูุถุนุช ููููุช ุขู ุจุงุฒฺฏุฑุฏุงูู.
- **ุชููพูโูุง (`tuple`)** ุฒูุงู ฺฉู ูุงุฒ ุจู ุฐุฎุฑูโุณุงุฒ ุจุด ุงุฒ ุฏู ููุฏุงุฑ ุจุงุดุฏุ ูุนูููุงู ุฏุฑ ูพุงุฏูโุณุงุฒโูุง ุฏุงุฎู ุงูฺฏูุฑุชูโูุง ุจูโฺฉุงุฑ ูโุฑููุฏ.

### ูุชุฌูโฺฏุฑ:
ุฏุฑ ุงู ูุชู ุจู ุทูุฑ ฺฉู ุชูุถุญ ุฏุงุฏู ุดุฏู ฺฉู ฺฺฏููู ูโุชูุงู ุงุฒ ุณุงุฎุชุงุฑูุง `pair` ู `tuple` ุฏุฑ C++ ุจุฑุง ุฐุฎุฑูโุณุงุฒ ูุฌููุนูโูุง ูุฎุชูู ุงุฒ ุฏุงุฏูโูุง ุงุณุชูุงุฏู ฺฉุฑุฏ. ุงู ุณุงุฎุชุงุฑูุง ุงุจุฒุงุฑูุง ููุฏ ุจุฑุง ููุดุชู ฺฉุฏูุง ุนููู ู ุงูฺฏูุฑุชูโูุง ูพฺุฏูโุชุฑ ูุณุชูุฏ ู ุจู ุจุฑูุงููโููุณุงู ุงู ุงูฺฉุงู ุฑุง ูโุฏููุฏ ฺฉู ฺูุฏู ููุฏุงุฑ ุฑุง ุจูโุทูุฑ ููุฒูุงู ุฐุฎุฑู ู ูุฏุฑุช ฺฉููุฏ.

## Regular Expressions
ุนุจุงุฑุงุช ููุธู (Regular Expressions) ุงุจุฒุงุฑ ูุฏุฑุชููุฏ ุจุฑุง ูพุฑุฏุงุฒุด ูุชู ูุณุชูุฏ. ุขูโูุง ุฑูุด ุณุงุฏู ู ูุฎุชุตุฑ ุจุฑุง ุชูุตู ุงูฺฏููุง ููุฌูุฏ ุฏุฑ ูุชู ูุฑุงูู ูโฺฉููุฏ (ุจุฑุง ูุซุงูุ ฺฉ ฺฉุฏ ูพุณุช ุฏุฑ ุงุงูุงุช ูุชุญุฏู ูุงููุฏ TX 77845 ุง ฺฉ ุชุงุฑุฎ ุจู ุณุจฺฉ ISO ูุงููุฏ 2009โ06โ07) ู ุงูฺฉุงู ุงูุชู ุงู ุงูฺฏููุง ุฑุง ุฏุฑ ูุชู ุจูโุตูุฑุช ฺฉุงุฑุขูุฏ ูุฑุงูู ูโุณุงุฒูุฏ. ุฏุฑ ฺฉุชุงุจุฎุงูู ุงุณุชุงูุฏุงุฑุฏ ++Cุ ูพุดุชุจุงู ุงุฒ ุนุจุงุฑุงุช ููุธู ุฏุฑ ูุงูุจ ฺฉูุงุณ `std::regex` ู ุชูุงุจุน ูพุดุชุจุงู ุขู ุงุฑุงุฆู ุดุฏู ุงุณุช. 

ุจุฑุง ุขุดูุง ุจุง ุณุจฺฉ ฺฉุชุงุจุฎุงูู `regex`ุ ุจุงุฏ ฺฉ ุงูฺฏู ุฑุง ุชุนุฑู ฺฉุฑุฏู ู ฺุงูพ ฺฉูู:

```cpp
regex pat (R"(\w{2}\sโ\d{5}(โ\d{4})?)"); // ุงูฺฏู ฺฉุฏ ูพุณุช: XXddddd-dddd ู ุงููุงุน ุฏฺฏุฑ
cout << "pattern: " << pat << '\n';
```

ุงูุฑุงุฏ ฺฉู ูุจูุงู ุงุฒ ุนุจุงุฑุงุช ููุธู ุฏุฑ ุฒุจุงูโูุง ูุฎุชูู ุงุณุชูุงุฏู ฺฉุฑุฏูโุงูุฏุ ุจุง ุงูฺฏู `\w{2}\sโ\d{5}(โ\d{4})?` ุขุดูุง ุฎูุงููุฏ ุจูุฏ. ุงู ุงูฺฏู ูุดุฎุต ูโฺฉูุฏ ฺฉู ูุชู ุจุงุฏ ุจุง ุฏู ุญุฑู (`\w{2}`) ุดุฑูุน ุดูุฏุ ฺฉู ููฺฉู ุงุณุช ุจู ุฏูุจุงู ุขู ฺฉ ูุงุตูู (`\sโ`) ุจุงุดุฏุ ุณูพุณ ูพูุฌ ุนุฏุฏ (`\d{5}`) ู ุฏุฑ ุตูุฑุช ูุฌูุฏุ ฺฉ ุฎุท ุชุฑู ู ฺูุงุฑ ุนุฏุฏ ุฏฺฏุฑ (`โ\d{4}`) ุฏุงุดุชู ุจุงุดุฏ. ุงฺฏุฑ ุจุง ุนุจุงุฑุงุช ููุธู ุขุดูุง ูุฏุงุฑุฏุ ุงฺฉููู ูุฑุตุช ุฎูุจ ุจุฑุง ุงุฏฺฏุฑ ุขูโูุงุณุช ([Stroustrup, 2009]ุ [Maddock, 2009]ุ [Friedl, 1997]). ุฎูุงุตูโุง ุงุฒ ุนุจุงุฑุงุช ููุธู ุฏุฑ ุจุฎุด ยง37.1.1 ุขูุฏู ุงุณุช.

ุจุฑุง ุจุงู ุงู ุงูฺฏูุ ุงุฒ ฺฉ ุฑุดุชูโ ุฎุงู (raw string literal) ุงุณุชูุงุฏู ุดุฏู ุงุณุช ฺฉู ุจุง `R"(` ุดุฑูุน ู ุจุง `)"` ุฎุงุชูู ูโุงุจุฏ. ุงู ุงูฺฉุงู ุฑุง ูโุฏูุฏ ฺฉู ุจฺฉโุงุณูุดโูุง ู ูููโูููโูุง ูุณุชููุงู ุฏุฑ ุฑุดุชู ุงุณุชูุงุฏู ุดููุฏ.

ุณุงุฏูโุชุฑู ุฑุงู ุจุฑุง ุงุณุชูุงุฏู ุงุฒ ฺฉ ุงูฺฏูุ ุฌุณุชุฌู ุขู ุฏุฑ ฺฉ ุฌุฑุงู (stream) ุงุณุช:

```cpp
int lineno = 0;
for (string line; getline(cin, line);) { // ุฎูุงูุฏู ุฎุท ุจู ุฎุท
    ++lineno;
    smatch matches; // ุฐุฎุฑูโ ุฑุดุชูโูุง ูุทุงุจู ุจุง ุงูฺฏู
    if (regex_search(line, matches, pat)) // ุฌุณุชุฌู ุจุฑุง pat ุฏุฑ line
        cout << lineno << ": " << matches[0] << '\n';
}
```

ุชุงุจุน `regex_search(line, matches, pat)` ุฏุฑ `line` ุจู ุฏูุจุงู ูุฑ ุชุทุงุจู ุจุง ุงูฺฏู `pat` ูโฺฏุฑุฏุฏ ู ุฏุฑ ุตูุฑุช ุงูุชู ุชุทุงุจูุ ุขู ุฑุง ุฏุฑ `matches` ุฐุฎุฑู ูโฺฉูุฏ. ุงฺฏุฑ ูฺ ุชุทุงุจู ูพุฏุง ูุดูุฏุ ุงู ุชุงุจุน ููุฏุงุฑ `false` ุฑุง ุจุฑูโฺฏุฑุฏุงูุฏ.

ูุชุบุฑ `matches` ุงุฒ ููุน `smatch` ุงุณุช. ุญุฑู ยซsยป ุฏุฑ `smatch` ูุฎูู ยซsubยป (ุฒุฑูุฌููุนู) ุงุณุช ู `smatch` ุฏุฑ ูุงูุน ฺฉ ุจุฑุฏุงุฑ ุงุฒ ุฒุฑุจุฎุดโูุง ูุทุงุจูุช ุงูุชู ุงุณุช. ุนูุตุฑ ุงููุ ุนู `matches[0]`ุ ฺฉู ุชุทุงุจู ุฑุง ุฏุฑุจุฑูโฺฏุฑุฏ.

ุจุฑุง ุชูุถุญุงุช ุฌุงูุนโุชุฑุ ุจู ูุตู ณท ูุฑุงุฌุนู ฺฉูุฏ.

## Math
++C ุจู ุทูุฑ ุงููู ุจุฑุง ูุญุงุณุจุงุช ุนุฏุฏ ุทุฑุงุญ ูุดุฏู ุงุณุช. ุจุง ุงู ุญุงูุ ุงู ุฒุจุงู ุจู ุทูุฑ ฺฏุณุชุฑุฏู ุจุฑุง ูุญุงุณุจุงุช ุนุฏุฏ ููุฑุฏ ุงุณุชูุงุฏู ูุฑุงุฑ ูโฺฏุฑุฏ ู ฺฉุชุงุจุฎุงูู ุงุณุชุงูุฏุงุฑุฏ ุขู ูุฒ ุงู ููุถูุน ุฑุง ููุนฺฉุณ ูโฺฉูุฏ.

## Mathematical Functions and Algorithms
ุฏุฑ ฺฉุชุงุจุฎุงูู `<cmath>`ุ "ุชูุงุจุน ุฑุงุถ ูุนููู" ูุงููุฏ `sqrt()`ุ `log()` ู `sin()` ุฑุง ุจุฑุง ุงููุงุน `float`ุ `double` ู `long double` ูโุงุจู (ยง40.3). ูุณุฎูโูุง ุงุฒ ุงู ุชูุงุจุน ฺฉู ุจุฑุง ุงุนุฏุงุฏ ูุฎุชูุท ุทุฑุงุญ ุดุฏูโุงูุฏุ ุฏุฑ ฺฉุชุงุจุฎุงูู `<complex>` ูุฑุงุฑ ุฏุงุฑูุฏ (ยง40.4).

ุฏุฑ ฺฉุชุงุจุฎุงูู `<numeric>`ุ ูุฌููุนูโุง ฺฉูฺฺฉ ุงุฒ ุงูฺฏูุฑุชูโูุง ุนุฏุฏ ุนููู ูุงููุฏ `accumulate()` ุฑุง ูโุชูุงู ุงูุช. ุจุฑุง ูุซุงู:

```cpp
void f()
{
    list<double> lst {1, 2, 3, 4, 5, 9999.99999};
    auto s = accumulate(lst.begin(), lst.end(), 0.0); // ูุญุงุณุจู ูุฌููุน ุนูุงุตุฑ
    cout << s << '\n'; // ฺุงูพ ููุฏุงุฑ 10014.9999
}
```

ุงู ุงูฺฏูุฑุชูโูุง ุจุฑุง ูุฑ ุฏูุจุงููโ ุงุณุชุงูุฏุงุฑุฏ ฺฉุชุงุจุฎุงูู ูุงุจู ุงุณุชูุงุฏู ูุณุชูุฏ ู ูโุชูุงู ุนููุงุช ููุฑุฏูุธุฑ ุฑุง ุจู ุนููุงู ุขุฑฺฏููุงู ุจู ุขูโูุง ุงุฑุงุฆู ฺฉุฑุฏ (ยง40.6).

## Complex Numbers
ฺฉุชุงุจุฎุงูู ุงุณุชุงูุฏุงุฑุฏ ุงุฒ ฺฉ ูุฌููุนู ุงุฒ ุงููุงุน ุงุนุฏุงุฏ ูุฎุชูุท ูพุดุชุจุงู ูโฺฉูุฏ ฺฉู ูุดุงุจู ฺฉูุงุณ `complex` ุชูุตูโุดุฏู ุฏุฑ ุจุฎุด ยง2.3 ุงุณุช. ุจุฑุง ูพุดุชุจุงู ุงุฒ ุงุนุฏุงุฏ ูุฎุชูุท ฺฉู ููุฏุงุฑูุง ุนุฏุฏ ุขูโูุง ุงุฒ ููุน **float** (ุงุนุฏุงุฏ ุงุนุดุงุฑ ุจุง ุฏูุช ุชฺฉโฺฏุงูู)ุ **double** (ุงุนุฏุงุฏ ุงุนุดุงุฑ ุจุง ุฏูุช ุฏูฺฏุงูู) ู ... ูุณุชูุฏุ ฺฉูุงุณ `complex` ุฏุฑ ฺฉุชุงุจุฎุงูู ุงุณุชุงูุฏุงุฑุฏ ุจูโุตูุฑุช ฺฉ **ุงูฺฏู (template)** ุชุนุฑู ุดุฏู ุงุณุช:

```cpp
template<typename Scalar>
class complex {
public:
    complex(const Scalar& re = {}, const Scalar& im = {});
    // ...
};
```

ุนููุงุช ูุนููู ุฑุงุถ ู ุฑุงุฌโุชุฑู ุชูุงุจุน ุฑุงุถ ุจุฑุง ุงุนุฏุงุฏ ูุฎุชูุท ูพุดุชุจุงู ูโุดููุฏ. ุจุฑุง ูุซุงู:

```cpp
void f(complex<float> fl, complex<double> db)
{
    complex<long double> ld {fl + sqrt(db)};
    db += fl * 3;
    fl = pow(1 / fl, 2);
    // ...
}
```

ุชูุงุจุน `sqrt()` (ุฑุดู ุฏูู) ู `pow()` (ุชูุงู) ุงุฒ ุฌููู ุชูุงุจุน ุฑุงุถ ูุชุฏุงูู ูุณุชูุฏ ฺฉู ุฏุฑ `<complex>` ุชุนุฑู ุดุฏูโุงูุฏ. ุจุฑุง ุงุทูุงุนุงุช ุจุดุชุฑุ ุจู ุจุฎุด **ยง40.4** ูุฑุงุฌุนู ฺฉูุฏ.

## Random Numbers
ุงุนุฏุงุฏ ุชุตุงุฏู ุฏุฑ ุฒูููโูุง ูุฎุชูู ููุฏ ูุณุชูุฏุ ุงุฒ ุฌููู **ุชุณุช ูุฑูโุงูุฒุงุฑุ ุจุงุฒโูุงุ ุดุจูโุณุงุฒ ู ุงููุช**. ุชููุน ฺฉุงุฑุจุฑุฏูุง ุฏุฑ ูุฌููุนู ฺฏุณุชุฑุฏูโุง ุงุฒ **ูููุฏูุง ุงุนุฏุงุฏ ุชุตุงุฏู** ฺฉู ุฏุฑ ฺฉุชุงุจุฎุงูู ุงุณุชุงูุฏุงุฑุฏ `<random>` ุงุฑุงุฆู ุดุฏู ุงุณุชุ ููุนฺฉุณ ุดุฏู ุงุณุช.

ฺฉ **ูููุฏ ุนุฏุฏ ุชุตุงุฏู** ุงุฒ ุฏู ุจุฎุด ุชุดฺฉู ุดุฏู ุงุณุช:
1. **ฺฉ ููุชูุฑ (Engine)** ฺฉู ุฏูุจุงููโุง ุงุฒ ููุงุฏุฑ ุชุตุงุฏู ุง ุดุจูโุชุตุงุฏู ุชููุฏ ูโฺฉูุฏ.
2. **ฺฉ ุชูุฒุน (Distribution)** ฺฉู ุงู ููุงุฏุฑ ุฑุง ุจู ฺฉ **ุชูุฒุน ุฑุงุถ** ุฏุฑ ฺฉ ุฏุงููู ุฎุงุต ูฺฏุงุดุช ูโฺฉูุฏ.

ูููููโูุง ุงุฒ ุชูุฒุนโูุง ูุชุฏุงูู ุดุงูู ููุงุฑุฏ ุฒุฑ ูุณุชูุฏ:
- `uniform_int_distribution` โ ููู ุงุนุฏุงุฏ ุตุญุญ ุฏุฑ ุฏุงูููโ ูุดุฎุตุ ุงุญุชูุงู ฺฉุณุงู ุจุฑุง ุงูุชุฎุงุจ ุดุฏู ุฏุงุฑูุฏ.
- `normal_distribution` โ ุชูุฒุน ูุฑูุงู (ููุญู ุฒูฺฏ).
- `exponential_distribution` โ ุชูุฒุน ููุง (ุฑุดุฏ ููุง).

### **ูุซุงู: ุชููุฏ ุนุฏุฏ ุชุตุงุฏู ุจู ฑ ุชุง ถ**
```cpp
using my_engine = default_random_engine; // ููุน ููุชูุฑ ุชุตุงุฏู
using my_distribution = uniform_int_distribution<>; // ููุน ุชูุฒุน

my_engine re {}; // ููุชูุฑ ุชุตุงุฏู ูพุดโูุฑุถ
my_distribution one_to_six {1,6}; // ุชูุฒุน ุงุนุฏุงุฏ ุตุญุญ ุจู 1 ุชุง 6

auto die = bind(one_to_six, re); // ุงุฌุงุฏ ฺฉ ุชุงุจุน ุจุฑุง ุชููุฏ ุนุฏุฏ ุชุตุงุฏู
int x = die(); // ูพุฑุชุงุจ ุชุงุณ: ููุฏุงุฑ x ุจู [1,6] ูุฑุงุฑ ูโฺฏุฑุฏ
```

ุชุงุจุน `bind()` ฺฉ **ุดุก ุชุงุจุน (Function Object)** ุงุฌุงุฏ ูโฺฉูุฏ ฺฉู ุงุฌุฑุง ุขูุ ููุฏุงุฑ ุชุตุงุฏู ุฑุง ุจุฑ ุงุณุงุณ ุชูุฒุน ูุดุฎุต ุชููุฏ ูโฺฉูุฏ. ุฏุฑ ุงูุฌุงุ `die()` ุฏุฑ ูุงูุน ููุงู `one_to_six(re)` ุฑุง ุงุฌุฑุง ูโฺฉูุฏ.

### **ุฑูุด ุณุงุฏูโุชุฑ ุจุฑุง ุชุนุฑู ุชุงุจุน ุชููุฏ ุนุฏุฏ ุชุตุงุฏู**
ุจู ุฌุง ุงุณุชูุงุฏู ุงุฒ `using`ุ ูโุชูุงู ูุณุชููุงู ุงู ุนุจุงุฑุช ุฑุง ููุดุช:

```cpp
auto die = bind(uniform_int_distribution<>{1,6}, default_random_engine{});
```

ุงูุชุฎุงุจ ุจู ุงู ุฏู ุฑูุดุ **ุจุณุชู ุจู ุฒููู ู ุฎูุงููุฏูโ ฺฉุฏ ูุชูุงูุช ุฎูุงูุฏ ุจูุฏ**.

---

### **ุณุงุฎุช ฺฉ ฺฉูุงุณ ุจุฑุง ุชููุฏ ุงุนุฏุงุฏ ุชุตุงุฏู**
ุจุฑุง ุณุงุฏูโุชุฑ ฺฉุฑุฏู ฺฉุงุฑุ ูโุชูุงูู ฺฉ ฺฉูุงุณ `Rand_int` ุงุฌุงุฏ ฺฉูู ฺฉู ุชููุฏ ุงุนุฏุงุฏ ุชุตุงุฏู ุฑุง ุฏุฑ ูุญุฏูุฏู ูุดุฎุต ูุฏุฑุช ฺฉูุฏ:

```cpp
class Rand_int {
public:
    Rand_int(int low, int high) : dist{low, high} { }
    int operator()() { return dist(re); } // ุชููุฏ ฺฉ ุนุฏุฏ ุชุตุงุฏู
private:
    default_random_engine re; // ููุชูุฑ ุชุตุงุฏู
    uniform_int_distribution<> dist; // ุชูุฒุน ุงุนุฏุงุฏ ุชุตุงุฏู
};
```

### **ุงุณุชูุงุฏู ุงุฒ ฺฉูุงุณ `Rand_int`**
```cpp
int main()
{
    Rand_int rnd {0,4}; // ุชููุฏโฺฉููุฏู ุงุนุฏุงุฏ ุชุตุงุฏู ุจู 0 ุชุง 4
    vector<int> histogram(5); // ุจุฑุฏุงุฑ ุจุฑุง ูฺฏูุฏุงุฑ ูุฑุงูุงู ุงุนุฏุงุฏ

    for (int i = 0; i != 200; ++i)
        ++histogram[rnd()]; // ูพุฑ ฺฉุฑุฏู ูุณุชูฺฏุฑุงู ุจุง ุชุนุฏุงุฏ ูููุน ูุฑ ุนุฏุฏ

    // ุฑุณู ูููุฏุงุฑ ุณุชูู ุณุงุฏู ุจุง ุงุณุชูุงุฏู ุงุฒ ฺฉุงุฑุงฺฉุชุฑ '*'
    for (int i = 0; i != histogram.size(); ++i) {
        cout << i << '\t';
        for (int j = 0; j != histogram[i]; ++j) cout << '*';
        cout << endl;
    }
}
```

### **ุฎุฑูุฌ ูููููโ ุจุฑูุงูู:**
```
0  ****************************
1  ***************************
2  ***********************
3  ****************************
4  ****************************
```
ุฏุฑ ุงูุฌุงุ **ูุณุชูฺฏุฑุงู ูุฑุงูุงู ุงุนุฏุงุฏ ุชููุฏ ุดุฏู** ุฑุง ููุงุด ูโุฏูุฏ ู ฺูู ุชูุฒุน ฺฉููุงุฎุช (`uniform`) ุงุณุชุ ูููโ ุงุนุฏุงุฏ ุชูุฑุจุงู ุจู ฺฉ ูุฒุงู ุธุงูุฑ ูโุดููุฏ.

---

### **ูฺฉุชูโ ููู**
++C ฺฉ **ฺฉุชุงุจุฎุงููโ ฺฏุฑุงูฺฉ ุงุณุชุงูุฏุงุฑุฏ** ูุฏุงุฑุฏุ ุจู ููู ุฏูู ุฏุฑ ุงู ูุซุงู ุงุฒ **"ูููุฏุงุฑ ASCII"** ุจุฑุง ููุงุด ุฏุงุฏูโูุง ุงุณุชูุงุฏู ุดุฏู ุงุณุช. ุงูุจุชูุ ฺฉุชุงุจุฎุงููโูุง ูุชูโุจุงุฒ ู ุชุฌุงุฑ ุจุณุงุฑ ุจุฑุง ฺฏุฑุงูฺฉ ู ุฑุงุจุท ฺฉุงุฑุจุฑ ุฏุฑ ++C ูุฌูุฏ ุฏุงุฑูุฏุ ุงูุง ุฏุฑ ุงู ฺฉุชุงุจ ููุท ุงุฒ ูุงุจูุชโูุง ุงุณุชุงูุฏุงุฑุฏ ุฒุจุงู ุงุณุชูุงุฏู ุดุฏู ุงุณุช.

**ุจุฑุง ุงุทูุงุนุงุช ุจุดุชุฑ ุฏุฑุจุงุฑูโ ุงุนุฏุงุฏ ุชุตุงุฏูุ ุจู ุจุฎุด ยง40.7 ูุฑุงุฌุนู ฺฉูุฏ.**

## Vector Arithmetic
ฺฉูุงุณ **`vector`** ฺฉู ุฏุฑ ุจุฎุด **ยง4.4.1** ุชูุถุญ ุฏุงุฏู ุดุฏุ ุจูโุนููุงู ฺฉ **ูฺฉุงูุฒู ุนููู ุจุฑุง ูฺฏูุฏุงุฑ ููุงุฏุฑ** ุทุฑุงุญ ุดุฏู ุงุณุช. ุงู ฺฉูุงุณ **ุงูุนุทุงูโูพุฐุฑ** ุจูุฏู ู ุฏุฑ ูุนูุงุฑ **ุธุฑูู (containers)ุ ูพูุงุดฺฏุฑูุง (iterators) ู ุงูฺฏูุฑุชูโูุง (algorithms)** ุจู ุฎูุจ ุฌุง ูโฺฏุฑุฏ. ุจุง ุงู ุญุงูุ **ุงุฒ ุนููุงุช ุฑุงุถ ุจุฑุฏุงุฑ ูพุดุชุจุงู ููโฺฉูุฏ**.

ุงูุฒูุฏู ุงู ุนููุงุช ุจู `vector` ฺฉุงุฑ **ุขุณุงู** ุงุณุชุ ุงูุง **ุนูููุช ู ุงูุนุทุงูโูพุฐุฑ ุขู ุจุงุนุซ ูโุดูุฏ ุจูููโุณุงุฒโูุง ุฎุงุต ฺฉู ุจุฑุง ูุญุงุณุจุงุช ุนุฏุฏ ุฌุฏ ุถุฑูุฑ ูุณุชูุฏุ ุงูฺฉุงูโูพุฐุฑ ูุจุงุดูุฏ**. ุจู ููู ุฏููุ **ฺฉุชุงุจุฎุงูู ุงุณุชุงูุฏุงุฑุฏ ++C ุฏุฑ `<valarray>` ฺฉ ฺฉูุงุณ ูุดุงุจู `vector` ุจู ูุงู `valarray` ุงุฑุงุฆู ูโุฏูุฏ** ฺฉู **ฺฉูุชุฑ ุนููู ุงูุง ุจุฑุง ุจูููโุณุงุฒ ูุญุงุณุจุงุช ุนุฏุฏ ููุงุณุจโุชุฑ ุงุณุช**:

```cpp
template<typename T>
class valarray {
// ...
};
```

ฺฉูุงุณ **`valarray`** ุงุฒ **ุนููุงุช ุฑุงุถ ูุนููู** ู **ุชูุงุจุน ุฑุงุถ ุฑุงุฌ** ูพุดุชุจุงู ูโฺฉูุฏ. ุจุฑุง ูุซุงู:

```cpp
void f(valarray<double>& a1, valarray<double>& a2)
{
    valarray<double> a = a1 * 3.14 + a2 / a1; // ุนููุงุช ุนุฏุฏ: *, +, / ู =
    a2 += a1 * 3.14;
    a = abs(a);
    double d = a2[7];
    // ...
}
```

ุจุฑุง ุงุทูุงุนุงุช ุจุดุชุฑุ ุจู ุจุฎุด **ยง40.5** ูุฑุงุฌุนู ฺฉูุฏ. ุจูโุทูุฑ ุฎุงุตุ **`valarray` ุงุฒ ูุงุจูุช stride access ูพุดุชุจุงู ูโฺฉูุฏ** ฺฉู ุจู **ูพุงุฏูโุณุงุฒ ูุญุงุณุจุงุช ฺูุฏุจุนุฏ** ฺฉูฺฉ ูโฺฉูุฏ.

---

### **ฺฉูุงุณ `valarray` ุฏุฑ ++C: ุจูููโุณุงุฒ ูุญุงุณุจุงุช ุนุฏุฏ**
ฺฉูุงุณ **`valarray`** ฺฉู ุฏุฑ **ฺฉุชุงุจุฎุงูู `<valarray>`** ูุฑุงุฑ ุฏุงุฑุฏุ ุจุฑุง ุงูุฌุงู **ูุญุงุณุจุงุช ุนุฏุฏ ุณุฑุน ู ุจููู** ุทุฑุงุญ ุดุฏู ุงุณุช. ุงู ฺฉูุงุณ ุดุจุงูุช ุฒุงุฏ ุจู `vector` ุฏุงุฑุฏุ ุงูุง **ุจูููโุณุงุฒโูุง ุจุดุชุฑ ุจุฑุง ุนููุงุช ุฑุงุถ ู ูพุฑุฏุงุฒุด ุฏุงุฏูโูุง ุงุฑุงุฆู ูโุฏูุฏ**.

---

## **ฑ. ฺุฑุง ุงุฒ `valarray` ุงุณุชูุงุฏู ฺฉููุ**
ุฏุฑ ุญุงู ฺฉู `vector<double>` ุจุฑุง ุฐุฎุฑู ุฏุงุฏูโูุง ููุงุณุจ ุงุณุชุ ุงูุง ููฺฏุงู ุงุฌุฑุง **ูุญุงุณุจุงุช ุฑุงุถ ุณูฺฏู**ุ `vector` ููโุชูุงูุฏ ุจุฑุฎ ุงุฒ **ุจูููโุณุงุฒโูุง ุฎุงุต** ุฑุง ุงูุฌุงู ุฏูุฏ. ุงูุฌุงุณุช ฺฉู `valarray` ููุฏ ูุงูุน ูโุดูุฏ.

**ูฺฺฏโูุง ฺฉูุฏ `valarray`:**
โ **ูพุดุชุจุงู ุฏุงุฎู ุงุฒ ุนููุงุช ุฑุงุถ:** ูโุชูุงู ูุณุชููุงู ุงุฒ **`+, -, *, /`** ุฑู `valarray` ุงุณุชูุงุฏู ฺฉุฑุฏ.  
โ **ุงุฌุฑุง ุณุฑุนโุชุฑ ูุณุจุช ุจู `vector`:** ุจุฑุฎ ุจูููโุณุงุฒโูุง ุณุทุญ ูพุงู ุฏุฑ `valarray` ุจุงุนุซ ุงูุฒุงุด ฺฉุงุฑุง ุฏุฑ **ูุญุงุณุจุงุช ุนุฏุฏ** ูโุดูุฏ.  
โ **ุญูุงุช ุงุฒ ุนููุงุช ุจุฑุฏุงุฑ:** ูุญุงุณุจุงุช ฺฉู ุฏุฑ `vector` ูุงุฒ ุจู ุญููู (`for`) ุฏุงุฑูุฏุ ุฏุฑ `valarray` ุจูโุทูุฑ ูุณุชูู ุงูุฌุงู ูโุดููุฏ.  
โ **ูพุดุชุจุงู ุงุฒ stride access:** ุงู ูฺฺฏ ุจู ุฏุณุชุฑุณ ูุคุซุฑ ุจู ุฏุงุฏูโูุง ุฏุฑ ุขุฑุงูโูุง ฺูุฏุจุนุฏ ฺฉูฺฉ ูโฺฉูุฏ.  

---

## **ฒ. ูุญููโ ุชุนุฑู ู ููุฏุงุฑุฏู `valarray`**
ูโุชูุงูู `valarray` ุฑุง ูุงููุฏ `vector` ุชุนุฑู ู ููุฏุงุฑุฏู ฺฉูู:

```cpp
#include <iostream>
#include <valarray>

using namespace std;

int main() {
    valarray<int> v1 = {1, 2, 3, 4, 5}; // ููุฏุงุฑุฏู ุงููู
    valarray<double> v2(10, 5); // 5 ุนุฏุฏ ููุฏุงุฑุฏู ุดุฏู ุจุง ููุฏุงุฑ 10.0

    // ฺุงูพ ููุฏุงุฑ ุงููู
    cout << "v1: ";
    for (int x : v1) cout << x << " ";
    cout << endl;

    cout << "v2: ";
    for (double x : v2) cout << x << " ";
    cout << endl;

    return 0;
}
```

โ ุฎุฑูุฌ:
```
v1: 1 2 3 4 5 
v2: 10 10 10 10 10 
```

---

## **ณ. ุงูุฌุงู ุนููุงุช ุฑุงุถ ุฑู `valarray`**
ุฏุฑ `valarray` ูโุชูุงู **ุนููุงุช ุฑุงุถ** ุฑุง ูุณุชููุงู ุฑู ฺฉู ุขุฑุงู ุงูุฌุงู ุฏุงุฏุ ุจุฏูู ูุงุฒ ุจู ุญููู `for`.

```cpp
#include <iostream>
#include <valarray>

using namespace std;

int main() {
    valarray<int> a1 = {1, 2, 3, 4, 5};
    valarray<int> a2 = {10, 20, 30, 40, 50};

    valarray<int> sum = a1 + a2; // ุฌูุน ุฏู valarray
    valarray<int> product = a1 * 2; // ุถุฑุจ ุฏุฑ ุนุฏุฏ ุซุงุจุช
    valarray<int> division = a2 / a1; // ุชูุณู ุนูุงุตุฑ ุจูโุตูุฑุช ุจุฑุฏุงุฑ

    cout << "sum: ";
    for (int x : sum) cout << x << " ";
    cout << endl;

    cout << "product: ";
    for (int x : product) cout << x << " ";
    cout << endl;

    cout << "division: ";
    for (int x : division) cout << x << " ";
    cout << endl;

    return 0;
}
```

โ ุฎุฑูุฌ:
```
sum: 11 22 33 44 55 
product: 2 4 6 8 10 
division: 10 10 10 10 10 
```

---

## **ด. ุงุณุชูุงุฏู ุงุฒ ุชูุงุจุน ุฑุงุถ ุฏุฑ `valarray`**
ฺฉุชุงุจุฎุงูู `<valarray>` ุชูุงุจุน ุฑุงุถ ูุฎุชูู ูุงููุฏ `sqrt()`, `abs()`, `log()`, `exp()` ู ... ุฑุง ุจุฑุง ูพุฑุฏุงุฒุด ุฏุงุฏูโูุง ุนุฏุฏ ุงุฑุงุฆู ูโุฏูุฏ.

```cpp
#include <iostream>
#include <valarray>
#include <cmath>

using namespace std;

int main() {
    valarray<double> v = {4.0, 9.0, 16.0, 25.0};

    valarray<double> squareRoots = sqrt(v); // ูุญุงุณุจู ุฌุฐุฑ ุนูุงุตุฑ
    valarray<double> logs = log(v); // ูุญุงุณุจู ูฺฏุงุฑุชู ุทุจุน
    valarray<double> exponentials = exp(v); // ุชุงุจุน ููุง

    cout << "Square roots: ";
    for (double x : squareRoots) cout << x << " ";
    cout << endl;

    cout << "Logarithms: ";
    for (double x : logs) cout << x << " ";
    cout << endl;

    cout << "Exponentials: ";
    for (double x : exponentials) cout << x << " ";
    cout << endl;

    return 0;
}
```

โ ุฎุฑูุฌ:
```
Square roots: 2 3 4 5 
Logarithms: 1.38629 2.19722 2.77259 3.21888 
Exponentials: 54.5982 8103.08 8.88611e+06 7.20049e+10 
```

---

## **ต. ูฺฺฏ `stride access` ุฏุฑ `valarray`**
ฺฉ ุงุฒ ูฺฺฏโูุง ุฌุงูุจ `valarray` ุงู ุงุณุช ฺฉู ูโุชูุงู **ุฏุงุฏูโูุง ุฑุง ุจุง ููุงุตู ูุดุฎุต ุฎูุงูุฏ** ฺฉู ุจุฑุง **ูุญุงุณุจุงุช ฺูุฏุจุนุฏ** ููุฏ ุงุณุช.

```cpp
#include <iostream>
#include <valarray>

using namespace std;

int main() {
    valarray<int> v = {1, 2, 3, 4, 5, 6, 7, 8, 9, 10};

    valarray<int> strideValues = v[std::slice(0, 5, 2)]; // ุงูุชุฎุงุจ ูุฑ ููุฏุงุฑ ุฏูู

    cout << "Stride access result: ";
    for (int x : strideValues) cout << x << " ";
    cout << endl;

    return 0;
}
```

โ ุฎุฑูุฌ:
```
Stride access result: 1 3 5 7 9 
```
๐น ุฏุฑ ุงู ูุซุงูุ ูุฑ **ุนูุตุฑ ุฏูู** ุงุฒ `valarray` ุงูุชุฎุงุจ ุดุฏู ุงุณุช.

---

## **ถ. ููุงุณู `valarray` ุจุง `vector`**
ูฺฺฏ | `vector` | `valarray`
--- | --- | ---
ุนููุงุช ุฑุงุถ ูุณุชูู | โ (ูุงุฒ ุจู `for`) | โ (ูุณุชูู ุจุง `+, -, *, /`)
ุจูููโุณุงุฒ ูุญุงุณุจุงุช | โ | โ
ูพุดุชุจุงู ุงุฒ `stride access` | โ | โ
ุงูุนุทุงูโูพุฐุฑ ู ูุงุจูุชโูุง ุนููู | โ | โ (ููุท ุจุฑุง ูุญุงุณุจุงุช ุนุฏุฏ)

**ูุชุฌู:**  
โ `valarray` ุฏุฑ **ูุญุงุณุจุงุช ุนุฏุฏ ุณูฺฏู ู ุจูููโุณุงุฒ ูพุฑุฏุงุฒุด ุฏุงุฏูโูุง** ุจูุชุฑ ุงุณุช.  
โ `vector` ุจุฑุง **ูุฏุฑุช ุฏุงุฏูโูุง ุนููู ู ุงูุนุทุงูโูพุฐุฑ ุจุดุชุฑ** ููุงุณุจโุชุฑ ุงุณุช.

---

## **ท. ุฌูุนโุจูุฏ**
โ `valarray` ูุดุงุจู `vector` ุงุณุช ุงูุง **ุจุฑุง ูุญุงุณุจุงุช ุนุฏุฏ ุณูฺฏู ุจููู ุดุฏู ุงุณุช**.  
โ ุงุฒ **ุนููุงุช ุฑุงุถ ุจุฑุฏุงุฑ** (`+, -, *, /`) ุจุฏูู ูุงุฒ ุจู ุญููู ูพุดุชุจุงู ูโฺฉูุฏ.  
โ ุดุงูู **ุชูุงุจุน ุฑุงุถ ุฏุงุฎู** (`sqrt()`, `log()`, `exp()` ู ...) ุงุณุช.  
โ ุฏุงุฑุง **ุฏุณุชุฑุณ ุจุง ูุงุตูู (`stride access`)** ุจุฑุง ูพุฑุฏุงุฒุด ุขุฑุงูโูุง ฺูุฏุจุนุฏ ุงุณุช.  
โ ุฏุฑ ูพุฑุฏุงุฒุด ุฏุงุฏูโูุง ุณุฑุนโุชุฑ ุงุฒ `vector` ุนูู ูโฺฉูุฏ ุงูุง **ุงูุนุทุงูโูพุฐุฑ ฺฉูุชุฑ ุฏุงุฑุฏ**.  

**๐ ฺู ุฒูุงู ุงุฒ `valarray` ุงุณุชูุงุฏู ฺฉููุ**  
ุงฺฏุฑ ุจุฑูุงููโุง ุฏุงุฑุฏ ฺฉู ุดุงูู **ูุญุงุณุจุงุช ุนุฏุฏ ุฒุงุฏุ ูพุฑุฏุงุฒุด ุฏุงุฏูโูุง ุจุฒุฑฺฏุ ุง ูุญุงุณุจุงุช ูุงุชุฑุณ** ุงุณุชุ **`valarray` ฺฏุฒูู ุจูุชุฑ ูุณุจุช ุจู `vector` ุงุณุช**.

## Numeric Limits
ุฏุฑ ฺฉุชุงุจุฎุงูู **`<limits>`**ุ ฺฉุชุงุจุฎุงูู ุงุณุชุงูุฏุงุฑุฏ ++C ฺฉูุงุณโูุง ุฑุง ูุฑุงูู ูโฺฉูุฏ ฺฉู ูฺฺฏโูุง ุงููุงุน ุฏุงุฏูโ **ุฏุงุฎู (Built-in Types)** ุฑุง ุชูุตู ูโฺฉููุฏ. ุงู ูฺฺฏโูุง ุดุงูู **ุจุฒุฑฺฏโุชุฑู ุชูุงู ุนุฏุฏ ฺฉ `float`ุ ุชุนุฏุงุฏ ุจุงุชโูุง ฺฉ `int` ู ุณุงุฑ ูุดุฎุตุงุช ุนุฏุฏ** ูุณุชูุฏ. ุจุฑุง ุงุทูุงุนุงุช ุจุดุชุฑุ ุจู **ยง40.2** ูุฑุงุฌุนู ฺฉูุฏ.

ุจุฑุง ูุซุงูุ ูโุชูุงูู ุจุฑุฑุณ ฺฉูู ฺฉู ุขุง ฺฉ `char` ููุฏุงุฑ **ุงูุถุงโุฏุงุฑ (signed)** ุฏุงุฑุฏ ุง ุฎุฑ:

```cpp
static_assert(numeric_limits<char>::is_signed, "unsigned characters!");
```

ููฺูู ูโุชูุงู ุจุฑุฑุณ ฺฉุฑุฏ ฺฉู ุขุง ููุฏุงุฑ `100000` ุงุฒ ุจุดุชุฑู ููุฏุงุฑ ููฺฉู ุจุฑุง `int` ฺฉูฺฺฉุชุฑ ุงุณุช:

```cpp
static_assert(100000 < numeric_limits<int>::max(), "small ints!");
```

**ูฺฉุชู:**  
โ **ุนุจุงุฑุช ุฏูู ููุท ุจู ุงู ุฏูู ฺฉุงุฑ ูโฺฉูุฏ ฺฉู `numeric_limits<int>::max()` ฺฉ ุชุงุจุน `constexpr` ุงุณุช**.  
โ ุชูุงุจุน `constexpr` ุฏุฑ ุฒูุงู **ฺฉุงููพุงู** ููุฏุงุฑ ุฎูุฏ ุฑุง ุชุนู ูโฺฉููุฏุ ุจูุงุจุฑุงู ูโุชูุงููุฏ ุฏุฑ `static_assert` ุงุณุชูุงุฏู ุดููุฏ.
